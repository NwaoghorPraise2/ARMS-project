2025-04-27 00:30:45,219 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:30:45,323 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:30:45,385 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:30:45,456 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:30:45,470 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:30:47,395 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:30:47,423 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:30:47,462 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:30:47,502 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:30:47,507 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:30:49,468 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:30:49,494 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:30:49,512 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:30:49,522 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:30:49,531 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:30:51,522 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:30:51,555 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:30:51,564 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:30:51,571 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:30:51,576 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:30:53,580 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:30:53,612 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:30:53,632 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:30:53,632 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:30:53,656 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:30:55,384 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-27 00:30:55,386 - INFO - Attempting broker recovery for kafka1
2025-04-27 00:30:55,386 - INFO - Attempting internal recovery for broker 1
2025-04-27 00:30:55,386 - INFO - Triggering internal recovery for broker 1
2025-04-27 00:30:55,407 - INFO - Found 1 partitions on broker 1
2025-04-27 00:30:55,408 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-27 00:30:55,408 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 00:30:55,409 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-27 00:30:55,412 - INFO - Successfully triggered internal recovery for broker 1
2025-04-27 00:30:55,461 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:30:55,536 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-27 00:30:55,537 - INFO - Recovery successful for broker kafka1:9092
2025-04-27 00:30:55,537 - INFO - Recovery thread for kafka1:9092 completed
2025-04-27 00:30:55,666 - INFO - Skipping recovery for kafka1:9092, last attempt 17.1s ago
2025-04-27 00:30:55,675 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:30:55,685 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:30:55,717 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:30:55,784 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:30:57,709 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:30:57,737 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:30:59,769 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:30:59,796 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:31:00,797 - INFO - Skipping recovery for kafka1:9092, last attempt 22.2s ago
2025-04-27 00:31:00,821 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:00,848 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:01,853 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:31:01,858 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:31:03,888 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:31:03,897 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:31:05,860 - INFO - Skipping recovery for kafka1:9092, last attempt 27.3s ago
2025-04-27 00:31:05,872 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:05,908 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:31:05,910 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:05,912 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:31:07,932 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:31:07,936 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:31:09,945 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:31:09,967 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:31:10,956 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:10,974 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:10,985 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:12,014 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:31:12,098 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:31:14,124 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:31:14,171 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:31:16,020 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:16,041 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:16,072 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:16,194 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:31:16,200 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:31:18,211 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:31:18,227 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:31:20,237 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:31:20,239 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:31:21,095 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:21,129 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:21,152 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:22,275 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:31:22,346 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:31:24,355 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:31:24,387 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:31:26,174 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:26,189 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:26,197 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:26,412 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:31:26,450 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:31:28,463 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:31:28,506 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:31:30,517 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:31:30,576 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:31:31,216 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:31,227 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:31,241 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:32,587 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:31:32,609 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:31:34,623 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:31:34,648 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:31:36,265 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:36,290 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:36,325 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:36,662 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:31:36,746 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:31:38,758 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:31:38,844 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:31:40,866 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:31:40,911 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:31:41,323 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-27 00:31:41,323 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-27 00:31:41,324 - INFO - Starting recovery thread for kafka1:9092
2025-04-27 00:31:41,325 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-27 00:31:41,325 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE
2025-04-27 00:31:41,341 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:41,341 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:41,358 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:41,358 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:41,361 - INFO - Using strategy buffer configuration
2025-04-27 00:31:41,365 - INFO - Found broker IDs: [2, 3, 1]
2025-04-27 00:31:41,460 - INFO - Successfully applied config to broker 2
2025-04-27 00:31:41,756 - INFO - Successfully applied config to broker 3
2025-04-27 00:31:41,949 - INFO - Successfully applied config to broker 1
2025-04-27 00:31:41,949 - INFO - Applied configuration to all available brokers from buffer
2025-04-27 00:31:41,951 - INFO - Triggering leader election
2025-04-27 00:31:41,956 - INFO - Listing topics for leader election
2025-04-27 00:31:41,972 - INFO - Found 1 topics for leader election
2025-04-27 00:31:41,972 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 00:31:41,973 - INFO - Leader election completed in 0.02 seconds, success: False
2025-04-27 00:31:41,976 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-27 00:31:42,939 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:31:42,981 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:31:43,360 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:31:43,368 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:43,378 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:44,998 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:31:45,065 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:31:45,383 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:31:45,397 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:45,408 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:47,106 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:31:47,180 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:31:47,413 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:31:47,433 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:47,461 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:49,195 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:31:49,274 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:31:49,464 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:31:49,493 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:49,516 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:51,291 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:31:51,442 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:31:51,518 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:31:51,542 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:51,579 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:53,508 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:31:53,539 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:31:53,587 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:31:53,627 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:53,661 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:55,587 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:31:55,601 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:31:55,675 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:31:55,711 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:55,739 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:56,979 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-27 00:31:56,980 - INFO - Attempting broker recovery for kafka1
2025-04-27 00:31:56,980 - INFO - Attempting internal recovery for broker 1
2025-04-27 00:31:56,980 - INFO - Triggering internal recovery for broker 1
2025-04-27 00:31:57,002 - INFO - Found 1 partitions on broker 1
2025-04-27 00:31:57,002 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-27 00:31:57,002 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 00:31:57,003 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-27 00:31:57,006 - INFO - Successfully triggered internal recovery for broker 1
2025-04-27 00:31:57,073 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:57,163 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-27 00:31:57,165 - INFO - Recovery successful for broker kafka1:9092
2025-04-27 00:31:57,165 - INFO - Recovery thread for kafka1:9092 completed
2025-04-27 00:31:57,676 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:31:57,688 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:31:57,747 - INFO - Skipping recovery for kafka1:9092, last attempt 16.4s ago
2025-04-27 00:31:57,810 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:57,909 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:31:59,743 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:31:59,802 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:32:01,843 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:32:01,852 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:32:02,919 - INFO - Skipping recovery for kafka1:9092, last attempt 21.6s ago
2025-04-27 00:32:02,973 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:03,000 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:03,884 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:32:03,895 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:32:05,966 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:32:05,981 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:32:07,995 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:32:07,998 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:32:08,004 - INFO - Skipping recovery for kafka1:9092, last attempt 26.7s ago
2025-04-27 00:32:08,048 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:08,064 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:10,023 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:32:10,046 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:32:12,075 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:32:12,120 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:32:13,097 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:13,133 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:13,171 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:14,137 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:32:14,140 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:32:16,165 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:32:16,170 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:32:18,208 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:32:18,211 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:18,244 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:32:18,247 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:18,263 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:20,256 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:32:20,260 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:32:22,275 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:32:22,280 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:32:23,314 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:23,341 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:23,398 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:24,303 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:32:24,338 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:32:26,368 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:32:26,415 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:32:28,442 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:32:28,471 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:32:28,485 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:28,547 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:28,638 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:30,483 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:32:30,507 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:32:32,515 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:32:32,530 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:32:33,672 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:33,684 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:33,699 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:34,545 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:32:34,548 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:32:36,612 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:32:36,616 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:32:38,629 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:32:38,635 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:32:38,721 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:38,758 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:38,784 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:40,649 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:32:40,672 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:32:42,688 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:32:42,795 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:32:43,788 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-27 00:32:43,789 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-27 00:32:43,789 - INFO - Starting recovery thread for kafka1:9092
2025-04-27 00:32:43,789 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-27 00:32:43,789 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: RESOURCE_OPTIMIZED
2025-04-27 00:32:43,797 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:43,797 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:43,807 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:43,812 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:43,815 - INFO - Using strategy buffer configuration
2025-04-27 00:32:43,820 - INFO - Found broker IDs: [2, 3, 1]
2025-04-27 00:32:43,979 - INFO - Successfully applied config to broker 2
2025-04-27 00:32:44,072 - INFO - Successfully applied config to broker 3
2025-04-27 00:32:44,213 - INFO - Successfully applied config to broker 1
2025-04-27 00:32:44,213 - INFO - Applied configuration to all available brokers from buffer
2025-04-27 00:32:44,215 - INFO - Triggering leader election
2025-04-27 00:32:44,222 - INFO - Listing topics for leader election
2025-04-27 00:32:44,230 - INFO - Found 1 topics for leader election
2025-04-27 00:32:44,231 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 00:32:44,231 - INFO - Leader election completed in 0.01 seconds, success: False
2025-04-27 00:32:44,240 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-27 00:32:44,804 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:32:44,807 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:32:45,808 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:32:45,820 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:45,845 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:46,865 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:32:46,869 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:32:47,848 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:32:47,865 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:47,887 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:48,886 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:32:48,955 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:32:49,895 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:32:49,936 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:49,953 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:50,970 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:32:51,010 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:32:51,961 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:32:51,980 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:52,004 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:53,039 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:32:53,069 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:32:54,008 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:32:54,020 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:54,059 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:55,085 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:32:55,107 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:32:56,066 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:32:56,090 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:56,112 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:57,137 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:32:57,187 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:32:58,116 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:32:58,138 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:58,152 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:59,209 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:32:59,256 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-27 00:32:59,258 - INFO - Attempting broker recovery for kafka1
2025-04-27 00:32:59,259 - INFO - Attempting internal recovery for broker 1
2025-04-27 00:32:59,263 - INFO - Triggering internal recovery for broker 1
2025-04-27 00:32:59,288 - INFO - Found 1 partitions on broker 1
2025-04-27 00:32:59,288 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-27 00:32:59,288 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 00:32:59,288 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-27 00:32:59,293 - INFO - Successfully triggered internal recovery for broker 1
2025-04-27 00:32:59,326 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:32:59,363 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:32:59,671 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-27 00:32:59,671 - INFO - Recovery successful for broker kafka1:9092
2025-04-27 00:32:59,671 - INFO - Recovery thread for kafka1:9092 completed
2025-04-27 00:33:00,154 - INFO - Skipping recovery for kafka1:9092, last attempt 16.4s ago
2025-04-27 00:33:00,171 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:00,180 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:01,349 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:33:01,353 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:33:03,368 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:33:03,392 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:33:05,185 - INFO - Skipping recovery for kafka1:9092, last attempt 21.4s ago
2025-04-27 00:33:05,206 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:05,250 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:05,417 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:33:05,443 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:33:07,463 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:33:07,465 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:33:09,477 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:33:09,535 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:33:10,263 - INFO - Skipping recovery for kafka1:9092, last attempt 26.5s ago
2025-04-27 00:33:10,285 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:10,303 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:11,574 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:33:11,596 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:33:13,612 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:33:13,638 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:33:15,340 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:15,376 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:15,402 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:15,667 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:33:15,692 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:33:17,719 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:33:17,723 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:33:19,736 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:33:19,744 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:33:20,436 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:20,455 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:20,485 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:21,769 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:33:21,784 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:33:23,809 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:33:23,812 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:33:25,527 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:25,571 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:25,610 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:25,824 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:33:25,828 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:33:27,836 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:33:27,857 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:33:29,873 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:33:29,876 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:33:30,650 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:30,669 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:30,679 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:31,911 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:33:31,915 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:33:33,955 - ERROR - API returned status code: 500
2025-04-27 00:33:35,714 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:35,748 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:35,762 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:35,966 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:33:35,969 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:33:37,994 - ERROR - API returned status code: 500
2025-04-27 00:33:40,019 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:33:40,029 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:33:40,782 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:40,796 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:40,805 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:42,036 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:33:42,043 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:33:44,060 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:33:44,063 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:33:45,812 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-27 00:33:45,813 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-27 00:33:45,814 - INFO - Starting recovery thread for kafka1:9092
2025-04-27 00:33:45,815 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-27 00:33:45,815 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: RESOURCE_OPTIMIZED
2025-04-27 00:33:45,825 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:45,825 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:45,852 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:45,852 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:45,857 - INFO - Using strategy buffer configuration
2025-04-27 00:33:45,861 - INFO - Found broker IDs: [2, 3, 1]
2025-04-27 00:33:45,930 - INFO - Successfully applied config to broker 2
2025-04-27 00:33:46,057 - INFO - Successfully applied config to broker 3
2025-04-27 00:33:46,077 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:33:46,083 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:33:46,167 - INFO - Successfully applied config to broker 1
2025-04-27 00:33:46,168 - INFO - Applied configuration to all available brokers from buffer
2025-04-27 00:33:46,171 - INFO - Triggering leader election
2025-04-27 00:33:46,176 - INFO - Listing topics for leader election
2025-04-27 00:33:46,333 - INFO - Found 1 topics for leader election
2025-04-27 00:33:46,334 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 00:33:46,334 - INFO - Leader election completed in 0.16 seconds, success: False
2025-04-27 00:33:46,341 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-27 00:33:47,859 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:33:47,872 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:47,880 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:48,092 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:33:48,109 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:33:49,884 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:33:49,912 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:49,928 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:50,128 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:33:50,133 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:33:51,935 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:33:51,959 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:51,977 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:52,146 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:33:52,152 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:33:53,983 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:33:53,991 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:53,999 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:54,162 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:33:54,165 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:33:56,003 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:33:56,009 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:56,014 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:56,178 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:33:56,181 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:33:58,019 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:33:58,024 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:58,030 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:33:58,188 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:33:58,194 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:34:00,040 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:34:00,078 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:00,089 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:00,205 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:34:00,214 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:34:01,356 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-27 00:34:01,357 - INFO - Attempting broker recovery for kafka1
2025-04-27 00:34:01,357 - INFO - Attempting internal recovery for broker 1
2025-04-27 00:34:01,357 - INFO - Triggering internal recovery for broker 1
2025-04-27 00:34:01,370 - INFO - Found 1 partitions on broker 1
2025-04-27 00:34:01,371 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-27 00:34:01,371 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 00:34:01,371 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-27 00:34:01,373 - INFO - Successfully triggered internal recovery for broker 1
2025-04-27 00:34:01,382 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:01,430 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-27 00:34:01,430 - INFO - Recovery successful for broker kafka1:9092
2025-04-27 00:34:01,430 - INFO - Recovery thread for kafka1:9092 completed
2025-04-27 00:34:02,092 - INFO - Skipping recovery for kafka1:9092, last attempt 16.3s ago
2025-04-27 00:34:02,110 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:02,122 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:02,224 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:34:02,232 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:34:04,257 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:34:04,301 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:34:06,329 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:34:06,332 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:34:07,130 - INFO - Skipping recovery for kafka1:9092, last attempt 21.3s ago
2025-04-27 00:34:07,161 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:07,197 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:08,346 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:34:08,363 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:34:10,368 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:34:10,390 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:34:12,207 - INFO - Skipping recovery for kafka1:9092, last attempt 26.4s ago
2025-04-27 00:34:12,236 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:12,262 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:12,429 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:34:12,457 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:34:14,477 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:34:14,485 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:34:16,530 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:34:16,541 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:34:17,296 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:17,314 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:17,349 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:18,563 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:34:18,577 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:34:20,592 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:34:20,598 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:34:22,369 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:22,406 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:22,423 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:22,608 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:34:22,614 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:34:24,630 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:34:24,726 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:34:26,745 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:34:26,748 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:34:27,443 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:27,466 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:27,477 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:28,759 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:34:28,763 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:34:30,772 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:34:30,786 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:34:32,509 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:32,555 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:32,597 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:32,831 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:34:32,892 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:34:34,917 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:34:34,920 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:34:36,937 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:34:36,942 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:34:37,616 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:37,629 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:37,637 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:38,952 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:34:38,960 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:34:40,980 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:34:41,050 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:34:42,662 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:42,689 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:42,701 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:43,064 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:34:43,068 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:34:45,084 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:34:45,120 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:34:47,136 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:34:47,180 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:34:47,710 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-27 00:34:47,710 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-27 00:34:47,712 - INFO - Starting recovery thread for kafka1:9092
2025-04-27 00:34:47,712 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-27 00:34:47,712 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: RESOURCE_OPTIMIZED
2025-04-27 00:34:47,738 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:47,746 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:47,755 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:47,755 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:47,757 - INFO - Using strategy buffer configuration
2025-04-27 00:34:47,761 - INFO - Found broker IDs: [2, 3, 1]
2025-04-27 00:34:47,862 - INFO - Successfully applied config to broker 2
2025-04-27 00:34:48,009 - INFO - Successfully applied config to broker 3
2025-04-27 00:34:48,414 - INFO - Successfully applied config to broker 1
2025-04-27 00:34:48,415 - INFO - Applied configuration to all available brokers from buffer
2025-04-27 00:34:48,417 - INFO - Triggering leader election
2025-04-27 00:34:48,420 - INFO - Listing topics for leader election
2025-04-27 00:34:48,465 - INFO - Found 1 topics for leader election
2025-04-27 00:34:48,466 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 00:34:48,467 - INFO - Leader election completed in 0.05 seconds, success: False
2025-04-27 00:34:48,472 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-27 00:34:49,205 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:34:49,226 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:34:49,760 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:34:49,811 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:49,828 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:51,254 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:34:51,283 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:34:51,836 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:34:51,873 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:51,891 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:53,304 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:34:53,327 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:34:53,898 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:34:53,914 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:53,933 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:55,335 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:34:55,337 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:34:55,936 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:34:55,946 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:55,954 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:57,354 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:34:57,357 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:34:57,955 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:34:57,960 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:57,964 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:34:59,373 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:34:59,384 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:34:59,966 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:34:59,990 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:00,009 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:01,396 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:35:01,420 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:35:02,012 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:35:02,038 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:02,053 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:03,441 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:35:03,475 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-27 00:35:03,475 - INFO - Attempting broker recovery for kafka1
2025-04-27 00:35:03,475 - INFO - Attempting internal recovery for broker 1
2025-04-27 00:35:03,476 - INFO - Triggering internal recovery for broker 1
2025-04-27 00:35:03,479 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:35:03,493 - INFO - Found 1 partitions on broker 1
2025-04-27 00:35:03,493 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-27 00:35:03,494 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 00:35:03,494 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-27 00:35:03,495 - INFO - Successfully triggered internal recovery for broker 1
2025-04-27 00:35:03,530 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:03,568 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-27 00:35:03,569 - INFO - Recovery successful for broker kafka1:9092
2025-04-27 00:35:03,569 - INFO - Recovery thread for kafka1:9092 completed
2025-04-27 00:35:04,059 - INFO - Skipping recovery for kafka1:9092, last attempt 16.3s ago
2025-04-27 00:35:04,084 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:04,111 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:05,502 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:35:05,525 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:35:07,542 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:35:07,567 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:35:09,128 - INFO - Skipping recovery for kafka1:9092, last attempt 21.4s ago
2025-04-27 00:35:09,163 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:09,176 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:09,582 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:35:09,607 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:35:11,626 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:35:11,631 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:35:13,648 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:35:13,655 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:35:14,178 - INFO - Skipping recovery for kafka1:9092, last attempt 26.5s ago
2025-04-27 00:35:14,197 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:14,211 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:15,669 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:35:15,672 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:35:17,693 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:35:17,696 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:35:19,272 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:19,297 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:19,311 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:19,713 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:35:19,777 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:35:21,800 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:35:21,804 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:35:23,836 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:35:23,853 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:35:24,336 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:24,350 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:24,365 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:25,868 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:35:25,870 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:35:27,894 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:35:27,943 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:35:29,396 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:29,443 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:29,458 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:29,979 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:35:29,986 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:35:32,031 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:35:32,071 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:35:34,097 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:35:34,116 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:35:34,500 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:34,512 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:34,526 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:36,129 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:35:36,139 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:35:38,188 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:35:38,225 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:35:39,584 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:39,617 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:39,657 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:40,241 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:35:40,272 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:35:42,306 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:35:42,311 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:35:44,365 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:35:44,376 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:35:44,683 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:44,700 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:44,742 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:46,414 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:35:46,464 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:35:48,480 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:35:48,508 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:35:49,750 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-27 00:35:49,751 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-27 00:35:49,753 - INFO - Starting recovery thread for kafka1:9092
2025-04-27 00:35:49,753 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-27 00:35:49,754 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: RESOURCE_OPTIMIZED
2025-04-27 00:35:49,783 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:49,783 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:49,814 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:49,817 - INFO - Using strategy buffer configuration
2025-04-27 00:35:49,817 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:49,824 - INFO - Found broker IDs: [2, 3, 1]
2025-04-27 00:35:50,011 - INFO - Successfully applied config to broker 2
2025-04-27 00:35:50,260 - INFO - Successfully applied config to broker 3
2025-04-27 00:35:50,731 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:35:50,740 - INFO - Successfully applied config to broker 1
2025-04-27 00:35:50,740 - INFO - Applied configuration to all available brokers from buffer
2025-04-27 00:35:50,751 - INFO - Triggering leader election
2025-04-27 00:35:50,757 - INFO - Listing topics for leader election
2025-04-27 00:35:50,772 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:35:50,792 - INFO - Found 1 topics for leader election
2025-04-27 00:35:50,793 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 00:35:50,793 - INFO - Leader election completed in 0.04 seconds, success: False
2025-04-27 00:35:51,802 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-27 00:35:51,821 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:35:51,839 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:51,863 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:52,811 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:35:52,844 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:35:53,871 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:35:53,936 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:53,958 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:54,883 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:35:54,903 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:35:55,967 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:35:55,981 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:55,992 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:56,924 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:35:56,945 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:35:57,998 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:35:58,028 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:58,082 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:35:58,971 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:35:58,974 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:36:00,110 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:36:00,134 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:00,151 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:00,987 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:36:01,008 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:36:02,155 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:36:02,171 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:02,194 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:03,025 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:36:03,027 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:36:04,198 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:36:04,215 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:04,259 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:05,045 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:36:05,054 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:36:06,267 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:36:06,309 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:06,324 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:06,819 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-27 00:36:06,819 - INFO - Attempting broker recovery for kafka1
2025-04-27 00:36:06,819 - INFO - Attempting internal recovery for broker 1
2025-04-27 00:36:06,819 - INFO - Triggering internal recovery for broker 1
2025-04-27 00:36:06,825 - INFO - Found 1 partitions on broker 1
2025-04-27 00:36:06,825 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-27 00:36:06,826 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 00:36:06,826 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-27 00:36:06,827 - INFO - Successfully triggered internal recovery for broker 1
2025-04-27 00:36:06,881 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:06,971 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-27 00:36:06,971 - INFO - Recovery successful for broker kafka1:9092
2025-04-27 00:36:06,971 - INFO - Recovery thread for kafka1:9092 completed
2025-04-27 00:36:07,070 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:36:07,107 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:36:08,329 - INFO - Skipping recovery for kafka1:9092, last attempt 18.6s ago
2025-04-27 00:36:08,372 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:08,391 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:09,121 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:36:09,214 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:36:11,227 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:36:11,253 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:36:13,302 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:36:13,379 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:36:13,399 - INFO - Skipping recovery for kafka1:9092, last attempt 23.6s ago
2025-04-27 00:36:13,463 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:13,498 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:15,421 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:36:15,425 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:36:17,439 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:36:17,460 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:36:18,503 - INFO - Skipping recovery for kafka1:9092, last attempt 28.8s ago
2025-04-27 00:36:18,558 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:18,576 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:19,498 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:36:19,504 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:36:21,529 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:36:21,540 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:36:23,596 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:36:23,652 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:23,694 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:36:23,716 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:23,739 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:25,750 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:36:25,769 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:36:27,778 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:36:27,815 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:36:28,768 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:28,787 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:28,814 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:29,834 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:36:29,837 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:36:31,872 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:36:31,879 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:36:33,852 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:33,874 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:33,914 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:33,944 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:36:33,968 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:36:35,991 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:36:35,994 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:36:38,006 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:36:38,011 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:36:38,949 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:38,976 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:39,005 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:40,030 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:36:40,034 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:36:42,049 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:36:42,063 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:36:44,036 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:44,093 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:44,115 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:36:44,138 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:44,151 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:36:46,183 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:36:46,277 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:36:48,319 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:36:48,368 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:36:50,145 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-27 00:36:50,148 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-27 00:36:50,152 - INFO - Starting recovery thread for kafka1:9092
2025-04-27 00:36:50,156 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-27 00:36:50,156 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: RESOURCE_OPTIMIZED
2025-04-27 00:36:50,189 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:50,196 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:50,219 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:50,225 - INFO - Using strategy buffer configuration
2025-04-27 00:36:50,233 - INFO - Found broker IDs: [2, 3, 1]
2025-04-27 00:36:50,391 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:36:50,436 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:36:50,550 - INFO - Successfully applied config to broker 2
2025-04-27 00:36:50,974 - INFO - Successfully applied config to broker 3
2025-04-27 00:36:51,400 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:51,521 - INFO - Successfully applied config to broker 1
2025-04-27 00:36:51,525 - INFO - Applied configuration to all available brokers from buffer
2025-04-27 00:36:51,553 - INFO - Triggering leader election
2025-04-27 00:36:51,601 - INFO - Listing topics for leader election
2025-04-27 00:36:51,666 - INFO - Found 1 topics for leader election
2025-04-27 00:36:51,666 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 00:36:51,668 - INFO - Leader election completed in 0.07 seconds, success: False
2025-04-27 00:36:52,467 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:36:52,677 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-27 00:36:52,742 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:36:53,407 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:36:53,431 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:53,466 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:54,781 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:36:54,823 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:36:55,473 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:36:55,492 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:55,507 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:56,843 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:36:56,846 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:36:57,508 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:36:57,533 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:57,570 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:58,862 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:36:58,913 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:36:59,576 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:36:59,601 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:36:59,612 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:00,926 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:37:00,951 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:37:01,616 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:37:01,631 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:01,649 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:02,973 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:37:03,005 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:37:03,655 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:37:03,699 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:03,718 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:05,049 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:37:05,131 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:37:05,723 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:37:05,742 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:05,763 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:07,162 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:37:07,251 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:37:07,692 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-27 00:37:07,692 - INFO - Attempting broker recovery for kafka1
2025-04-27 00:37:07,693 - INFO - Attempting internal recovery for broker 1
2025-04-27 00:37:07,693 - INFO - Triggering internal recovery for broker 1
2025-04-27 00:37:07,719 - INFO - Found 1 partitions on broker 1
2025-04-27 00:37:07,720 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-27 00:37:07,720 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 00:37:07,720 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-27 00:37:07,722 - INFO - Successfully triggered internal recovery for broker 1
2025-04-27 00:37:07,752 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:07,769 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:37:07,804 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:07,818 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:07,882 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-27 00:37:07,883 - INFO - Recovery successful for broker kafka1:9092
2025-04-27 00:37:07,883 - INFO - Recovery thread for kafka1:9092 completed
2025-04-27 00:37:09,266 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:37:09,272 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:37:09,822 - INFO - Skipping recovery for kafka1:9092, last attempt 19.7s ago
2025-04-27 00:37:09,847 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:09,863 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:11,292 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:37:11,333 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:37:13,358 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:37:13,387 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:37:14,868 - INFO - Skipping recovery for kafka1:9092, last attempt 24.7s ago
2025-04-27 00:37:14,927 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:14,979 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:15,413 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:37:15,438 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:37:17,455 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:37:17,464 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:37:19,479 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:37:19,506 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:37:19,989 - INFO - Skipping recovery for kafka1:9092, last attempt 29.8s ago
2025-04-27 00:37:20,017 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:20,032 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:21,547 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:37:21,571 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:37:23,601 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:37:23,612 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:37:25,094 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:25,127 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:25,234 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:25,637 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:37:25,735 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:37:27,801 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:37:27,897 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:37:29,924 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:37:29,929 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:37:30,325 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:30,360 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:30,400 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:31,971 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:37:31,979 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:37:33,989 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:37:34,020 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:37:35,436 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:35,451 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:35,462 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:36,030 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:37:36,032 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:37:38,051 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:37:38,060 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:37:40,070 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:37:40,073 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:37:40,495 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:40,519 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:40,531 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:42,115 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:37:42,121 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:37:44,136 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:37:44,152 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:37:45,578 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:45,593 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:45,604 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:46,169 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:37:46,193 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:37:48,245 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:37:48,252 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:37:50,261 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:37:50,273 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:37:50,611 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-27 00:37:50,612 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-27 00:37:50,613 - INFO - Starting recovery thread for kafka1:9092
2025-04-27 00:37:50,617 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-27 00:37:50,619 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: RESOURCE_OPTIMIZED
2025-04-27 00:37:50,633 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:50,648 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:50,657 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:50,679 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:50,695 - INFO - Using strategy buffer configuration
2025-04-27 00:37:50,702 - INFO - Found broker IDs: [2, 3, 1]
2025-04-27 00:37:51,062 - INFO - Successfully applied config to broker 2
2025-04-27 00:37:51,150 - INFO - Successfully applied config to broker 3
2025-04-27 00:37:51,358 - INFO - Successfully applied config to broker 1
2025-04-27 00:37:51,358 - INFO - Applied configuration to all available brokers from buffer
2025-04-27 00:37:51,367 - INFO - Triggering leader election
2025-04-27 00:37:51,488 - INFO - Listing topics for leader election
2025-04-27 00:37:51,564 - INFO - Found 1 topics for leader election
2025-04-27 00:37:51,564 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 00:37:51,564 - INFO - Leader election completed in 0.08 seconds, success: False
2025-04-27 00:37:51,568 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-27 00:37:52,301 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:37:52,349 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:37:52,660 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:37:52,669 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:52,683 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:54,366 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:37:54,380 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:37:54,688 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:37:54,702 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:54,728 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:56,406 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:37:56,439 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:37:56,734 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:37:56,755 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:56,808 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:58,460 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:37:58,466 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:37:58,819 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:37:58,831 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:37:58,842 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:00,479 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:38:00,482 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:38:00,844 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:38:00,855 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:00,866 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:02,526 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:38:02,530 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:38:02,875 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:38:02,955 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:03,037 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:04,548 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:38:04,552 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:38:05,043 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:38:05,073 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:05,082 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:06,576 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:38:06,581 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-27 00:38:06,581 - INFO - Attempting broker recovery for kafka1
2025-04-27 00:38:06,582 - INFO - Attempting internal recovery for broker 1
2025-04-27 00:38:06,583 - INFO - Triggering internal recovery for broker 1
2025-04-27 00:38:06,601 - INFO - Found 1 partitions on broker 1
2025-04-27 00:38:06,601 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-27 00:38:06,602 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 00:38:06,602 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-27 00:38:06,604 - INFO - Successfully triggered internal recovery for broker 1
2025-04-27 00:38:06,616 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:38:06,655 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:06,707 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-27 00:38:06,708 - INFO - Recovery successful for broker kafka1:9092
2025-04-27 00:38:06,708 - INFO - Recovery thread for kafka1:9092 completed
2025-04-27 00:38:07,086 - INFO - Skipping recovery for kafka1:9092, last attempt 16.5s ago
2025-04-27 00:38:07,136 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:07,148 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:08,637 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:38:08,645 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:38:10,669 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:38:10,722 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:38:12,151 - INFO - Skipping recovery for kafka1:9092, last attempt 21.5s ago
2025-04-27 00:38:12,180 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:12,211 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:12,734 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:38:12,742 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:38:14,752 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:38:14,756 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:38:16,768 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:38:16,786 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:38:17,215 - INFO - Skipping recovery for kafka1:9092, last attempt 26.6s ago
2025-04-27 00:38:17,233 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:17,245 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:18,801 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:38:18,864 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:38:20,877 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:38:20,923 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:38:22,297 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:22,334 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:22,348 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:22,945 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:38:22,984 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:38:25,025 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:38:25,077 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:38:27,099 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:38:27,107 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:38:27,370 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:27,391 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:27,428 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:29,117 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:38:29,150 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:38:31,171 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:38:31,219 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:38:32,448 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:32,479 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:32,534 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:33,242 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:38:33,248 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:38:35,303 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:38:35,305 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:38:37,351 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:38:37,355 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:38:37,559 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:37,576 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:37,607 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:39,367 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:38:39,371 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:38:41,393 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:38:41,429 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:38:42,682 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:42,746 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:42,771 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:43,457 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:38:43,517 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:38:45,533 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:38:45,538 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:38:47,564 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:38:47,573 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:38:47,823 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:47,840 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:47,850 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:49,582 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:38:49,619 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:38:51,646 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:38:51,670 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:38:52,856 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-27 00:38:52,857 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-27 00:38:52,859 - INFO - Starting recovery thread for kafka1:9092
2025-04-27 00:38:52,860 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-27 00:38:52,863 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: RESOURCE_OPTIMIZED
2025-04-27 00:38:52,878 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:52,878 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:52,893 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:52,907 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:52,915 - INFO - Using strategy buffer configuration
2025-04-27 00:38:52,924 - INFO - Found broker IDs: [2, 3, 1]
2025-04-27 00:38:53,393 - INFO - Successfully applied config to broker 2
2025-04-27 00:38:53,640 - INFO - Successfully applied config to broker 3
2025-04-27 00:38:53,714 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:38:53,756 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:38:53,893 - INFO - Successfully applied config to broker 1
2025-04-27 00:38:53,893 - INFO - Applied configuration to all available brokers from buffer
2025-04-27 00:38:53,913 - INFO - Triggering leader election
2025-04-27 00:38:53,927 - INFO - Listing topics for leader election
2025-04-27 00:38:53,935 - INFO - Found 1 topics for leader election
2025-04-27 00:38:53,935 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 00:38:53,936 - INFO - Leader election completed in 0.01 seconds, success: False
2025-04-27 00:38:53,936 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-27 00:38:54,899 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:38:54,930 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:54,963 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:55,790 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:38:55,794 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:38:56,987 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:38:57,005 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:57,025 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:57,802 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:38:57,831 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:38:59,032 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:38:59,044 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:59,052 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:38:59,850 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:38:59,882 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:39:01,055 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:39:01,063 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:39:01,072 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:39:01,918 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:39:01,984 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:39:03,074 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:39:03,101 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:39:03,115 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:39:04,010 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:39:04,036 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:39:05,119 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:39:05,175 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:39:05,197 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:39:06,059 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:39:06,082 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:39:07,205 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:39:07,230 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:39:07,245 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:39:08,114 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:39:08,165 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:39:08,944 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-27 00:39:08,944 - INFO - Attempting broker recovery for kafka1
2025-04-27 00:39:08,944 - INFO - Attempting internal recovery for broker 1
2025-04-27 00:39:08,944 - INFO - Triggering internal recovery for broker 1
2025-04-27 00:39:08,964 - INFO - Found 1 partitions on broker 1
2025-04-27 00:39:08,964 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-27 00:39:08,964 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 00:39:08,964 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-27 00:39:08,972 - INFO - Successfully triggered internal recovery for broker 1
2025-04-27 00:39:09,026 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:39:09,078 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-27 00:39:09,079 - INFO - Recovery successful for broker kafka1:9092
2025-04-27 00:39:09,079 - INFO - Recovery thread for kafka1:9092 completed
2025-04-27 00:39:09,271 - INFO - Skipping recovery for kafka1:9092, last attempt 16.4s ago
2025-04-27 00:39:09,381 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:39:09,427 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:39:10,186 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:39:10,193 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:39:12,215 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:39:12,219 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:39:14,231 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:39:14,234 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:39:14,435 - INFO - Skipping recovery for kafka1:9092, last attempt 21.6s ago
2025-04-27 00:39:14,452 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:39:14,470 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:39:16,263 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:39:16,267 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:39:18,281 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:39:18,297 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:39:19,479 - INFO - Skipping recovery for kafka1:9092, last attempt 26.6s ago
2025-04-27 00:39:19,498 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:39:19,508 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:39:20,312 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:39:20,318 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:39:22,343 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:39:22,420 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:39:24,473 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:39:24,480 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:39:24,598 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:39:24,627 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:39:24,649 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:39:26,511 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:39:26,531 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:39:28,539 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:39:28,544 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:39:29,681 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:39:29,757 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:39:29,776 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:39:30,573 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:39:30,595 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:39:32,615 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:39:32,637 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:39:34,653 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:39:34,693 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:39:34,835 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:39:34,858 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:39:34,886 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:39:36,714 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:39:36,746 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:39:38,765 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:39:38,791 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:39:39,931 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:39:39,969 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:39:40,802 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:39:40,828 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:39:40,990 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:39:42,846 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:39:42,876 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:39:44,889 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:39:44,906 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:39:46,051 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:39:46,088 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:39:46,104 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:39:46,943 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:39:46,958 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:39:48,974 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:39:49,018 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:39:51,047 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:39:51,098 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:39:51,142 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:39:51,173 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:39:51,189 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:39:53,128 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:39:53,174 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:39:55,199 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:39:55,263 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:39:56,197 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-27 00:39:56,198 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-27 00:39:56,199 - INFO - Starting recovery thread for kafka1:9092
2025-04-27 00:39:56,200 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-27 00:39:56,200 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: RESOURCE_OPTIMIZED
2025-04-27 00:39:56,225 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:39:56,274 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:39:56,283 - INFO - Using strategy buffer configuration
2025-04-27 00:39:56,295 - INFO - Found broker IDs: [2, 3, 1]
2025-04-27 00:39:56,304 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:39:56,322 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:39:56,545 - INFO - Successfully applied config to broker 2
2025-04-27 00:39:56,724 - INFO - Successfully applied config to broker 3
2025-04-27 00:39:57,325 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:39:57,351 - INFO - Successfully applied config to broker 1
2025-04-27 00:39:57,351 - INFO - Applied configuration to all available brokers from buffer
2025-04-27 00:39:57,359 - INFO - Triggering leader election
2025-04-27 00:39:57,360 - INFO - Listing topics for leader election
2025-04-27 00:39:57,388 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:39:57,443 - INFO - Found 1 topics for leader election
2025-04-27 00:39:57,452 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 00:39:57,453 - INFO - Leader election completed in 0.09 seconds, success: False
2025-04-27 00:39:57,475 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-27 00:39:58,328 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:39:58,351 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:39:58,367 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:39:59,417 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:39:59,448 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:40:00,384 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:40:00,531 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:00,723 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:01,490 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:40:01,526 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:40:02,728 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:40:02,763 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:02,783 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:03,583 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:40:03,642 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:40:04,787 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:40:04,822 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:04,843 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:05,664 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:40:05,667 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:40:06,848 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:40:06,878 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:06,889 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:07,679 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:40:07,681 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:40:08,890 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:40:08,895 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:08,900 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:09,691 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:40:09,695 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:40:10,904 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:40:10,942 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:10,983 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:11,733 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:40:11,745 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:40:12,478 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-27 00:40:12,478 - INFO - Attempting broker recovery for kafka1
2025-04-27 00:40:12,479 - INFO - Attempting internal recovery for broker 1
2025-04-27 00:40:12,479 - INFO - Triggering internal recovery for broker 1
2025-04-27 00:40:12,489 - INFO - Found 1 partitions on broker 1
2025-04-27 00:40:12,489 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-27 00:40:12,489 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 00:40:12,489 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-27 00:40:12,492 - INFO - Successfully triggered internal recovery for broker 1
2025-04-27 00:40:12,507 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:12,557 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-27 00:40:12,558 - INFO - Recovery successful for broker kafka1:9092
2025-04-27 00:40:12,558 - INFO - Recovery thread for kafka1:9092 completed
2025-04-27 00:40:12,988 - INFO - Skipping recovery for kafka1:9092, last attempt 16.8s ago
2025-04-27 00:40:13,022 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:13,034 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:13,775 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:40:13,787 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:40:15,811 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:40:15,833 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:40:17,874 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:40:17,922 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:40:18,035 - INFO - Skipping recovery for kafka1:9092, last attempt 21.8s ago
2025-04-27 00:40:18,049 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:18,060 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:19,939 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:40:19,945 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:40:21,965 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:40:21,970 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:40:23,068 - INFO - Skipping recovery for kafka1:9092, last attempt 26.9s ago
2025-04-27 00:40:23,096 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:23,117 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:24,035 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:40:24,057 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:40:26,089 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:40:26,119 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:40:28,138 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:40:28,143 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:28,167 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:40:28,190 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:28,217 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:30,182 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:40:30,229 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:40:32,264 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:40:32,283 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:40:33,255 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:33,286 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:33,344 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:34,308 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:40:34,315 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:40:36,335 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:40:36,360 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:40:38,370 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:38,389 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:40:38,410 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:38,424 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:40:38,439 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:40,445 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:40:40,449 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:40:42,496 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:40:42,506 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:40:43,464 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:43,478 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:43,520 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:44,521 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:40:44,545 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:40:46,559 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:40:46,563 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:40:48,563 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:48,596 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:40:48,601 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:48,616 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:40:48,625 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:50,657 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:40:50,705 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:40:52,724 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:40:52,733 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:40:53,666 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:53,687 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:53,702 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:54,752 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:40:54,755 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:40:56,775 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:40:56,780 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:40:58,714 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-27 00:40:58,715 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-27 00:40:58,716 - INFO - Starting recovery thread for kafka1:9092
2025-04-27 00:40:58,716 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-27 00:40:58,716 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: RESOURCE_OPTIMIZED
2025-04-27 00:40:58,769 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:58,770 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:58,792 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:58,792 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:40:58,800 - INFO - Using strategy buffer configuration
2025-04-27 00:40:58,808 - INFO - Found broker IDs: [2, 3, 1]
2025-04-27 00:40:58,818 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:40:58,828 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:40:58,991 - INFO - Successfully applied config to broker 2
2025-04-27 00:40:59,118 - INFO - Successfully applied config to broker 3
2025-04-27 00:40:59,718 - INFO - Successfully applied config to broker 1
2025-04-27 00:40:59,720 - INFO - Applied configuration to all available brokers from buffer
2025-04-27 00:40:59,738 - INFO - Triggering leader election
2025-04-27 00:40:59,757 - INFO - Listing topics for leader election
2025-04-27 00:40:59,805 - INFO - Found 1 topics for leader election
2025-04-27 00:40:59,806 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 00:40:59,806 - INFO - Leader election completed in 0.05 seconds, success: False
2025-04-27 00:40:59,821 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-27 00:41:00,795 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:41:00,825 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:41:00,860 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:41:00,900 - ERROR - API returned status code: 500
2025-04-27 00:41:02,866 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:41:02,884 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:41:02,895 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:41:02,912 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:41:03,001 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:41:04,901 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:41:04,911 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:41:04,927 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:41:05,015 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:41:05,018 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:41:06,931 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:41:06,948 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:41:06,962 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:41:07,038 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:41:07,064 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:41:08,984 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:41:09,091 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:41:09,099 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:41:09,116 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:41:09,119 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:41:11,125 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:41:11,143 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:41:11,148 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:41:11,158 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:41:11,160 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:41:13,167 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:41:13,194 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:41:13,203 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:41:13,238 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:41:13,246 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:41:14,838 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-27 00:41:14,841 - INFO - Attempting broker recovery for kafka1
2025-04-27 00:41:14,841 - INFO - Attempting internal recovery for broker 1
2025-04-27 00:41:14,842 - INFO - Triggering internal recovery for broker 1
2025-04-27 00:41:14,858 - INFO - Found 1 partitions on broker 1
2025-04-27 00:41:14,858 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-27 00:41:14,858 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 00:41:14,858 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-27 00:41:14,865 - INFO - Successfully triggered internal recovery for broker 1
2025-04-27 00:41:14,889 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:41:14,944 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-27 00:41:14,944 - INFO - Recovery successful for broker kafka1:9092
2025-04-27 00:41:14,944 - INFO - Recovery thread for kafka1:9092 completed
2025-04-27 00:41:15,244 - INFO - Skipping recovery for kafka1:9092, last attempt 16.5s ago
2025-04-27 00:41:15,251 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:41:15,264 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:41:15,268 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:41:15,270 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:41:17,319 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:41:17,393 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:41:19,433 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:41:19,533 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:41:20,277 - INFO - Skipping recovery for kafka1:9092, last attempt 21.6s ago
2025-04-27 00:41:20,520 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:41:20,689 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:41:21,559 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:41:21,570 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:41:23,588 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:41:23,593 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:41:25,633 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:41:25,652 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:41:25,695 - INFO - Skipping recovery for kafka1:9092, last attempt 27.0s ago
2025-04-27 00:41:25,730 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:41:25,877 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:41:27,669 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:41:27,675 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:41:29,748 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:41:29,797 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:41:30,963 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:41:31,013 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:41:31,045 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:41:32,304 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:41:32,364 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:41:34,384 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:41:34,420 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:41:36,334 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:41:36,397 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:41:36,447 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:41:36,505 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:41:36,587 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:41:38,513 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:41:38,514 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:41:40,529 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:41:40,580 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:41:41,618 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:41:41,657 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:41:41,671 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:41:42,621 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:41:42,625 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:41:44,652 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:41:44,681 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:41:46,759 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:41:46,796 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:41:46,820 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:41:46,835 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:41:46,891 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:41:48,849 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:41:48,890 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:41:50,955 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:41:51,032 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:41:51,960 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:41:52,025 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:41:52,095 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:41:53,091 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:41:53,142 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:41:55,187 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:41:55,200 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:41:57,169 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:41:57,246 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:41:57,285 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:41:57,306 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:41:57,341 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:41:59,358 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:41:59,382 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:42:01,396 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:42:01,492 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:42:02,311 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-27 00:42:02,312 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-27 00:42:02,315 - INFO - Starting recovery thread for kafka1:9092
2025-04-27 00:42:02,316 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-27 00:42:02,317 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: RESOURCE_OPTIMIZED
2025-04-27 00:42:02,373 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:02,377 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:02,391 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:02,394 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:02,402 - INFO - Using strategy buffer configuration
2025-04-27 00:42:02,412 - INFO - Found broker IDs: [2, 3, 1]
2025-04-27 00:42:02,951 - INFO - Successfully applied config to broker 2
2025-04-27 00:42:03,516 - INFO - Successfully applied config to broker 3
2025-04-27 00:42:03,543 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:42:03,589 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:42:03,674 - INFO - Successfully applied config to broker 1
2025-04-27 00:42:03,675 - INFO - Applied configuration to all available brokers from buffer
2025-04-27 00:42:03,684 - INFO - Triggering leader election
2025-04-27 00:42:03,693 - INFO - Listing topics for leader election
2025-04-27 00:42:03,769 - INFO - Found 1 topics for leader election
2025-04-27 00:42:03,769 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 00:42:03,769 - INFO - Leader election completed in 0.08 seconds, success: False
2025-04-27 00:42:03,776 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-27 00:42:04,408 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:42:04,433 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:04,449 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:05,632 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:42:05,690 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:42:06,453 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:42:06,477 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:06,544 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:07,711 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:42:07,746 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:42:08,547 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:42:08,579 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:08,596 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:09,778 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:42:09,798 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:42:10,600 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:42:10,631 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:10,646 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:11,823 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:42:11,883 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:42:12,648 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:42:12,685 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:12,750 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:14,053 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:42:14,106 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:42:14,760 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:42:14,877 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:14,900 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:16,139 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:42:16,166 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:42:16,902 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:42:16,945 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:16,967 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:18,192 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:42:18,202 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:42:18,783 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-27 00:42:18,784 - INFO - Attempting broker recovery for kafka1
2025-04-27 00:42:18,784 - INFO - Attempting internal recovery for broker 1
2025-04-27 00:42:18,786 - INFO - Triggering internal recovery for broker 1
2025-04-27 00:42:18,834 - INFO - Found 1 partitions on broker 1
2025-04-27 00:42:18,838 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-27 00:42:18,838 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 00:42:18,839 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-27 00:42:18,849 - INFO - Successfully triggered internal recovery for broker 1
2025-04-27 00:42:18,971 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:42:19,173 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:19,287 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:19,417 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:20,053 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-27 00:42:20,054 - INFO - Recovery successful for broker kafka1:9092
2025-04-27 00:42:20,061 - INFO - Recovery thread for kafka1:9092 completed
2025-04-27 00:42:20,245 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:42:20,277 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:42:21,303 - INFO - Skipping recovery for kafka1:9092, last attempt 19.0s ago
2025-04-27 00:42:21,357 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:21,400 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:22,312 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:42:22,331 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:42:24,350 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:42:24,364 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:42:26,378 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:42:26,386 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:42:26,415 - INFO - Skipping recovery for kafka1:9092, last attempt 24.1s ago
2025-04-27 00:42:26,439 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:26,473 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:28,416 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:42:28,436 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:42:30,468 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:42:30,504 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:42:31,476 - INFO - Skipping recovery for kafka1:9092, last attempt 29.2s ago
2025-04-27 00:42:31,558 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:31,621 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:32,552 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:42:32,604 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:42:34,677 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:42:34,708 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:42:36,734 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:36,799 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:42:36,820 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:42:36,894 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:36,956 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:38,901 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:42:38,958 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:42:41,053 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:42:41,077 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:42:42,079 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:42,297 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:42,356 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:43,170 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:42:43,230 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:42:45,270 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:42:45,291 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:42:47,328 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:42:47,368 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:42:47,533 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:47,616 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:47,670 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:49,396 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:42:49,423 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:42:51,489 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:42:51,522 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:42:52,745 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:52,861 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:52,941 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:53,577 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:42:53,705 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:42:55,755 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:42:55,792 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:42:57,849 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:42:57,862 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:42:58,085 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:58,177 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:58,243 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:42:59,938 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:42:59,993 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:43:02,043 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:43:02,069 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:43:03,259 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-27 00:43:03,269 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-27 00:43:03,400 - INFO - Starting recovery thread for kafka1:9092
2025-04-27 00:43:03,466 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-27 00:43:03,484 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: RESOURCE_OPTIMIZED
2025-04-27 00:43:03,705 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:03,741 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:04,137 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:43:04,146 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:43:04,384 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:04,575 - INFO - Using strategy buffer configuration
2025-04-27 00:43:04,607 - INFO - Found broker IDs: [2, 3, 1]
2025-04-27 00:43:05,041 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:05,822 - INFO - Successfully applied config to broker 2
2025-04-27 00:43:06,222 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:43:06,259 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:43:08,073 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:43:08,111 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:08,140 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:08,911 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:43:08,941 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:43:09,062 - INFO - Successfully applied config to broker 3
2025-04-27 00:43:09,363 - INFO - Successfully applied config to broker 1
2025-04-27 00:43:09,365 - INFO - Applied configuration to all available brokers from buffer
2025-04-27 00:43:09,372 - INFO - Triggering leader election
2025-04-27 00:43:09,377 - INFO - Listing topics for leader election
2025-04-27 00:43:09,683 - INFO - Found 1 topics for leader election
2025-04-27 00:43:09,684 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 00:43:09,685 - INFO - Leader election completed in 0.31 seconds, success: False
2025-04-27 00:43:09,696 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-27 00:43:10,142 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:43:10,215 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:10,258 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:11,013 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:43:11,047 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:43:12,251 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:43:12,714 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:12,935 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:13,126 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:43:13,198 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:43:14,947 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:43:15,292 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:43:15,354 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:43:15,474 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:15,758 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:17,461 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:43:17,467 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:43:17,767 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:43:17,825 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:17,871 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:19,476 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:43:19,490 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:43:19,881 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:43:19,904 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:19,927 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:21,513 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:43:21,550 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:43:21,930 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:43:22,028 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:22,094 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:23,594 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:43:23,620 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:43:24,103 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:43:24,119 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:24,133 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:24,692 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-27 00:43:24,693 - INFO - Attempting broker recovery for kafka1
2025-04-27 00:43:24,693 - INFO - Attempting internal recovery for broker 1
2025-04-27 00:43:24,694 - INFO - Triggering internal recovery for broker 1
2025-04-27 00:43:24,716 - INFO - Found 1 partitions on broker 1
2025-04-27 00:43:24,717 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-27 00:43:24,717 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 00:43:24,717 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-27 00:43:24,719 - INFO - Successfully triggered internal recovery for broker 1
2025-04-27 00:43:25,161 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:25,455 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-27 00:43:25,456 - INFO - Recovery successful for broker kafka1:9092
2025-04-27 00:43:25,456 - INFO - Recovery thread for kafka1:9092 completed
2025-04-27 00:43:26,139 - INFO - Skipping recovery for kafka1:9092, last attempt 22.9s ago
2025-04-27 00:43:26,191 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:26,264 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:26,355 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:43:26,441 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:43:28,544 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:43:28,618 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:43:30,673 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:43:30,783 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:43:31,277 - INFO - Skipping recovery for kafka1:9092, last attempt 28.0s ago
2025-04-27 00:43:31,435 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:31,479 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:32,866 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:43:32,882 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:43:34,996 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:43:35,005 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:43:36,543 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:36,600 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:36,634 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:37,048 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:43:37,058 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:43:39,076 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:43:39,096 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:43:41,158 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:43:41,218 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:43:41,682 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:41,866 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:41,925 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:43,289 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:43:43,332 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:43:45,360 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:43:45,419 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:43:46,959 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:46,983 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:47,047 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:47,438 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:43:47,456 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:43:49,486 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:43:49,526 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:43:51,603 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:43:51,609 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:43:52,104 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:52,296 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:52,372 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:53,658 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:43:53,682 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:43:55,710 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:43:55,940 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:43:57,410 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:57,586 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:57,604 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:43:57,949 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:43:58,029 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:44:00,123 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:44:00,195 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:44:04,274 - ERROR - API returned status code: 500
2025-04-27 00:44:04,406 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:44:04,467 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:44:04,542 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:44:06,344 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:44:06,396 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:44:08,455 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:44:08,551 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:44:09,556 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-27 00:44:09,607 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-27 00:44:09,617 - INFO - Starting recovery thread for kafka1:9092
2025-04-27 00:44:09,621 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-27 00:44:09,622 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: RESOURCE_OPTIMIZED
2025-04-27 00:44:09,761 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:44:09,765 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:44:09,809 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:44:09,809 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:44:09,823 - INFO - Using strategy buffer configuration
2025-04-27 00:44:09,838 - INFO - Found broker IDs: [2, 3, 1]
2025-04-27 00:44:10,237 - INFO - Successfully applied config to broker 2
2025-04-27 00:44:10,531 - INFO - Successfully applied config to broker 3
2025-04-27 00:44:10,775 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:44:10,946 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:44:11,216 - INFO - Successfully applied config to broker 1
2025-04-27 00:44:11,216 - INFO - Applied configuration to all available brokers from buffer
2025-04-27 00:44:11,238 - INFO - Triggering leader election
2025-04-27 00:44:11,247 - INFO - Listing topics for leader election
2025-04-27 00:44:11,444 - INFO - Found 1 topics for leader election
2025-04-27 00:44:11,445 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 00:44:11,446 - INFO - Leader election completed in 0.20 seconds, success: False
2025-04-27 00:44:11,452 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-27 00:44:11,846 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:44:11,874 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:44:11,920 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:44:13,031 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:44:13,095 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:44:13,927 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:44:14,038 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:44:14,142 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:44:15,138 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:44:15,163 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:44:16,147 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:44:16,173 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:44:16,216 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:44:17,203 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:44:17,215 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:44:18,220 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:44:18,261 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:44:18,305 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:44:19,253 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:44:19,280 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:44:20,310 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:44:20,373 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:44:20,390 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:44:21,309 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:44:21,316 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:44:22,399 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:44:22,485 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:44:22,521 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:44:23,329 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:44:23,345 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:44:24,528 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:44:24,583 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:44:24,626 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:44:25,393 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:44:25,418 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:44:26,491 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-27 00:44:26,498 - INFO - Attempting broker recovery for kafka1
2025-04-27 00:44:26,501 - INFO - Attempting internal recovery for broker 1
2025-04-27 00:44:26,501 - INFO - Triggering internal recovery for broker 1
2025-04-27 00:44:26,523 - INFO - Found 1 partitions on broker 1
2025-04-27 00:44:26,523 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-27 00:44:26,523 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 00:44:26,524 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-27 00:44:26,526 - INFO - Successfully triggered internal recovery for broker 1
2025-04-27 00:44:26,563 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:44:26,629 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:44:26,653 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:44:26,675 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:44:26,776 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-27 00:44:26,776 - INFO - Recovery successful for broker kafka1:9092
2025-04-27 00:44:26,776 - INFO - Recovery thread for kafka1:9092 completed
2025-04-27 00:44:27,456 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:44:27,462 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:44:28,679 - INFO - Skipping recovery for kafka1:9092, last attempt 19.1s ago
2025-04-27 00:44:28,695 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:44:28,732 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:44:29,479 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:44:29,545 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:44:31,568 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:44:31,643 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:44:33,706 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:44:33,738 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:44:33,739 - INFO - Skipping recovery for kafka1:9092, last attempt 24.2s ago
2025-04-27 00:44:34,148 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:44:34,357 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:44:36,056 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:44:36,089 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:44:39,387 - INFO - Skipping recovery for kafka1:9092, last attempt 29.8s ago
2025-04-27 00:44:39,859 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:44:39,977 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:44:40,079 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:44:40,271 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:44:42,335 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:44:42,368 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:44:44,542 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:44:44,634 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:44:45,468 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:44:46,965 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:44:46,982 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:44:46,986 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:44:47,157 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:44:49,106 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:44:49,234 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:44:51,360 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:44:51,409 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:44:52,716 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:44:53,036 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:44:53,186 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:44:53,501 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:44:53,560 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:44:55,772 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:44:55,851 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:44:57,946 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:44:58,301 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:44:58,668 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:44:58,956 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:44:59,133 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:45:00,754 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:45:00,825 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:45:03,234 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:45:03,321 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:45:04,799 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:45:05,102 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:48:33,988 - INFO - PRIMARY KAFKA BROKERS (for monitoring): ['kafka1:9092', 'kafka2:9093', 'kafka3:9094']
2025-04-27 00:48:33,989 - INFO - Container names: ['kafka1', 'kafka2', 'kafka3']
2025-04-27 00:48:33,989 - INFO - Alternative addresses (for connection attempts ONLY): ['kafka1:29092', 'kafka2:29093', 'kafka3:29094']
2025-04-27 00:48:33,989 - INFO - Starting Kafka Arms Controller
2025-04-27 00:48:34,710 - INFO - PRIMARY KAFKA BROKERS (for monitoring): ['kafka1:9092', 'kafka2:9093', 'kafka3:9094']
2025-04-27 00:48:34,711 - INFO - Container names: ['kafka1', 'kafka2', 'kafka3']
2025-04-27 00:48:34,711 - INFO - Alternative addresses (for connection attempts ONLY): ['kafka1:29092', 'kafka2:29093', 'kafka3:29094']
2025-04-27 00:48:34,711 - INFO - Starting Kafka Arms Controller
2025-04-27 00:48:35,559 - INFO - PRIMARY KAFKA BROKERS (for monitoring): ['kafka1:9092', 'kafka2:9093', 'kafka3:9094']
2025-04-27 00:48:35,560 - INFO - Container names: ['kafka1', 'kafka2', 'kafka3']
2025-04-27 00:48:35,560 - INFO - Alternative addresses (for connection attempts ONLY): ['kafka1:29092', 'kafka2:29093', 'kafka3:29094']
2025-04-27 00:48:35,561 - INFO - Starting Kafka Arms Controller
2025-04-27 00:48:36,439 - INFO - PRIMARY KAFKA BROKERS (for monitoring): ['kafka1:9092', 'kafka2:9093', 'kafka3:9094']
2025-04-27 00:48:36,439 - INFO - Container names: ['kafka1', 'kafka2', 'kafka3']
2025-04-27 00:48:36,439 - INFO - Alternative addresses (for connection attempts ONLY): ['kafka1:29092', 'kafka2:29093', 'kafka3:29094']
2025-04-27 00:48:36,439 - INFO - Starting Kafka Arms Controller
2025-04-27 00:48:37,865 - INFO - PRIMARY KAFKA BROKERS (for monitoring): ['kafka1:9092', 'kafka2:9093', 'kafka3:9094']
2025-04-27 00:48:37,865 - INFO - Container names: ['kafka1', 'kafka2', 'kafka3']
2025-04-27 00:48:37,865 - INFO - Alternative addresses (for connection attempts ONLY): ['kafka1:29092', 'kafka2:29093', 'kafka3:29094']
2025-04-27 00:48:37,866 - INFO - Starting Kafka Arms Controller
2025-04-27 00:48:40,672 - INFO - PRIMARY KAFKA BROKERS (for monitoring): ['kafka1:9092', 'kafka2:9093', 'kafka3:9094']
2025-04-27 00:48:40,675 - INFO - Container names: ['kafka1', 'kafka2', 'kafka3']
2025-04-27 00:48:40,675 - INFO - Alternative addresses (for connection attempts ONLY): ['kafka1:29092', 'kafka2:29093', 'kafka3:29094']
2025-04-27 00:48:40,675 - INFO - Starting Kafka Arms Controller
2025-04-27 00:48:44,413 - INFO - PRIMARY KAFKA BROKERS (for monitoring): ['kafka1:9092', 'kafka2:9093', 'kafka3:9094']
2025-04-27 00:48:44,413 - INFO - Container names: ['kafka1', 'kafka2', 'kafka3']
2025-04-27 00:48:44,413 - INFO - Alternative addresses (for connection attempts ONLY): ['kafka1:29092', 'kafka2:29093', 'kafka3:29094']
2025-04-27 00:48:44,414 - INFO - Starting Kafka Arms Controller
2025-04-27 00:48:51,300 - INFO - PRIMARY KAFKA BROKERS (for monitoring): ['kafka1:9092', 'kafka2:9093', 'kafka3:9094']
2025-04-27 00:48:51,300 - INFO - Container names: ['kafka1', 'kafka2', 'kafka3']
2025-04-27 00:48:51,301 - INFO - Alternative addresses (for connection attempts ONLY): ['kafka1:29092', 'kafka2:29093', 'kafka3:29094']
2025-04-27 00:48:51,301 - INFO - Starting Kafka Arms Controller
2025-04-27 00:49:05,019 - INFO - PRIMARY KAFKA BROKERS (for monitoring): ['kafka1:9092', 'kafka2:9093', 'kafka3:9094']
2025-04-27 00:49:05,022 - INFO - Container names: ['kafka1', 'kafka2', 'kafka3']
2025-04-27 00:49:05,022 - INFO - Alternative addresses (for connection attempts ONLY): ['kafka1:29092', 'kafka2:29093', 'kafka3:29094']
2025-04-27 00:49:05,023 - INFO - Starting Kafka Arms Controller
2025-04-27 00:49:32,245 - INFO - PRIMARY KAFKA BROKERS (for monitoring): ['kafka1:9092', 'kafka2:9093', 'kafka3:9094']
2025-04-27 00:49:32,245 - INFO - Container names: ['kafka1', 'kafka2', 'kafka3']
2025-04-27 00:49:32,246 - INFO - Alternative addresses (for connection attempts ONLY): ['kafka1:29092', 'kafka2:29093', 'kafka3:29094']
2025-04-27 00:49:32,246 - INFO - Starting Kafka Arms Controller
2025-04-27 00:50:25,894 - INFO - PRIMARY KAFKA BROKERS (for monitoring): ['kafka1:9092', 'kafka2:9093', 'kafka3:9094']
2025-04-27 00:50:25,895 - INFO - Container names: ['kafka1', 'kafka2', 'kafka3']
2025-04-27 00:50:25,895 - INFO - Alternative addresses (for connection attempts ONLY): ['kafka1:29092', 'kafka2:29093', 'kafka3:29094']
2025-04-27 00:50:25,895 - INFO - Starting Kafka Arms Controller
2025-04-27 00:51:27,909 - INFO - PRIMARY KAFKA BROKERS (for monitoring): ['kafka1:9092', 'kafka2:9093', 'kafka3:9094']
2025-04-27 00:51:27,910 - INFO - Container names: ['kafka1', 'kafka2', 'kafka3']
2025-04-27 00:51:27,910 - INFO - Alternative addresses (for connection attempts ONLY): ['kafka1:29092', 'kafka2:29093', 'kafka3:29094']
2025-04-27 00:51:27,910 - INFO - Starting Kafka Arms Controller
2025-04-27 00:52:29,416 - INFO - PRIMARY KAFKA BROKERS (for monitoring): ['kafka1:9092', 'kafka2:9093', 'kafka3:9094']
2025-04-27 00:52:29,418 - INFO - Container names: ['kafka1', 'kafka2', 'kafka3']
2025-04-27 00:52:29,418 - INFO - Alternative addresses (for connection attempts ONLY): ['kafka1:29092', 'kafka2:29093', 'kafka3:29094']
2025-04-27 00:52:29,419 - INFO - Starting Kafka Arms Controller
2025-04-27 00:53:31,509 - INFO - PRIMARY KAFKA BROKERS (for monitoring): ['kafka1:9092', 'kafka2:9093', 'kafka3:9094']
2025-04-27 00:53:31,510 - INFO - Container names: ['kafka1', 'kafka2', 'kafka3']
2025-04-27 00:53:31,510 - INFO - Alternative addresses (for connection attempts ONLY): ['kafka1:29092', 'kafka2:29093', 'kafka3:29094']
2025-04-27 00:53:31,511 - INFO - Starting Kafka Arms Controller
2025-04-27 00:54:35,139 - INFO - PRIMARY KAFKA BROKERS (for monitoring): ['kafka1:9092', 'kafka2:9093', 'kafka3:9094']
2025-04-27 00:54:35,154 - INFO - Container names: ['kafka1', 'kafka2', 'kafka3']
2025-04-27 00:54:35,154 - INFO - Alternative addresses (for connection attempts ONLY): ['kafka1:29092', 'kafka2:29093', 'kafka3:29094']
2025-04-27 00:54:35,155 - INFO - Starting Kafka Arms Controller
2025-04-27 00:58:05,922 - INFO - PRIMARY KAFKA BROKERS (for monitoring): ['kafka1:9092', 'kafka2:9093', 'kafka3:9094']
2025-04-27 00:58:05,923 - INFO - Container names: ['kafka1', 'kafka2', 'kafka3']
2025-04-27 00:58:05,923 - INFO - Alternative addresses (for connection attempts ONLY): ['kafka1:29092', 'kafka2:29093', 'kafka3:29094']
2025-04-27 00:58:05,924 - INFO - Starting Kafka Arms Controller
2025-04-27 00:58:05,943 - INFO - Started Prometheus metrics server on port 8002
2025-04-27 00:58:05,964 - INFO - Loaded strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 00:58:06,042 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:58:06,065 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:58:08,133 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:58:08,225 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:58:09,971 - INFO - Monitoring these brokers ONLY: ['kafka1:9092', 'kafka2:9093', 'kafka3:9094']
2025-04-27 00:58:09,972 - INFO - TEST MODE ENABLED - Will simulate failures for kafka1:9092 every 60 seconds
2025-04-27 00:58:09,972 - INFO - Test mode initialized, broker kafka1:9092 will be tested on next check
2025-04-27 00:58:09,977 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-27 00:58:09,978 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-27 00:58:09,978 - INFO - Starting recovery thread for kafka1:9092
2025-04-27 00:58:09,978 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-27 00:58:09,978 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: CONTROLLED_GRADUAL
2025-04-27 00:58:10,271 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:58:10,294 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:58:12,390 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:58:12,397 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:58:14,443 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:58:14,476 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:58:16,510 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:58:16,562 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:58:18,588 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:58:18,641 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:58:20,065 - WARNING - Broker kafka2:9093 availability check failed: KafkaError{code=_TRANSPORT,val=-195,str="Failed to get metadata: Local: Broker transport failure"}
2025-04-27 00:58:20,099 - WARNING - Broker kafka2:9093 availability check failed: KafkaError{code=_TRANSPORT,val=-195,str="Failed to get metadata: Local: Broker transport failure"}
2025-04-27 00:58:20,718 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:58:20,763 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:58:22,799 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:58:22,810 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:58:24,809 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:58:24,845 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:58:26,886 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:58:27,020 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:58:29,038 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:58:29,062 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:58:30,094 - WARNING - Broker kafka1:29092 availability check failed: KafkaError{code=_TRANSPORT,val=-195,str="Failed to get metadata: Local: Broker transport failure"}
2025-04-27 00:58:30,105 - WARNING - Broker kafka1:29092 availability check failed: KafkaError{code=_TRANSPORT,val=-195,str="Failed to get metadata: Local: Broker transport failure"}
2025-04-27 00:58:31,206 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:58:31,239 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:58:33,782 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:58:33,863 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:58:35,966 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:58:36,005 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:58:38,047 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:58:38,094 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:58:40,131 - WARNING - Broker kafka2:29093 availability check failed: KafkaError{code=_TRANSPORT,val=-195,str="Failed to get metadata: Local: Broker transport failure"}
2025-04-27 00:58:40,147 - WARNING - Broker kafka2:29093 availability check failed: KafkaError{code=_TRANSPORT,val=-195,str="Failed to get metadata: Local: Broker transport failure"}
2025-04-27 00:58:40,341 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:58:40,420 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:58:42,563 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:58:42,599 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:58:44,638 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:58:44,728 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:58:46,788 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:58:46,832 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:58:48,957 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:58:48,998 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:58:50,229 - WARNING - Broker kafka3:29094 availability check failed: KafkaError{code=_TIMED_OUT,val=-185,str="Failed to get metadata: Local: Timed out"}
2025-04-27 00:58:50,263 - ERROR - All connection strategies failed for broker kafka2:9093
2025-04-27 00:58:50,847 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:58:50,848 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:58:50,913 - INFO - Using default Kafka recovery configuration
2025-04-27 00:58:51,007 - INFO - Found broker IDs: [2, 3, 1]
2025-04-27 00:58:51,007 - INFO - No non-None configuration values to apply
2025-04-27 00:58:51,018 - INFO - Triggering leader election
2025-04-27 00:58:51,019 - INFO - Listing topics for leader election
2025-04-27 00:58:51,071 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:58:51,160 - WARNING - No topics found for leader election
2025-04-27 00:58:51,177 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:58:51,192 - WARNING - Leader election not completely successful, but continuing recovery
2025-04-27 00:58:51,192 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-27 00:58:51,959 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:58:53,270 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:58:53,321 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:58:53,966 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:58:54,158 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:58:54,234 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:58:55,447 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:58:55,457 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:58:56,284 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:58:56,424 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:58:56,630 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:58:57,561 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:58:57,598 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:58:58,641 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:58:58,773 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:58:59,642 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:58:59,677 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:58:59,883 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:01,739 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:59:01,764 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:59:01,892 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:59:01,922 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:01,972 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:03,798 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:59:03,806 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:59:04,000 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:59:04,047 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:04,067 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:05,817 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:59:05,838 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:59:06,071 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:59:06,347 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-27 00:59:06,349 - INFO - Attempting broker recovery for kafka1
2025-04-27 00:59:06,349 - INFO - Attempting internal recovery for broker 1
2025-04-27 00:59:06,352 - INFO - Triggering internal recovery for broker 1
2025-04-27 00:59:06,353 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:06,485 - INFO - Found 1 partitions on broker 1
2025-04-27 00:59:06,485 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-27 00:59:06,486 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 00:59:06,486 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-27 00:59:06,495 - INFO - Successfully triggered internal recovery for broker 1
2025-04-27 00:59:06,532 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:06,887 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:07,138 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-27 00:59:07,139 - INFO - Recovery successful for broker kafka1:9092
2025-04-27 00:59:07,139 - INFO - Recovery thread for kafka1:9092 completed
2025-04-27 00:59:07,866 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:59:07,874 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:59:08,596 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:08,673 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:08,745 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:09,913 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:59:09,925 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:59:11,938 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:59:11,943 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:59:13,752 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-27 00:59:13,756 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-27 00:59:13,760 - INFO - Starting recovery thread for kafka1:9092
2025-04-27 00:59:13,764 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-27 00:59:13,764 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: CONTROLLED_GRADUAL
2025-04-27 00:59:13,817 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:13,826 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:13,909 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:13,929 - INFO - Using default Kafka recovery configuration
2025-04-27 00:59:13,958 - INFO - Found broker IDs: [2, 3, 1]
2025-04-27 00:59:13,958 - INFO - No non-None configuration values to apply
2025-04-27 00:59:13,970 - INFO - Triggering leader election
2025-04-27 00:59:13,973 - INFO - Listing topics for leader election
2025-04-27 00:59:14,004 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:59:14,008 - INFO - Found 1 topics for leader election
2025-04-27 00:59:14,008 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 00:59:14,009 - INFO - Leader election completed in 0.04 seconds, success: False
2025-04-27 00:59:14,028 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-27 00:59:14,038 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:59:14,836 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:16,055 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:59:16,067 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:59:16,846 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:59:16,899 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:16,930 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:18,214 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:59:18,239 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:59:18,933 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:59:19,039 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:19,077 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:20,268 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:59:20,362 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:59:21,097 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:59:21,126 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:21,149 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:22,392 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:59:22,398 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:59:23,156 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:59:23,191 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:23,250 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:24,412 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:59:24,454 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:59:25,243 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:59:25,282 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:25,327 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:26,487 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:59:26,496 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:59:27,342 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 00:59:27,399 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:27,551 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:28,535 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-27 00:59:28,558 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:59:29,037 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-27 00:59:29,038 - INFO - Attempting broker recovery for kafka1
2025-04-27 00:59:29,038 - INFO - Attempting internal recovery for broker 1
2025-04-27 00:59:29,039 - INFO - Triggering internal recovery for broker 1
2025-04-27 00:59:29,088 - INFO - Found 1 partitions on broker 1
2025-04-27 00:59:29,088 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-27 00:59:29,089 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 00:59:29,089 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-27 00:59:29,094 - INFO - Successfully triggered internal recovery for broker 1
2025-04-27 00:59:29,169 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:29,226 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-27 00:59:29,226 - INFO - Recovery successful for broker kafka1:9092
2025-04-27 00:59:29,227 - INFO - Recovery thread for kafka1:9092 completed
2025-04-27 00:59:29,588 - INFO - Skipping recovery for kafka1:9092, last attempt 15.8s ago
2025-04-27 00:59:29,609 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:29,625 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:30,576 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:59:30,581 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:59:32,621 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:59:32,663 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:59:34,641 - INFO - Skipping recovery for kafka1:9092, last attempt 20.9s ago
2025-04-27 00:59:34,763 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:59:34,818 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:59:34,882 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:35,032 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:36,888 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:59:36,973 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:59:38,992 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:59:39,005 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:59:40,040 - INFO - Skipping recovery for kafka1:9092, last attempt 26.3s ago
2025-04-27 00:59:40,070 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:40,092 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:41,042 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:59:41,070 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:59:43,097 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:59:43,132 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:59:45,115 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:45,172 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:59:45,194 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:59:45,212 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:45,255 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:47,287 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:59:47,300 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:59:49,355 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:59:49,429 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:59:50,291 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:50,359 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:50,394 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:51,459 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:59:51,469 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:59:53,486 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:59:53,495 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:59:55,432 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:55,460 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:55,565 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 00:59:55,584 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:59:55,592 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:59:57,620 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:59:57,629 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 00:59:59,669 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 00:59:59,729 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:00:00,617 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:00,718 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:00,787 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:01,758 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:00:01,768 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:00:03,824 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:00:03,850 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:00:05,858 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:05,957 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:06,055 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:00:06,125 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:00:06,208 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:08,229 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:00:08,268 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:00:10,289 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:00:10,297 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:00:11,257 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:11,283 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:11,336 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:12,352 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:00:12,359 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:00:14,435 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:00:14,449 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:00:16,342 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-27 01:00:16,346 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-27 01:00:16,347 - INFO - Starting recovery thread for kafka1:9092
2025-04-27 01:00:16,348 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-27 01:00:16,348 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE
2025-04-27 01:00:16,434 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:16,438 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:16,608 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:16,609 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:00:16,639 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:16,724 - INFO - Using default Kafka recovery configuration
2025-04-27 01:00:16,740 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:00:16,798 - INFO - Found broker IDs: [2, 3, 1]
2025-04-27 01:00:16,798 - INFO - No non-None configuration values to apply
2025-04-27 01:00:16,802 - INFO - Triggering leader election
2025-04-27 01:00:16,814 - INFO - Listing topics for leader election
2025-04-27 01:00:16,851 - INFO - Found 1 topics for leader election
2025-04-27 01:00:16,851 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 01:00:16,851 - INFO - Leader election completed in 0.04 seconds, success: False
2025-04-27 01:00:16,856 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-27 01:00:18,618 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:00:18,665 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:18,706 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:18,760 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:00:18,807 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:00:20,712 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:00:20,849 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:20,884 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:00:20,892 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:20,898 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:00:22,900 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:00:22,953 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:22,970 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:00:23,058 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:00:23,063 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:25,072 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:00:25,192 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:25,214 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:00:25,333 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:00:25,599 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:27,515 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:00:27,553 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:00:27,610 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:00:27,753 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:27,955 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:29,622 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:00:29,630 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:00:29,962 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:00:30,008 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:30,177 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:31,718 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:00:31,731 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:00:31,851 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-27 01:00:31,853 - INFO - Attempting broker recovery for kafka1
2025-04-27 01:00:31,853 - INFO - Attempting internal recovery for broker 1
2025-04-27 01:00:31,853 - INFO - Triggering internal recovery for broker 1
2025-04-27 01:00:31,943 - INFO - Found 1 partitions on broker 1
2025-04-27 01:00:31,944 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-27 01:00:31,944 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 01:00:31,944 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-27 01:00:31,953 - INFO - Successfully triggered internal recovery for broker 1
2025-04-27 01:00:32,005 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:32,191 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:00:32,222 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:32,321 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:32,380 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-27 01:00:32,380 - INFO - Recovery successful for broker kafka1:9092
2025-04-27 01:00:32,381 - INFO - Recovery thread for kafka1:9092 completed
2025-04-27 01:00:33,789 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:00:33,834 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:00:34,332 - INFO - Skipping recovery for kafka1:9092, last attempt 18.0s ago
2025-04-27 01:00:34,400 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:34,508 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:35,935 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:00:35,960 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:00:37,986 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:00:38,060 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:00:39,516 - INFO - Skipping recovery for kafka1:9092, last attempt 23.2s ago
2025-04-27 01:00:39,723 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:39,804 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:40,150 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:00:40,237 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:00:42,323 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:00:42,369 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:00:44,406 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:00:44,411 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:00:45,892 - INFO - Skipping recovery for kafka1:9092, last attempt 29.5s ago
2025-04-27 01:00:46,091 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:47,694 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:47,886 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:00:47,897 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:00:49,980 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:00:50,097 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:00:52,156 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:00:52,163 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:00:52,757 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:52,837 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:52,900 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:54,217 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:00:54,244 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:00:56,298 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:00:56,308 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:00:57,936 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:58,013 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:58,069 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:00:58,343 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:00:58,392 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:01:00,488 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:01:00,556 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:01:02,585 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:01:02,591 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:01:03,111 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:03,214 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:03,300 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:04,599 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:01:04,602 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:01:06,671 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:01:06,704 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:01:08,361 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:08,440 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:08,551 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:08,782 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:01:08,842 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:01:10,872 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:01:10,876 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:01:12,886 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:01:12,888 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:01:13,608 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:13,641 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:13,675 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:14,914 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:01:14,954 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:01:17,047 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:01:17,064 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:01:18,683 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-27 01:01:18,685 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-27 01:01:18,688 - INFO - Starting recovery thread for kafka1:9092
2025-04-27 01:01:18,688 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-27 01:01:18,688 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE
2025-04-27 01:01:18,812 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:18,816 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:18,882 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:19,130 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:01:19,160 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:01:19,889 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:19,939 - INFO - Using default Kafka recovery configuration
2025-04-27 01:01:19,985 - INFO - Found broker IDs: [2, 3, 1]
2025-04-27 01:01:19,986 - INFO - No non-None configuration values to apply
2025-04-27 01:01:20,009 - INFO - Triggering leader election
2025-04-27 01:01:20,035 - INFO - Listing topics for leader election
2025-04-27 01:01:20,217 - INFO - Found 1 topics for leader election
2025-04-27 01:01:20,218 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 01:01:20,218 - INFO - Leader election completed in 0.18 seconds, success: False
2025-04-27 01:01:20,224 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-27 01:01:20,895 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:01:20,958 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:21,001 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:21,435 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:01:21,445 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:01:23,013 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:01:23,037 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:23,058 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:23,471 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:01:23,475 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:01:25,061 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:01:25,081 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:25,110 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:25,491 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:01:25,499 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:01:27,119 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:01:27,164 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:27,241 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:27,569 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:01:27,592 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:01:29,258 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:01:29,306 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:29,375 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:29,614 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:01:29,657 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:01:31,384 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:01:31,411 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:31,448 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:31,708 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:01:31,716 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:01:33,453 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:01:33,532 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:33,584 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:33,750 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:01:33,755 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:01:35,224 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-27 01:01:35,225 - INFO - Attempting broker recovery for kafka1
2025-04-27 01:01:35,226 - INFO - Attempting internal recovery for broker 1
2025-04-27 01:01:35,226 - INFO - Triggering internal recovery for broker 1
2025-04-27 01:01:35,248 - INFO - Found 1 partitions on broker 1
2025-04-27 01:01:35,250 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-27 01:01:35,250 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 01:01:35,251 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-27 01:01:35,260 - INFO - Successfully triggered internal recovery for broker 1
2025-04-27 01:01:35,307 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:35,492 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-27 01:01:35,493 - INFO - Recovery successful for broker kafka1:9092
2025-04-27 01:01:35,493 - INFO - Recovery thread for kafka1:9092 completed
2025-04-27 01:01:35,587 - INFO - Skipping recovery for kafka1:9092, last attempt 16.9s ago
2025-04-27 01:01:35,607 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:35,633 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:35,773 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:01:35,784 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:01:37,831 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:01:37,892 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:01:39,929 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:01:40,032 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:01:40,641 - INFO - Skipping recovery for kafka1:9092, last attempt 22.0s ago
2025-04-27 01:01:40,731 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:40,847 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:42,137 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:01:42,248 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:01:44,289 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:01:44,295 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:01:45,865 - INFO - Skipping recovery for kafka1:9092, last attempt 27.2s ago
2025-04-27 01:01:45,891 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:45,959 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:46,315 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:01:46,323 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:01:48,338 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:01:48,345 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:01:50,386 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:01:50,391 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:01:50,983 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:51,044 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:51,074 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:52,417 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:01:52,423 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:01:54,433 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:01:54,435 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:01:56,116 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:56,146 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:56,182 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:01:56,483 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:01:56,518 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:01:58,531 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-27 01:01:58,536 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:02:00,583 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:02:00,587 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:02:01,219 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:02:01,241 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:02:01,262 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:02:02,636 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:02:02,642 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:02:04,652 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:02:04,654 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:02:06,291 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:02:06,313 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:02:06,349 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:02:06,703 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:02:06,715 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:02:08,758 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:02:08,766 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:02:10,948 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:02:10,966 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:02:11,498 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:02:11,619 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:02:11,706 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:02:13,086 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:02:13,118 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:02:15,219 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:02:15,352 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:02:17,452 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:02:17,507 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:02:17,816 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:02:17,917 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:02:18,046 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:02:20,024 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:02:20,102 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:02:22,175 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:02:22,196 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:02:23,055 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-27 01:02:23,056 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-27 01:02:23,059 - INFO - Starting recovery thread for kafka1:9092
2025-04-27 01:02:23,060 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-27 01:02:23,060 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: RESOURCE_OPTIMIZED
2025-04-27 01:02:23,149 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:02:23,151 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:02:23,190 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:02:23,192 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:02:23,219 - INFO - Using default Kafka recovery configuration
2025-04-27 01:02:23,249 - INFO - Found broker IDs: [2, 3, 1]
2025-04-27 01:02:23,250 - INFO - No non-None configuration values to apply
2025-04-27 01:02:23,252 - INFO - Triggering leader election
2025-04-27 01:02:23,260 - INFO - Listing topics for leader election
2025-04-27 01:02:23,273 - INFO - Found 1 topics for leader election
2025-04-27 01:02:23,273 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 01:02:23,277 - INFO - Leader election completed in 0.01 seconds, success: False
2025-04-27 01:02:23,283 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-27 01:02:24,241 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:02:24,265 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:02:25,201 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:02:25,250 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:02:25,276 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:02:26,304 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:02:26,312 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:02:27,283 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:02:27,304 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:02:27,362 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:02:28,450 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:02:28,471 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:02:29,372 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:02:29,566 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:02:29,760 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:02:30,655 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:02:30,739 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:02:31,799 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:02:31,890 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:02:32,007 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:02:32,787 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:02:32,825 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:02:34,018 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:02:34,063 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:02:34,141 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:02:34,893 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:02:34,905 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:02:36,149 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:02:36,290 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:02:36,371 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:02:36,961 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:02:37,026 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:02:38,285 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-27 01:02:38,286 - INFO - Attempting broker recovery for kafka1
2025-04-27 01:02:38,286 - INFO - Attempting internal recovery for broker 1
2025-04-27 01:02:38,286 - INFO - Triggering internal recovery for broker 1
2025-04-27 01:02:38,316 - INFO - Found 1 partitions on broker 1
2025-04-27 01:02:38,316 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-27 01:02:38,316 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 01:02:38,317 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-27 01:02:38,323 - INFO - Successfully triggered internal recovery for broker 1
2025-04-27 01:02:38,419 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:02:38,603 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:02:38,634 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:02:38,751 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:02:39,141 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:02:39,147 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:02:40,028 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-27 01:02:40,029 - INFO - Recovery successful for broker kafka1:9092
2025-04-27 01:02:40,029 - INFO - Recovery thread for kafka1:9092 completed
2025-04-27 01:02:40,803 - INFO - Skipping recovery for kafka1:9092, last attempt 17.7s ago
2025-04-27 01:02:40,925 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:02:40,977 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:02:41,189 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:02:41,229 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:02:43,278 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:02:43,294 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:02:45,397 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:02:45,441 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:02:46,010 - INFO - Skipping recovery for kafka1:9092, last attempt 23.0s ago
2025-04-27 01:02:46,430 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:02:46,871 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:02:47,630 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:02:47,679 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:02:49,812 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:02:49,884 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:02:51,963 - INFO - Skipping recovery for kafka1:9092, last attempt 28.9s ago
2025-04-27 01:02:52,179 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:02:52,221 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:02:52,424 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:02:52,594 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:02:54,303 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:02:54,320 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:02:56,433 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:02:56,516 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:02:57,660 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:02:57,832 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:02:58,678 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:02:58,724 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:02:59,284 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:00,837 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:03:00,858 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:03:02,924 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:03:02,942 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:03:04,325 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:04,395 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:04,427 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:04,981 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:03:05,018 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:03:07,092 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:03:07,160 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:03:09,196 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:03:09,265 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:03:09,476 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:09,612 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:09,705 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:11,297 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:03:11,308 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:03:13,320 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:03:13,324 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:03:14,753 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:14,785 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:14,869 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:15,406 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:03:15,412 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:03:17,791 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:03:17,868 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:03:19,911 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:03:19,959 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:03:20,003 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:20,043 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:20,140 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:22,014 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:03:22,062 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:03:24,079 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:03:24,081 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:03:25,152 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-27 01:03:25,154 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-27 01:03:25,159 - INFO - Starting recovery thread for kafka1:9092
2025-04-27 01:03:25,160 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-27 01:03:25,160 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: RESOURCE_OPTIMIZED
2025-04-27 01:03:25,240 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:25,229 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:25,276 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:25,285 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:25,289 - INFO - Using default Kafka recovery configuration
2025-04-27 01:03:25,308 - INFO - Found broker IDs: [2, 3, 1]
2025-04-27 01:03:25,308 - INFO - No non-None configuration values to apply
2025-04-27 01:03:25,313 - INFO - Triggering leader election
2025-04-27 01:03:25,314 - INFO - Listing topics for leader election
2025-04-27 01:03:25,338 - INFO - Found 1 topics for leader election
2025-04-27 01:03:25,339 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 01:03:25,340 - INFO - Leader election completed in 0.03 seconds, success: False
2025-04-27 01:03:25,344 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-27 01:03:26,115 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:03:26,121 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:03:27,281 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:03:27,310 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:27,358 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:28,194 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:03:28,217 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:03:29,364 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:03:29,390 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:29,440 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:30,235 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:03:30,242 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:03:31,455 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:03:31,474 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:31,504 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:32,273 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:03:32,278 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:03:33,508 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:03:33,538 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:33,573 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:34,341 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:03:34,366 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:03:35,577 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:03:35,599 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:35,628 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:36,389 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:03:36,394 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:03:37,635 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:03:37,653 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:37,700 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:38,432 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:03:38,442 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:03:39,714 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:03:39,813 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:39,850 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:40,346 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-27 01:03:40,346 - INFO - Attempting broker recovery for kafka1
2025-04-27 01:03:40,347 - INFO - Attempting internal recovery for broker 1
2025-04-27 01:03:40,347 - INFO - Triggering internal recovery for broker 1
2025-04-27 01:03:40,364 - INFO - Found 1 partitions on broker 1
2025-04-27 01:03:40,364 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-27 01:03:40,365 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 01:03:40,365 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-27 01:03:40,371 - INFO - Successfully triggered internal recovery for broker 1
2025-04-27 01:03:40,480 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:40,508 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:03:40,560 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:03:40,678 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-27 01:03:40,679 - INFO - Recovery successful for broker kafka1:9092
2025-04-27 01:03:40,682 - INFO - Recovery thread for kafka1:9092 completed
2025-04-27 01:03:41,853 - INFO - Skipping recovery for kafka1:9092, last attempt 16.7s ago
2025-04-27 01:03:41,935 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:41,970 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:42,607 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:03:42,615 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:03:44,634 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:03:44,640 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:03:46,786 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:03:46,843 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:03:46,985 - INFO - Skipping recovery for kafka1:9092, last attempt 21.8s ago
2025-04-27 01:03:47,026 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:47,090 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:48,872 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:03:48,882 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:03:50,894 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:03:50,897 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:03:52,143 - INFO - Skipping recovery for kafka1:9092, last attempt 27.0s ago
2025-04-27 01:03:52,222 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:52,284 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:52,979 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:03:52,987 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:03:55,035 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:03:55,047 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:03:57,092 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:03:57,177 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:03:57,317 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:57,408 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:57,488 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:03:59,266 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:03:59,337 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:04:01,371 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:04:01,377 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:04:02,523 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:02,585 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:02,619 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:03,395 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:04:03,399 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:04:05,428 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:04:05,432 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:04:07,496 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:04:07,513 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:04:07,648 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:07,745 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:07,791 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:09,573 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:04:09,587 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:04:11,670 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:04:11,676 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:04:12,823 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:12,856 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:12,894 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:13,693 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:04:13,716 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:04:15,729 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:04:15,733 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:04:17,850 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:04:17,872 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:04:17,951 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:18,042 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:18,123 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:19,929 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:04:19,934 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:04:21,947 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:04:21,951 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:04:23,158 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:23,255 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:23,311 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:23,989 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:04:23,997 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:04:26,149 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:04:26,184 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:04:28,253 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:04:28,293 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-27 01:04:28,297 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-27 01:04:28,298 - INFO - Starting recovery thread for kafka1:9092
2025-04-27 01:04:28,299 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-27 01:04:28,313 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:04:28,323 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: RESOURCE_OPTIMIZED
2025-04-27 01:04:28,375 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:28,376 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:28,568 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:28,568 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:28,586 - INFO - Using default Kafka recovery configuration
2025-04-27 01:04:28,596 - INFO - Found broker IDs: [2, 3, 1]
2025-04-27 01:04:28,596 - INFO - No non-None configuration values to apply
2025-04-27 01:04:28,608 - INFO - Triggering leader election
2025-04-27 01:04:28,612 - INFO - Listing topics for leader election
2025-04-27 01:04:28,648 - INFO - Found 1 topics for leader election
2025-04-27 01:04:28,649 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 01:04:28,650 - INFO - Leader election completed in 0.04 seconds, success: False
2025-04-27 01:04:28,666 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-27 01:04:30,435 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:04:30,446 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:04:30,592 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:04:30,722 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:30,774 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:32,482 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:04:32,487 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:04:32,781 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:04:32,839 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:32,877 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:34,516 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:04:34,521 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:04:34,882 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:04:34,893 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:34,903 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:36,530 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:04:36,536 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:04:36,913 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:04:36,996 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:37,173 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:38,625 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:04:38,637 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:04:39,186 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:04:39,308 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:39,344 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:40,694 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:04:40,701 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:04:41,353 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:04:41,369 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:41,443 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:42,729 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:04:42,735 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:04:43,452 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:04:43,504 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:43,583 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:43,674 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-27 01:04:43,675 - INFO - Attempting broker recovery for kafka1
2025-04-27 01:04:43,675 - INFO - Attempting internal recovery for broker 1
2025-04-27 01:04:43,675 - INFO - Triggering internal recovery for broker 1
2025-04-27 01:04:43,689 - INFO - Found 1 partitions on broker 1
2025-04-27 01:04:43,690 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-27 01:04:43,690 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 01:04:43,690 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-27 01:04:43,694 - INFO - Successfully triggered internal recovery for broker 1
2025-04-27 01:04:43,790 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:43,916 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-27 01:04:43,917 - INFO - Recovery successful for broker kafka1:9092
2025-04-27 01:04:43,917 - INFO - Recovery thread for kafka1:9092 completed
2025-04-27 01:04:44,777 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:04:44,790 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:04:45,589 - INFO - Skipping recovery for kafka1:9092, last attempt 17.3s ago
2025-04-27 01:04:45,623 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:45,707 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:46,829 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:04:46,835 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:04:48,910 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:04:48,920 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:04:50,713 - INFO - Skipping recovery for kafka1:9092, last attempt 22.4s ago
2025-04-27 01:04:50,749 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:50,798 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:50,946 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:04:50,949 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:04:52,971 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:04:52,974 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:04:55,022 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:04:55,028 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:04:55,829 - INFO - Skipping recovery for kafka1:9092, last attempt 27.5s ago
2025-04-27 01:04:55,899 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:56,021 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:04:57,157 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:04:57,168 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:04:59,219 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:04:59,230 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:05:01,091 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:01,158 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:01,187 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:01,299 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:05:01,310 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:05:03,351 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:05:03,357 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:05:05,399 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:05:05,405 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:05:06,266 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:06,339 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:06,448 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:07,450 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:05:07,488 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:05:09,538 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:05:09,605 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:05:11,539 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:11,649 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:11,696 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:05:11,767 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:05:11,802 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:13,812 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:05:13,855 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:05:15,926 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:05:15,934 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:05:16,865 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:16,955 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:17,066 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:18,037 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:05:18,091 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:05:20,116 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:05:20,120 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:05:22,116 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:22,142 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:22,148 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:05:22,160 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:05:22,176 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:24,166 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:05:24,168 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:05:26,244 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:05:26,253 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:05:27,384 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:27,571 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:27,699 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:28,421 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:05:28,467 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:05:30,503 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:05:30,513 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:05:32,544 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:05:32,564 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:05:32,710 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-27 01:05:32,714 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-27 01:05:32,717 - INFO - Starting recovery thread for kafka1:9092
2025-04-27 01:05:32,719 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-27 01:05:32,719 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: RESOURCE_OPTIMIZED
2025-04-27 01:05:33,138 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:33,142 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:33,286 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:33,288 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:33,307 - INFO - Using default Kafka recovery configuration
2025-04-27 01:05:33,330 - INFO - Found broker IDs: [2, 3, 1]
2025-04-27 01:05:33,331 - INFO - No non-None configuration values to apply
2025-04-27 01:05:33,336 - INFO - Triggering leader election
2025-04-27 01:05:33,356 - INFO - Listing topics for leader election
2025-04-27 01:05:33,386 - INFO - Found 1 topics for leader election
2025-04-27 01:05:33,389 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 01:05:33,390 - INFO - Leader election completed in 0.04 seconds, success: False
2025-04-27 01:05:33,396 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-27 01:05:34,593 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:05:34,597 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:05:35,310 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:05:35,333 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:35,350 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:36,635 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:05:36,660 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:05:37,355 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:05:37,367 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:37,425 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:38,692 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:05:38,699 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:05:39,430 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:05:39,466 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:39,487 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:40,729 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:05:40,733 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:05:41,492 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:05:41,502 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:41,515 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:42,751 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:05:42,754 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:05:43,517 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:05:43,607 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:43,731 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:44,775 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:05:44,779 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:05:45,737 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:05:45,759 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:45,782 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:46,842 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:05:46,874 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:05:47,788 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:05:48,080 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:48,350 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:48,406 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-27 01:05:48,408 - INFO - Attempting broker recovery for kafka1
2025-04-27 01:05:48,410 - INFO - Attempting internal recovery for broker 1
2025-04-27 01:05:48,412 - INFO - Triggering internal recovery for broker 1
2025-04-27 01:05:48,454 - INFO - Found 1 partitions on broker 1
2025-04-27 01:05:48,455 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-27 01:05:48,455 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 01:05:48,455 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-27 01:05:48,464 - INFO - Successfully triggered internal recovery for broker 1
2025-04-27 01:05:48,538 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:48,647 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-27 01:05:48,648 - INFO - Recovery successful for broker kafka1:9092
2025-04-27 01:05:48,648 - INFO - Recovery thread for kafka1:9092 completed
2025-04-27 01:05:48,902 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:05:48,924 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:05:50,368 - INFO - Skipping recovery for kafka1:9092, last attempt 17.7s ago
2025-04-27 01:05:50,523 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:50,650 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:51,032 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:05:51,037 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:05:53,050 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:05:53,052 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:05:55,080 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:05:55,083 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:05:55,748 - INFO - Skipping recovery for kafka1:9092, last attempt 23.0s ago
2025-04-27 01:05:55,808 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:55,901 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:05:57,219 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:05:57,330 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:05:59,406 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:05:59,415 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:06:01,478 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:06:01,490 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:06:01,949 - INFO - Skipping recovery for kafka1:9092, last attempt 29.2s ago
2025-04-27 01:06:02,010 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:02,075 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:03,510 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:06:03,532 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:06:05,554 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:06:05,560 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:06:07,122 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:07,202 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:07,257 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:07,594 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:06:07,603 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:06:09,643 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:06:09,648 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:06:11,723 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:06:11,735 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:06:12,290 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:12,327 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:12,362 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:13,758 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:06:13,761 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:06:15,773 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:06:15,777 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:06:17,455 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:17,542 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:17,613 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:17,834 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:06:17,872 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:06:19,909 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:06:19,915 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:06:21,998 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:06:22,015 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:06:22,663 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:22,702 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:22,766 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:24,038 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:06:24,041 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:06:26,047 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:06:26,050 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:06:27,806 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:27,936 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:28,024 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:28,167 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:06:28,184 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:06:30,228 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:06:30,234 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:06:32,433 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:06:32,638 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:06:33,040 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-27 01:06:33,041 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-27 01:06:33,045 - INFO - Starting recovery thread for kafka1:9092
2025-04-27 01:06:33,046 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-27 01:06:33,046 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: RESOURCE_OPTIMIZED
2025-04-27 01:06:33,113 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:33,114 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:33,155 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:33,182 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:33,182 - INFO - Using default Kafka recovery configuration
2025-04-27 01:06:33,200 - INFO - Found broker IDs: [2, 3, 1]
2025-04-27 01:06:33,201 - INFO - No non-None configuration values to apply
2025-04-27 01:06:33,212 - INFO - Triggering leader election
2025-04-27 01:06:33,213 - INFO - Listing topics for leader election
2025-04-27 01:06:33,241 - INFO - Found 1 topics for leader election
2025-04-27 01:06:33,242 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 01:06:33,242 - INFO - Leader election completed in 0.03 seconds, success: False
2025-04-27 01:06:33,245 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-27 01:06:34,694 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:06:34,718 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:06:35,191 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:06:35,235 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:35,279 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:36,785 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:06:36,878 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:06:38,299 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:06:38,367 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:38,460 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:38,895 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:06:38,918 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:06:40,467 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:06:40,481 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:40,526 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:40,955 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:06:40,966 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:06:42,540 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:06:42,590 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:42,623 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:42,986 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:06:43,006 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:06:44,627 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:06:44,654 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:44,685 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:45,127 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:06:45,140 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:06:46,711 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:06:46,829 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:46,974 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:47,213 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:06:47,267 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:06:48,253 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-27 01:06:48,254 - INFO - Attempting broker recovery for kafka1
2025-04-27 01:06:48,255 - INFO - Attempting internal recovery for broker 1
2025-04-27 01:06:48,255 - INFO - Triggering internal recovery for broker 1
2025-04-27 01:06:48,273 - INFO - Found 1 partitions on broker 1
2025-04-27 01:06:48,274 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-27 01:06:48,274 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 01:06:48,274 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-27 01:06:48,282 - INFO - Successfully triggered internal recovery for broker 1
2025-04-27 01:06:48,342 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:48,459 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-27 01:06:48,459 - INFO - Recovery successful for broker kafka1:9092
2025-04-27 01:06:48,460 - INFO - Recovery thread for kafka1:9092 completed
2025-04-27 01:06:48,994 - INFO - Skipping recovery for kafka1:9092, last attempt 16.0s ago
2025-04-27 01:06:49,066 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:49,101 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:49,359 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:06:49,384 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:06:51,447 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:06:51,456 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:06:53,486 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:06:53,492 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:06:54,108 - INFO - Skipping recovery for kafka1:9092, last attempt 21.1s ago
2025-04-27 01:06:54,152 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:54,217 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:55,507 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:06:55,511 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:06:57,585 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:06:57,595 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:06:59,227 - INFO - Skipping recovery for kafka1:9092, last attempt 26.2s ago
2025-04-27 01:06:59,350 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:59,394 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:06:59,662 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:06:59,669 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:07:01,778 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:07:01,787 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:07:03,816 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:07:03,848 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:07:04,431 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:04,459 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:04,537 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:05,881 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:07:05,885 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:07:07,906 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:07:07,916 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:07:09,569 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:09,654 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:09,687 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:09,952 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:07:09,957 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:07:11,980 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:07:11,985 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:07:14,015 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:07:14,031 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:07:14,721 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:14,755 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:14,832 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:16,108 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:07:16,133 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:07:18,190 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:07:18,197 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:07:19,902 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:19,941 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:20,012 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:20,243 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:07:20,249 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:07:22,338 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:07:22,388 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:07:24,469 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:07:24,477 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:07:25,055 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:25,086 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:25,119 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:26,501 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:07:26,534 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:07:28,552 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:07:28,556 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:07:30,150 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:30,242 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:30,326 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:30,579 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:07:30,583 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:07:32,637 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:07:32,641 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:07:34,660 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:07:34,664 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:07:35,332 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-27 01:07:35,333 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-27 01:07:35,334 - INFO - Starting recovery thread for kafka1:9092
2025-04-27 01:07:35,335 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-27 01:07:35,341 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: RESOURCE_OPTIMIZED
2025-04-27 01:07:35,398 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:35,399 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:35,443 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:35,444 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:35,448 - INFO - Using default Kafka recovery configuration
2025-04-27 01:07:35,456 - INFO - Found broker IDs: [2, 3, 1]
2025-04-27 01:07:35,457 - INFO - No non-None configuration values to apply
2025-04-27 01:07:35,460 - INFO - Triggering leader election
2025-04-27 01:07:35,463 - INFO - Listing topics for leader election
2025-04-27 01:07:35,469 - INFO - Found 1 topics for leader election
2025-04-27 01:07:35,471 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 01:07:35,471 - INFO - Leader election completed in 0.01 seconds, success: False
2025-04-27 01:07:35,482 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-27 01:07:36,742 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:07:36,777 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:07:37,456 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:07:37,625 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:37,773 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:38,892 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:07:38,935 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:07:39,802 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:07:39,927 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:39,989 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:40,980 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:07:41,029 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:07:42,002 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:07:42,040 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:42,150 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:43,051 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:07:43,054 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:07:44,159 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:07:44,189 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:44,274 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:45,082 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:07:45,096 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:07:46,289 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:07:46,362 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:46,462 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:47,157 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:07:47,222 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:07:48,470 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:07:48,624 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:48,723 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:49,261 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:07:49,288 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:07:50,508 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-27 01:07:50,527 - INFO - Attempting broker recovery for kafka1
2025-04-27 01:07:50,528 - INFO - Attempting internal recovery for broker 1
2025-04-27 01:07:50,529 - INFO - Triggering internal recovery for broker 1
2025-04-27 01:07:50,734 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:07:50,741 - INFO - Found 1 partitions on broker 1
2025-04-27 01:07:50,742 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-27 01:07:50,742 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 01:07:50,745 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-27 01:07:50,770 - INFO - Successfully triggered internal recovery for broker 1
2025-04-27 01:07:50,785 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:50,843 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:50,875 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:51,114 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-27 01:07:51,115 - INFO - Recovery successful for broker kafka1:9092
2025-04-27 01:07:51,115 - INFO - Recovery thread for kafka1:9092 completed
2025-04-27 01:07:51,321 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:07:51,351 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:07:52,848 - INFO - Skipping recovery for kafka1:9092, last attempt 17.5s ago
2025-04-27 01:07:52,884 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:52,912 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:53,379 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:07:53,389 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:07:55,405 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:07:55,419 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:07:57,494 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:07:57,551 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:07:57,919 - INFO - Skipping recovery for kafka1:9092, last attempt 22.6s ago
2025-04-27 01:07:57,987 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:58,081 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:07:59,576 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:07:59,604 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:08:01,630 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:08:01,634 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:08:03,134 - INFO - Skipping recovery for kafka1:9092, last attempt 27.8s ago
2025-04-27 01:08:03,217 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:03,256 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:03,644 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:08:03,649 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:08:05,691 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:08:05,699 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:08:07,744 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:08:07,754 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:08:08,363 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:08,437 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:08,496 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:09,781 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:08:09,794 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:08:11,821 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:08:11,825 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:08:13,530 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:13,557 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:13,627 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:13,836 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:08:13,838 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:08:15,876 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:08:15,882 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:08:17,957 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:08:17,966 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:08:18,720 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:18,831 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:18,897 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:20,009 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:08:20,018 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:08:22,059 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:08:22,064 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:08:23,923 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:23,955 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:23,990 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:24,079 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:08:24,084 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:08:26,118 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:08:26,137 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:08:28,249 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:08:28,264 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:08:29,021 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:29,061 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:29,152 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:30,356 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:08:30,480 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:08:32,529 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:08:32,549 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:08:34,189 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:34,248 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:34,318 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:34,570 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:08:34,574 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:08:36,587 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:08:36,591 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:08:38,628 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:08:38,633 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:08:39,326 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-27 01:08:39,327 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-27 01:08:39,329 - INFO - Starting recovery thread for kafka1:9092
2025-04-27 01:08:39,329 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-27 01:08:39,330 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: RESOURCE_OPTIMIZED
2025-04-27 01:08:39,397 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:39,400 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:39,442 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:39,445 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:39,452 - INFO - Using default Kafka recovery configuration
2025-04-27 01:08:39,469 - INFO - Found broker IDs: [2, 3, 1]
2025-04-27 01:08:39,469 - INFO - No non-None configuration values to apply
2025-04-27 01:08:39,474 - INFO - Triggering leader election
2025-04-27 01:08:39,476 - INFO - Listing topics for leader election
2025-04-27 01:08:39,529 - INFO - Found 1 topics for leader election
2025-04-27 01:08:39,530 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 01:08:39,530 - INFO - Leader election completed in 0.05 seconds, success: False
2025-04-27 01:08:39,536 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-27 01:08:40,660 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:08:40,664 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:08:41,455 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:08:41,525 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:41,594 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:42,713 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:08:42,721 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:08:43,602 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:08:43,633 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:43,664 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:44,732 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:08:44,735 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:08:45,667 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:08:45,691 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:45,709 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:46,809 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:08:46,833 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:08:47,717 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:08:47,869 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:47,949 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:48,874 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:08:48,890 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:08:49,970 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:08:50,188 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:50,256 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:50,933 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:08:50,938 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:08:52,263 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:08:52,331 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:52,467 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:52,984 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:08:52,988 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:08:54,480 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-27 01:08:54,542 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:54,551 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-27 01:08:54,555 - INFO - Attempting broker recovery for kafka1
2025-04-27 01:08:54,556 - INFO - Attempting internal recovery for broker 1
2025-04-27 01:08:54,556 - INFO - Triggering internal recovery for broker 1
2025-04-27 01:08:54,726 - INFO - Found 1 partitions on broker 1
2025-04-27 01:08:54,728 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-27 01:08:54,729 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-27 01:08:54,730 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-27 01:08:54,742 - INFO - Successfully triggered internal recovery for broker 1
2025-04-27 01:08:54,793 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:54,920 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:55,047 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:08:55,055 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:08:55,206 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-27 01:08:55,206 - INFO - Recovery successful for broker kafka1:9092
2025-04-27 01:08:55,206 - INFO - Recovery thread for kafka1:9092 completed
2025-04-27 01:08:56,788 - INFO - Skipping recovery for kafka1:9092, last attempt 17.5s ago
2025-04-27 01:08:57,031 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:57,079 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:08:57,083 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:08:57,091 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:08:59,241 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:08:59,290 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:09:01,389 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:09:01,482 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:09:02,097 - INFO - Skipping recovery for kafka1:9092, last attempt 22.8s ago
2025-04-27 01:09:02,170 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:09:02,215 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:09:03,544 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:09:03,553 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:09:05,570 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:09:05,574 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:09:07,226 - INFO - Skipping recovery for kafka1:9092, last attempt 27.9s ago
2025-04-27 01:09:07,307 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:09:07,393 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:09:07,606 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:09:07,616 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:09:09,694 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:09:09,700 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:09:11,751 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:09:11,788 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:09:13,443 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:09:13,560 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:09:13,655 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:09:13,815 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:09:13,819 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:09:15,850 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:09:15,857 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:09:17,933 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:09:17,980 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:09:18,731 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:09:18,817 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:09:18,939 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:09:20,095 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:09:20,105 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:09:22,157 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:09:22,177 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:09:23,970 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:09:24,056 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:09:24,119 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:09:24,217 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:09:24,221 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:09:26,249 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:09:26,256 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:09:28,591 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:09:28,656 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:09:29,684 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:09:29,812 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:09:30,436 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:09:30,883 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:09:30,928 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:09:33,950 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:09:34,053 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:09:35,957 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-27 01:09:37,133 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:09:37,152 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:09:37,282 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:09:38,189 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:09:39,604 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:09:39,704 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:09:43,324 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-27 01:09:43,395 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-27 01:09:43,441 - INFO - Starting recovery thread for kafka1:9092
2025-04-27 01:09:43,447 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-27 01:09:43,449 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: RESOURCE_OPTIMIZED
2025-04-27 01:09:45,185 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-27 01:09:45,273 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-27 01:09:45,443 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:09:45,458 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-27 01:09:46,523 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:09:46,719 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-27 01:09:46,796 - INFO - Using default Kafka recovery configuration
2025-04-27 01:09:47,026 - INFO - Found broker IDs: [2, 3, 1]
2025-04-27 01:09:47,027 - INFO - No non-None configuration values to apply
