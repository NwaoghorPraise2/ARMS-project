2025-05-06 09:19:45,028 - INFO - PRIMARY KAFKA BROKERS (for monitoring): ['kafka1:9092', 'kafka2:9093', 'kafka3:9094']
2025-05-06 09:19:45,028 - INFO - Container names: ['kafka1', 'kafka2', 'kafka3']
2025-05-06 09:19:45,028 - INFO - Alternative addresses (for connection attempts ONLY): ['kafka1:29092', 'kafka2:29093', 'kafka3:29094']
2025-05-06 09:19:45,029 - INFO - Starting Kafka Arms Controller
2025-05-06 09:19:45,042 - INFO - Started Prometheus metrics server on port 8002
2025-05-06 09:19:45,056 - INFO - Loaded strategy buffer: QUICK_REBALANCE
2025-05-06 09:19:45,105 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:19:45,115 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:19:47,163 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:19:47,181 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:19:49,046 - INFO - Monitoring these brokers ONLY: ['kafka1:9092', 'kafka2:9093', 'kafka3:9094']
2025-05-06 09:19:49,047 - INFO - TEST MODE ENABLED - Will simulate failures for kafka1:9092 every 120 seconds
2025-05-06 09:19:49,047 - INFO - Test mode initialized, broker kafka1:9092 will be tested on next check
2025-05-06 09:19:49,047 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 09:19:49,048 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 09:19:49,054 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 09:19:49,055 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 09:19:49,055 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: CONTROLLED_GRADUAL, mode: buffer
2025-05-06 09:19:49,205 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:19:49,212 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:19:51,242 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:19:51,249 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:19:53,278 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:19:53,290 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:19:55,389 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:19:55,419 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:19:57,449 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:19:57,459 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:19:57,739 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:19:57,744 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:19:58,110 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:19:58,113 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:19:58,116 - INFO - Using strategy buffer configuration
2025-05-06 09:19:58,153 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 09:19:58,303 - INFO - Successfully applied config to broker 2
2025-05-06 09:19:58,718 - INFO - Successfully applied config to broker 3
2025-05-06 09:19:59,126 - INFO - Successfully applied config to broker 1
2025-05-06 09:19:59,127 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 09:19:59,132 - INFO - Triggering leader election
2025-05-06 09:19:59,137 - INFO - Listing topics for leader election
2025-05-06 09:19:59,184 - INFO - Found 1 topics for leader election
2025-05-06 09:19:59,185 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 09:19:59,187 - INFO - Leader election completed in 0.05 seconds, success: False
2025-05-06 09:19:59,210 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 09:19:59,497 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:19:59,528 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:20:00,119 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:20:00,168 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:00,193 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:01,548 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:20:01,561 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:20:02,198 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:20:02,231 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:02,263 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:03,576 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:20:03,580 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:20:04,269 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:20:04,282 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:04,293 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:05,606 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:20:05,614 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:20:06,299 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:20:06,314 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:06,347 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:07,656 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:20:07,673 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:20:08,362 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:20:08,381 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:08,402 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:09,696 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:20:09,720 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:20:10,407 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:20:10,429 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:10,444 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:11,741 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:20:11,746 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:20:12,452 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:20:12,477 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:12,496 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:13,762 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:20:13,764 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:20:14,217 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 09:20:14,218 - INFO - Attempting broker recovery for kafka1
2025-05-06 09:20:14,218 - INFO - Attempting internal recovery for broker 1
2025-05-06 09:20:14,218 - INFO - Triggering internal recovery for broker 1
2025-05-06 09:20:14,233 - INFO - Found 1 partitions on broker 1
2025-05-06 09:20:14,233 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 09:20:14,233 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 09:20:14,233 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 09:20:14,234 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 09:20:14,256 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:14,295 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 09:20:14,295 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 09:20:14,295 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 09:20:14,501 - INFO - Skipping recovery for kafka1:9092, last attempt 25.5s ago
2025-05-06 09:20:14,511 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:14,534 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:15,770 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:20:15,774 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:20:17,800 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:20:17,809 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:20:19,562 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:19,574 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:19,601 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:19,821 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:20:19,828 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:20:21,839 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:20:21,843 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:20:23,854 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:20:23,856 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:20:24,633 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:24,647 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:24,656 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:25,865 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:20:25,868 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:20:27,879 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:20:27,883 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:20:29,677 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:29,689 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:29,704 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:29,893 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:20:29,895 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:20:31,900 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:20:31,903 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:20:33,917 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:20:33,921 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:20:34,730 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:34,744 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:34,835 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:35,944 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:20:35,948 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:20:37,957 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:20:37,962 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:20:39,853 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:39,863 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:39,893 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:39,985 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:20:39,988 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:20:41,999 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:20:42,002 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:20:44,021 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:20:44,026 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:20:44,931 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:45,006 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:45,032 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:46,038 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:20:46,042 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:20:48,072 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:20:48,080 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:20:50,054 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:50,064 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:50,077 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:50,097 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:20:50,102 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:20:52,109 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:20:52,111 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:20:54,127 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:20:54,131 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:20:55,089 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:55,104 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:55,115 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:20:56,141 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:20:56,144 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:20:58,155 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:20:58,160 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:21:00,147 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:00,177 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:00,196 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:21:00,203 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:21:00,203 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:02,216 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:21:02,219 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:21:04,237 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:21:04,240 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:21:05,248 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:05,268 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:05,295 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:06,249 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:21:06,254 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:21:08,283 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:21:08,288 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:21:10,317 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:21:10,329 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:10,333 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:21:10,371 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:10,382 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:12,346 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:21:12,352 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:21:14,365 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:21:14,370 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:21:15,402 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:15,418 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:15,438 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:16,376 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:21:16,380 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:21:18,404 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:21:18,409 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:21:20,418 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:21:20,421 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:21:20,472 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:20,485 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:20,499 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:22,433 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:21:22,436 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:21:24,442 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:21:24,444 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:21:25,519 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:25,541 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:25,558 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:26,465 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:21:26,469 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:21:28,477 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:21:28,479 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:21:30,496 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:21:30,498 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:21:30,586 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:30,611 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:30,626 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:32,514 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:21:32,519 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:21:34,534 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:21:34,539 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:21:35,654 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:35,673 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:35,686 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:36,549 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:21:36,552 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:21:38,571 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:21:38,573 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:21:40,580 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:21:40,584 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:21:40,712 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:40,724 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:40,733 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:42,596 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:21:42,599 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:21:44,607 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:21:44,610 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:21:45,756 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:45,783 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:45,873 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:46,629 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:21:46,632 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:21:48,667 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:21:48,686 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:21:50,723 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:21:50,732 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:21:50,876 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 09:21:50,877 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 09:21:50,879 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 09:21:50,882 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 09:21:50,882 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE, mode: buffer
2025-05-06 09:21:50,911 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:50,911 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:50,929 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:50,929 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:50,932 - INFO - Using strategy buffer configuration
2025-05-06 09:21:50,938 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 09:21:51,013 - INFO - Successfully applied config to broker 2
2025-05-06 09:21:51,125 - INFO - Successfully applied config to broker 3
2025-05-06 09:21:51,250 - INFO - Successfully applied config to broker 1
2025-05-06 09:21:51,250 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 09:21:51,259 - INFO - Triggering leader election
2025-05-06 09:21:51,262 - INFO - Listing topics for leader election
2025-05-06 09:21:51,387 - INFO - Found 1 topics for leader election
2025-05-06 09:21:51,387 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 09:21:51,387 - INFO - Leader election completed in 0.13 seconds, success: False
2025-05-06 09:21:51,398 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 09:21:52,767 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:21:52,779 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:21:52,934 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:21:52,954 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:52,973 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:54,793 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:21:54,796 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:21:54,976 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:21:54,983 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:54,993 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:56,802 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:21:56,805 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:21:56,997 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:21:57,019 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:57,040 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:58,833 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:21:58,839 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:21:59,045 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:21:59,058 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:21:59,067 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:22:00,870 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:22:00,873 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:22:01,073 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:22:01,102 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:22:01,119 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:22:02,887 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:22:02,890 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:22:03,122 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:22:03,127 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:22:03,132 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:22:04,908 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:22:04,911 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:22:05,135 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:22:05,147 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:22:05,167 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:22:06,408 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 09:22:06,408 - INFO - Attempting broker recovery for kafka1
2025-05-06 09:22:06,408 - INFO - Attempting internal recovery for broker 1
2025-05-06 09:22:06,409 - INFO - Triggering internal recovery for broker 1
2025-05-06 09:22:06,415 - INFO - Found 1 partitions on broker 1
2025-05-06 09:22:06,415 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 09:22:06,415 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 09:22:06,415 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 09:22:06,417 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 09:22:06,434 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:22:06,456 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 09:22:06,456 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 09:22:06,456 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 09:22:06,919 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:22:06,922 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:22:07,175 - INFO - Skipping recovery for kafka1:9092, last attempt 16.3s ago
2025-05-06 09:22:07,183 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:22:07,191 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:22:08,953 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:22:08,957 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:22:10,976 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:22:10,980 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:22:12,196 - INFO - Skipping recovery for kafka1:9092, last attempt 21.3s ago
2025-05-06 09:22:12,216 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:22:12,246 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:22:12,996 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:22:13,083 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:22:15,107 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:22:15,117 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:22:17,124 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:22:17,127 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:22:17,252 - INFO - Skipping recovery for kafka1:9092, last attempt 26.4s ago
2025-05-06 09:22:17,280 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:22:17,395 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:22:19,197 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:22:19,216 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:22:21,233 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:22:21,242 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:22:22,433 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:22:22,457 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:22:22,469 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:22:23,254 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:22:23,257 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:22:25,280 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:22:25,286 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:22:27,297 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:22:27,301 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:22:27,488 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:22:27,512 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:22:27,528 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:22:29,324 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:22:29,341 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:22:31,357 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:22:31,361 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:22:32,563 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:22:32,592 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:22:32,613 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:22:33,369 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:22:33,371 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:22:35,386 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:22:35,390 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:22:37,400 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:22:37,404 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:22:37,642 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:22:37,676 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:22:37,699 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:22:39,437 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:22:39,441 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:22:41,474 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:22:41,502 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:22:42,733 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:22:42,762 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:22:42,777 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:22:43,511 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:22:43,513 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:22:45,533 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:22:45,536 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:22:47,547 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:22:47,550 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:22:47,801 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:22:47,817 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:22:47,839 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:22:49,672 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:22:49,699 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:22:51,731 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:22:51,734 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:22:52,875 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:22:52,897 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:22:52,910 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:22:53,743 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:22:53,746 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:22:55,767 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:22:55,770 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:22:57,783 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:22:57,785 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:22:57,928 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:22:57,948 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:22:57,973 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:22:59,831 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:22:59,837 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:23:01,869 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:23:01,872 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:23:03,009 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:23:03,044 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:23:03,081 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:23:03,886 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:23:03,889 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:23:05,916 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:23:05,919 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:23:07,942 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:23:07,944 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:23:08,111 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:23:08,133 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:23:08,150 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:23:09,951 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:23:09,953 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:23:11,964 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:23:11,967 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:23:13,165 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:23:13,174 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:23:13,182 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:23:13,982 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:23:13,985 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:23:16,000 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:23:16,017 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:23:18,039 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:23:18,045 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:23:18,209 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:23:18,225 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:23:18,237 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:23:20,063 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:23:20,067 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:23:22,077 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:23:22,080 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:23:23,272 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:23:23,304 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:23:23,318 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:23:24,090 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:23:24,093 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:23:26,106 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:23:26,109 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:23:28,120 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:23:28,127 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:23:28,325 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:23:28,330 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:23:28,338 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:23:30,149 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:23:30,153 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:23:32,166 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:23:32,169 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:23:33,365 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:23:33,397 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:23:33,428 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:23:34,179 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:23:34,182 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:23:36,196 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:23:36,200 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:23:38,214 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:23:38,218 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:23:38,437 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:23:38,445 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:23:38,453 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:23:40,241 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:23:40,245 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:23:42,256 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:23:42,260 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:23:43,484 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:23:43,497 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:23:43,510 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:23:44,269 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:23:44,273 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:23:46,287 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:23:46,291 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:23:48,318 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:23:48,323 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:23:48,538 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:23:48,548 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:23:48,576 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:23:50,339 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:23:50,349 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:23:52,357 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:23:52,360 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:23:53,578 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 09:23:53,578 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 09:23:53,579 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 09:23:53,579 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 09:23:53,579 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE, mode: buffer
2025-05-06 09:23:53,604 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:23:53,605 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:23:53,628 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:23:53,629 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:23:53,631 - INFO - Using strategy buffer configuration
2025-05-06 09:23:53,639 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 09:23:53,690 - INFO - Successfully applied config to broker 2
2025-05-06 09:23:53,747 - INFO - Successfully applied config to broker 3
2025-05-06 09:23:53,858 - INFO - Successfully applied config to broker 1
2025-05-06 09:23:53,859 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 09:23:54,388 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:23:54,393 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:23:54,862 - INFO - Triggering leader election
2025-05-06 09:23:54,863 - INFO - Listing topics for leader election
2025-05-06 09:23:54,873 - INFO - Found 1 topics for leader election
2025-05-06 09:23:54,873 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 09:23:54,874 - INFO - Leader election completed in 0.01 seconds, success: False
2025-05-06 09:23:54,875 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 09:23:55,633 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:23:55,638 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:23:55,651 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:23:56,407 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:23:56,409 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:23:57,656 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:23:57,660 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:23:57,666 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:23:58,417 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:23:58,420 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:23:59,669 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:23:59,678 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:23:59,688 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:24:00,439 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:24:00,442 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:24:01,702 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:24:01,714 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:24:01,726 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:24:02,451 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:24:02,455 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:24:03,728 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:24:03,741 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:24:03,755 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:24:04,469 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:24:04,477 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:24:05,762 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:24:05,769 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:24:05,778 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:24:06,484 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:24:06,510 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:24:07,782 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:24:07,802 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:24:07,832 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:24:08,588 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:24:08,611 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:24:09,842 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:24:09,883 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 09:24:09,884 - INFO - Attempting broker recovery for kafka1
2025-05-06 09:24:09,885 - INFO - Attempting internal recovery for broker 1
2025-05-06 09:24:09,885 - INFO - Triggering internal recovery for broker 1
2025-05-06 09:24:09,933 - INFO - Found 1 partitions on broker 1
2025-05-06 09:24:09,936 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 09:24:09,936 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 09:24:09,937 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 09:24:09,944 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:24:09,947 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 09:24:10,278 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:24:10,311 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:24:10,434 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 09:24:10,434 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 09:24:10,435 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 09:24:10,631 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:24:10,644 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:24:12,290 - INFO - Skipping recovery for kafka1:9092, last attempt 18.7s ago
2025-05-06 09:24:12,324 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:24:12,351 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:24:12,679 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:24:12,686 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:24:14,693 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:24:14,695 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:24:16,714 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:24:16,719 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:24:17,355 - INFO - Skipping recovery for kafka1:9092, last attempt 23.8s ago
2025-05-06 09:24:17,393 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:24:17,419 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:24:18,722 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:24:18,724 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:24:20,756 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:24:20,759 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:24:22,418 - INFO - Skipping recovery for kafka1:9092, last attempt 28.8s ago
2025-05-06 09:24:22,464 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:24:22,485 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:24:22,769 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:24:22,773 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:24:24,794 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:24:24,799 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:24:26,842 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:24:26,851 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:24:27,508 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:24:27,530 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:24:27,554 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:24:28,856 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:24:28,859 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:24:30,880 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:24:30,893 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:24:32,598 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:24:32,634 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:24:32,657 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:24:32,909 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:24:32,912 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:24:34,925 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:24:34,929 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:24:36,942 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:24:36,945 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:24:37,814 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:24:37,845 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:24:37,895 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:24:38,961 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:24:38,964 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:24:40,993 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:24:41,003 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:24:42,931 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:24:42,947 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:24:42,975 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:24:43,011 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:24:43,016 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:24:45,035 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:24:45,039 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:24:47,105 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:24:47,114 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:24:47,995 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:24:48,038 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:24:48,070 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:24:49,132 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:24:49,140 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:24:51,217 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:24:51,267 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:24:53,098 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:24:53,126 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:24:53,154 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:24:53,297 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:24:53,301 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:24:55,341 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:24:55,356 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:34:17,516 - INFO - PRIMARY KAFKA BROKERS (for monitoring): ['kafka1:9092', 'kafka2:9093', 'kafka3:9094']
2025-05-06 09:34:17,517 - INFO - Container names: ['kafka1', 'kafka2', 'kafka3']
2025-05-06 09:34:17,518 - INFO - Alternative addresses (for connection attempts ONLY): ['kafka1:29092', 'kafka2:29093', 'kafka3:29094']
2025-05-06 09:34:17,518 - INFO - Starting Kafka Arms Controller
2025-05-06 09:34:17,538 - INFO - Started Prometheus metrics server on port 8002
2025-05-06 09:34:17,583 - INFO - Loaded strategy buffer: QUICK_REBALANCE
2025-05-06 09:34:17,658 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:34:17,674 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:34:19,707 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:34:19,718 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:34:21,551 - INFO - Monitoring these brokers ONLY: ['kafka1:9092', 'kafka2:9093', 'kafka3:9094']
2025-05-06 09:34:21,553 - INFO - TEST MODE ENABLED - Will simulate failures for kafka1:9092 every 120 seconds
2025-05-06 09:34:21,553 - INFO - Test mode initialized, broker kafka1:9092 will be tested on next check
2025-05-06 09:34:21,554 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 09:34:21,555 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 09:34:21,567 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 09:34:21,568 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 09:34:21,627 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: CONTROLLED_GRADUAL, mode: buffer
2025-05-06 09:34:21,751 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:34:21,755 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:34:23,849 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:34:23,875 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:34:25,887 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:34:25,894 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:34:27,904 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:34:27,911 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:34:30,062 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:34:30,096 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:34:31,634 - WARNING - Broker kafka2:9093 availability check failed: KafkaError{code=_TRANSPORT,val=-195,str="Failed to get metadata: Local: Broker transport failure"}
2025-05-06 09:34:31,641 - WARNING - Broker kafka2:9093 availability check failed: KafkaError{code=_TRANSPORT,val=-195,str="Failed to get metadata: Local: Broker transport failure"}
2025-05-06 09:34:32,178 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:34:32,217 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:34:33,955 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:34:33,976 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:34:34,308 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:34:34,322 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:34:34,339 - INFO - Using strategy buffer configuration
2025-05-06 09:34:34,392 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:34:34,400 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:34:34,430 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 09:34:34,912 - INFO - Successfully applied config to broker 2
2025-05-06 09:34:35,752 - INFO - Successfully applied config to broker 3
2025-05-06 09:34:36,235 - INFO - Successfully applied config to broker 1
2025-05-06 09:34:36,236 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 09:34:36,247 - INFO - Triggering leader election
2025-05-06 09:34:36,265 - INFO - Listing topics for leader election
2025-05-06 09:34:36,351 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:34:36,354 - WARNING - No topics found for leader election
2025-05-06 09:34:36,358 - WARNING - Leader election not completely successful, but continuing recovery
2025-05-06 09:34:36,358 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 09:34:36,505 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:34:36,551 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:34:36,565 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:34:36,619 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:34:38,584 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:34:38,615 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:34:38,666 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:34:38,681 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:34:38,750 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:34:40,750 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:34:40,757 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:34:40,831 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:34:40,876 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:34:41,021 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:34:42,938 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:34:43,032 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:34:44,085 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:34:44,194 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:34:44,315 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:34:45,080 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:34:45,088 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:34:46,323 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:34:46,384 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:34:47,107 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:34:47,127 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:34:47,394 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:34:49,141 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:34:49,144 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:34:49,396 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:34:49,408 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:34:49,417 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:34:51,160 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:34:51,175 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:34:51,363 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 09:34:51,363 - INFO - Attempting broker recovery for kafka1
2025-05-06 09:34:51,363 - INFO - Attempting internal recovery for broker 1
2025-05-06 09:34:51,364 - INFO - Triggering internal recovery for broker 1
2025-05-06 09:34:51,378 - INFO - Found 1 partitions on broker 1
2025-05-06 09:34:51,379 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 09:34:51,379 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 09:34:51,379 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 09:34:51,380 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 09:34:51,401 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:34:51,419 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:34:51,444 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:34:51,457 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:34:51,476 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 09:34:51,477 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 09:34:51,477 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 09:34:53,190 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:34:53,192 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:34:53,472 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:34:53,483 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:34:53,499 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:34:55,198 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:34:55,201 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:34:57,218 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:34:57,222 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:34:58,530 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:34:58,549 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:34:58,562 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:34:59,239 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 09:34:59,242 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:35:01,265 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:35:01,310 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:35:03,331 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:35:03,339 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:35:03,590 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:35:03,609 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:35:03,627 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:35:05,395 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:35:05,418 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:35:07,449 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:35:07,480 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:35:08,673 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:35:08,692 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:35:08,707 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:35:09,523 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:35:09,544 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:35:11,629 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:35:11,646 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:35:13,692 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:35:13,708 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:35:13,756 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:35:13,811 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:35:13,840 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:35:15,760 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:35:15,765 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:35:17,810 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:35:17,814 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:35:18,879 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:35:18,896 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:35:18,910 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:35:19,832 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:35:19,835 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:35:21,847 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:35:21,850 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:35:23,865 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:35:23,868 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:35:23,982 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:35:24,000 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:35:24,012 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:35:25,891 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:35:25,894 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:35:27,905 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:35:27,909 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:35:29,046 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:35:29,064 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:35:29,079 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:35:29,940 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:35:29,962 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:35:31,975 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:35:31,978 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:35:33,992 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:35:33,996 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:35:34,106 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:35:34,127 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:35:34,136 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:35:36,022 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:35:36,024 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:35:38,036 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:35:38,039 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:35:39,175 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:35:39,188 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:35:39,202 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:35:40,073 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:35:40,079 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:35:42,090 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:35:42,102 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:35:44,124 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:35:44,128 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:35:44,233 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:35:44,248 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:35:44,258 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:35:46,163 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:35:46,168 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:35:48,183 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:35:48,187 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:35:49,300 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:35:49,325 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:35:49,336 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:35:50,202 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:35:50,213 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:35:52,237 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:35:52,242 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:35:54,252 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:35:54,255 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:35:54,358 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:35:54,379 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:35:54,393 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:35:56,285 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:35:56,292 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:35:58,303 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:35:58,306 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:35:59,426 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:35:59,437 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:35:59,448 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:00,317 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:36:00,320 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:36:02,340 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:36:02,344 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:36:04,361 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:36:04,365 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:36:04,482 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:04,497 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:04,508 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:06,398 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:36:06,403 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:36:08,432 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:36:08,442 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:36:09,534 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:09,562 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:09,575 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:10,459 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:36:10,475 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:36:12,497 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:36:12,501 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:36:14,527 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:36:14,536 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:36:14,598 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:14,614 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:14,633 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:16,567 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:36:16,580 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:36:18,596 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:36:18,600 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:36:19,669 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:19,686 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:19,696 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:20,623 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:36:20,626 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:36:22,649 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:36:22,653 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:36:24,657 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:36:24,663 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:36:24,704 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 09:36:24,705 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 09:36:24,705 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 09:36:24,705 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 09:36:24,705 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE, mode: buffer
2025-05-06 09:36:24,725 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:24,726 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:24,736 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:24,736 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:24,739 - INFO - Using strategy buffer configuration
2025-05-06 09:36:24,749 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 09:36:24,806 - INFO - Successfully applied config to broker 2
2025-05-06 09:36:24,899 - INFO - Successfully applied config to broker 3
2025-05-06 09:36:25,049 - INFO - Successfully applied config to broker 1
2025-05-06 09:36:25,054 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 09:36:25,060 - INFO - Triggering leader election
2025-05-06 09:36:25,062 - INFO - Listing topics for leader election
2025-05-06 09:36:25,087 - INFO - Found 1 topics for leader election
2025-05-06 09:36:25,088 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 09:36:25,088 - INFO - Leader election completed in 0.03 seconds, success: False
2025-05-06 09:36:25,092 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 09:36:26,717 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:36:26,740 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:36:26,744 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:36:26,754 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:26,768 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:28,756 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:36:28,759 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:36:28,769 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:36:28,776 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:28,781 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:30,786 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:36:30,809 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:36:30,819 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:30,822 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:36:30,839 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:32,844 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:36:32,860 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:36:32,874 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:36:32,876 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:32,896 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:34,894 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:36:34,897 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:36:34,899 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:36:34,906 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:34,911 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:36,909 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:36:36,912 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:36:36,918 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:36:36,934 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:36,943 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:38,942 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:36:38,946 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:36:38,946 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:36:38,954 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:38,961 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:40,095 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 09:36:40,096 - INFO - Attempting broker recovery for kafka1
2025-05-06 09:36:40,097 - INFO - Attempting internal recovery for broker 1
2025-05-06 09:36:40,097 - INFO - Triggering internal recovery for broker 1
2025-05-06 09:36:40,116 - INFO - Found 1 partitions on broker 1
2025-05-06 09:36:40,116 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 09:36:40,116 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 09:36:40,116 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 09:36:40,117 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 09:36:40,130 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:40,149 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 09:36:40,150 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 09:36:40,150 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 09:36:40,955 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:36:40,960 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:36:40,963 - INFO - Skipping recovery for kafka1:9092, last attempt 16.3s ago
2025-05-06 09:36:40,973 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:40,982 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:42,996 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:36:43,000 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:36:45,010 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:36:45,013 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:36:45,991 - INFO - Skipping recovery for kafka1:9092, last attempt 21.3s ago
2025-05-06 09:36:46,033 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:46,052 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:47,041 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:36:47,044 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:36:49,059 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:36:49,064 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:36:51,059 - INFO - Skipping recovery for kafka1:9092, last attempt 26.4s ago
2025-05-06 09:36:51,078 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:36:51,082 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:36:51,083 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:51,104 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:53,091 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:36:53,095 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:36:55,105 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:36:55,108 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:36:56,134 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:56,168 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:56,186 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:36:57,143 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:36:57,167 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:36:59,181 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:36:59,183 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:37:01,209 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:37:01,216 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:37:01,220 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:37:01,250 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:37:01,263 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:37:03,254 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:37:03,263 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:37:05,271 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:37:05,274 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:37:06,302 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:37:06,329 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:37:06,338 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:37:07,303 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:37:07,305 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:37:09,329 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:37:09,333 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:37:11,368 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:37:11,377 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:37:11,418 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:37:11,422 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:37:11,454 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:37:13,441 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:37:13,447 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:37:15,461 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:37:15,473 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:37:16,497 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:37:16,512 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:37:16,546 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:37:17,499 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:37:17,503 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:37:19,524 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:37:19,536 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:37:21,569 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:37:21,589 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:37:21,591 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:37:21,621 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:37:21,648 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:37:23,634 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:37:23,639 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:37:25,647 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:37:25,661 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:37:26,678 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:37:26,697 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:37:26,710 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:37:27,693 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:37:27,695 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:37:29,707 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:37:29,709 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:37:31,738 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:37:31,770 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:37:31,779 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:37:31,786 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:37:31,812 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:37:33,828 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:37:33,833 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:37:35,850 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:37:35,859 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:37:36,837 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:37:36,854 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:37:36,903 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:37:37,875 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:37:37,881 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:37:39,902 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:37:39,906 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:37:41,925 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:37:41,952 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:37:41,954 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:37:41,969 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:37:41,986 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:37:43,984 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:37:43,991 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:37:46,024 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:37:46,031 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:37:47,160 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:37:47,251 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:37:47,291 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:37:48,066 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:37:48,069 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:37:50,082 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:37:50,085 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:37:52,111 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:37:52,114 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:37:52,313 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:37:52,327 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:37:52,350 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:37:54,141 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:37:54,154 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:37:56,183 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:37:56,190 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:37:57,393 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:37:57,412 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:37:57,437 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:37:58,218 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:37:58,221 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:38:00,225 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:38:00,227 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:38:02,259 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:38:02,262 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:38:02,454 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:02,492 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:02,513 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:04,277 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:38:04,281 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:38:06,301 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:38:06,309 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:38:07,561 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:07,587 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:07,611 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:08,354 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:38:08,357 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:38:10,374 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:38:10,398 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:38:12,434 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:38:12,494 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:38:12,653 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:12,670 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:12,693 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:14,510 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:38:14,513 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:38:16,547 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:38:16,550 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:38:17,738 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:17,764 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:17,776 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:18,588 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:38:18,592 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:38:20,624 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:38:20,627 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:38:22,662 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:38:22,679 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:38:22,805 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:22,822 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:22,839 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:24,686 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:38:24,690 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:38:26,717 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:38:26,723 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:38:27,846 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 09:38:27,849 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 09:38:27,854 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 09:38:27,855 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 09:38:27,855 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE, mode: buffer
2025-05-06 09:38:27,925 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:27,926 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:27,953 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:27,954 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:27,961 - INFO - Using strategy buffer configuration
2025-05-06 09:38:27,971 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 09:38:28,054 - INFO - Successfully applied config to broker 2
2025-05-06 09:38:28,091 - INFO - Successfully applied config to broker 3
2025-05-06 09:38:28,180 - INFO - Successfully applied config to broker 1
2025-05-06 09:38:28,180 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 09:38:28,185 - INFO - Triggering leader election
2025-05-06 09:38:28,187 - INFO - Listing topics for leader election
2025-05-06 09:38:28,204 - INFO - Found 1 topics for leader election
2025-05-06 09:38:28,204 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 09:38:28,204 - INFO - Leader election completed in 0.02 seconds, success: False
2025-05-06 09:38:28,207 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 09:38:28,795 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:38:28,806 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:38:29,963 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:38:29,987 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:30,009 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:30,832 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:38:30,857 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:38:32,013 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:38:32,032 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:32,042 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:32,877 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:38:32,880 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:38:34,046 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:38:34,063 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:34,071 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:34,887 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:38:34,889 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:38:36,073 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:38:36,113 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:36,127 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:36,916 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:38:36,926 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:38:38,129 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:38:38,137 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:38,153 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:38,941 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:38:38,944 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:38:40,155 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:38:40,162 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:40,171 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:40,963 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:38:40,988 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:38:42,178 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:38:42,209 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:42,230 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:43,015 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:38:43,018 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:38:43,225 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 09:38:43,225 - INFO - Attempting broker recovery for kafka1
2025-05-06 09:38:43,225 - INFO - Attempting internal recovery for broker 1
2025-05-06 09:38:43,225 - INFO - Triggering internal recovery for broker 1
2025-05-06 09:38:43,235 - INFO - Found 1 partitions on broker 1
2025-05-06 09:38:43,236 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 09:38:43,236 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 09:38:43,236 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 09:38:43,240 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 09:38:43,279 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:43,295 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 09:38:43,295 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 09:38:43,296 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 09:38:44,234 - INFO - Skipping recovery for kafka1:9092, last attempt 16.4s ago
2025-05-06 09:38:44,244 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:44,248 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:45,025 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:38:45,027 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:38:47,046 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:38:47,051 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:38:49,068 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:38:49,072 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:38:49,262 - INFO - Skipping recovery for kafka1:9092, last attempt 21.4s ago
2025-05-06 09:38:49,278 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:49,294 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:51,094 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:38:51,099 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:38:53,121 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:38:53,124 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:38:54,300 - INFO - Skipping recovery for kafka1:9092, last attempt 26.5s ago
2025-05-06 09:38:54,328 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:54,348 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:55,137 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:38:55,165 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:38:57,193 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:38:57,199 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:38:59,213 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:38:59,216 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:38:59,373 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:59,385 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:38:59,397 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:39:01,231 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:39:01,235 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:39:03,292 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:39:03,315 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:39:04,442 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:39:04,469 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:39:04,487 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:39:05,333 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:39:05,337 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:39:07,358 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:39:07,361 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:39:09,370 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:39:09,373 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:39:09,540 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:39:09,587 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:39:09,609 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:39:11,397 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:39:11,408 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:39:13,425 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:39:13,429 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:39:14,632 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:39:14,651 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:39:14,664 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:39:15,437 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:39:15,441 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:39:17,463 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:39:17,465 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:39:19,482 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:39:19,498 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:39:19,687 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:39:19,743 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:39:19,765 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:39:21,518 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:39:21,521 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:39:23,540 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:39:23,543 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:39:24,798 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:39:24,819 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:39:24,829 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:39:25,563 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:39:25,566 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:39:27,582 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:39:27,586 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:39:29,603 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:39:29,607 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:39:29,861 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:39:29,878 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:39:29,894 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:39:31,622 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:39:31,625 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:39:33,637 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:39:33,642 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:39:34,934 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:39:34,962 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:39:34,979 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:39:35,693 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:39:35,715 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:39:37,763 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:39:37,776 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:39:39,788 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:39:39,792 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:39:40,024 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:39:40,054 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:39:40,078 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:39:41,813 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:39:41,827 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:39:43,850 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:39:43,865 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:39:45,106 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:39:45,121 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:39:45,131 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:39:45,886 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:39:45,890 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:39:47,922 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:39:47,953 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:39:49,973 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:39:49,976 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:39:50,178 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:39:50,205 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:39:50,247 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:39:52,004 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:39:52,007 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:39:54,019 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:39:54,026 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:39:55,292 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:39:55,322 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:39:55,334 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:39:56,051 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:39:56,055 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:39:58,069 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:39:58,072 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:40:00,107 - ERROR - API returned status code: 500
2025-05-06 09:40:00,363 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:00,394 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:00,405 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:02,128 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:40:02,130 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:40:04,143 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:40:04,146 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:40:05,431 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:05,449 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:05,457 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:06,165 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:40:06,169 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:40:08,216 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:40:08,223 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:40:10,233 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:40:10,237 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:40:10,495 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:10,517 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:10,534 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:12,259 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:40:12,262 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:40:14,278 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:40:14,299 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:40:15,573 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:15,588 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:15,597 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:16,321 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:40:16,329 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:40:18,350 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:40:18,353 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:40:20,374 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:40:20,380 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:40:20,636 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:20,657 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:20,672 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:22,395 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:40:22,399 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:40:24,423 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:40:24,427 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:40:25,753 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:25,797 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:25,829 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:26,458 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:40:26,461 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:40:28,488 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:40:28,492 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:40:30,506 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:40:30,509 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:40:30,834 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 09:40:30,834 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 09:40:30,836 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 09:40:30,836 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 09:40:30,836 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE, mode: buffer
2025-05-06 09:40:30,855 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:30,855 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:30,874 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:30,874 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:30,879 - INFO - Using strategy buffer configuration
2025-05-06 09:40:30,882 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 09:40:30,941 - INFO - Successfully applied config to broker 2
2025-05-06 09:40:30,998 - INFO - Successfully applied config to broker 3
2025-05-06 09:40:31,069 - INFO - Successfully applied config to broker 1
2025-05-06 09:40:31,069 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 09:40:31,070 - INFO - Triggering leader election
2025-05-06 09:40:31,072 - INFO - Listing topics for leader election
2025-05-06 09:40:31,078 - INFO - Found 1 topics for leader election
2025-05-06 09:40:31,079 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 09:40:31,079 - INFO - Leader election completed in 0.01 seconds, success: False
2025-05-06 09:40:31,081 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 09:40:32,542 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:40:32,550 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:40:32,880 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:40:32,913 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:32,927 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:34,562 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:40:34,564 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:40:34,932 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:40:35,010 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:35,045 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:36,600 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:40:36,605 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:40:37,050 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:40:37,064 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:37,073 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:38,642 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:40:38,646 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:40:39,079 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:40:39,099 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:39,107 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:40,664 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:40:40,670 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:40:41,109 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:40:41,128 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:41,145 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:42,697 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:40:42,700 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:40:43,152 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:40:43,156 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:43,163 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:44,706 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:40:44,709 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:40:45,168 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:40:45,176 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:45,183 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:46,094 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 09:40:46,103 - INFO - Attempting broker recovery for kafka1
2025-05-06 09:40:46,103 - INFO - Attempting internal recovery for broker 1
2025-05-06 09:40:46,103 - INFO - Triggering internal recovery for broker 1
2025-05-06 09:40:46,112 - INFO - Found 1 partitions on broker 1
2025-05-06 09:40:46,113 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 09:40:46,114 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 09:40:46,114 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 09:40:46,116 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 09:40:46,133 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:46,160 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 09:40:46,160 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 09:40:46,160 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 09:40:46,725 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:40:46,730 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:40:47,189 - INFO - Skipping recovery for kafka1:9092, last attempt 16.4s ago
2025-05-06 09:40:47,200 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:47,218 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:48,755 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:40:48,759 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:40:50,778 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:40:50,786 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:40:52,225 - INFO - Skipping recovery for kafka1:9092, last attempt 21.4s ago
2025-05-06 09:40:52,263 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:52,276 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:52,826 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:40:52,836 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:40:54,857 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:40:54,871 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:40:56,901 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:40:56,905 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:40:57,283 - INFO - Skipping recovery for kafka1:9092, last attempt 26.4s ago
2025-05-06 09:40:57,301 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:57,317 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:40:58,920 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:40:58,923 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:41:00,965 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:41:00,970 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:41:02,352 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:41:02,378 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:41:02,387 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:41:02,987 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:41:02,990 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:41:05,000 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:41:05,005 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:41:07,036 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:41:07,044 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:41:07,426 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:41:07,436 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:41:07,446 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:41:09,058 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:41:09,062 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:41:11,085 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:41:11,090 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:41:12,504 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:41:12,530 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:41:12,544 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:41:13,123 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:41:13,127 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:41:15,165 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:41:15,188 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:41:17,217 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:41:17,233 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:41:17,582 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:41:17,592 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:41:17,607 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:41:19,247 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:41:19,250 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:41:21,264 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:41:21,267 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:41:22,720 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:41:22,773 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:41:22,800 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:41:23,300 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:41:23,303 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:41:25,311 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:41:25,314 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:41:27,329 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:41:27,332 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:41:27,826 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:41:27,837 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:41:27,850 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:41:29,352 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:41:29,355 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:41:31,373 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:41:31,376 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:41:32,873 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:41:32,895 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:41:32,904 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:41:33,409 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:41:33,413 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:41:35,432 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:41:35,435 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:41:37,476 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:41:37,479 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:41:37,944 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:41:37,967 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:41:38,000 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:41:39,491 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:41:39,497 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:41:41,514 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:41:41,523 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:41:43,027 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:41:43,063 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:41:43,083 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:41:43,534 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:41:43,537 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:41:45,548 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:41:45,551 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:41:47,565 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:41:47,569 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:41:48,121 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:41:48,135 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:41:48,153 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:41:49,581 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:41:49,584 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:41:51,599 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:41:51,608 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:41:53,169 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:41:53,177 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:41:53,184 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:41:53,623 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:41:53,626 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:41:55,652 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:41:55,666 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:41:57,679 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:41:57,682 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:41:58,227 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:41:58,238 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:41:58,258 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:41:59,715 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:41:59,721 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:42:01,728 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:42:01,732 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:42:03,285 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:03,311 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:03,328 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:03,761 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:42:03,764 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:42:05,780 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:42:05,784 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:42:07,822 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:42:07,838 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:42:08,358 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:08,377 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:08,390 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:09,849 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:42:09,852 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:42:11,873 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:42:11,876 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:42:13,421 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:13,439 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:13,461 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:13,893 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:42:13,896 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:42:15,913 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:42:15,916 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:42:17,938 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:42:17,941 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:42:18,501 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:18,523 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:18,545 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:19,976 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:42:19,980 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:42:21,992 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:42:21,995 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:42:23,592 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:23,624 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:23,638 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:24,029 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:42:24,040 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:42:26,057 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:42:26,082 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:42:28,118 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:42:28,129 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:42:28,673 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:28,694 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:28,711 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:30,148 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:42:30,151 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:42:32,176 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:42:32,180 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:42:33,715 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 09:42:33,716 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 09:42:33,717 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 09:42:33,718 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 09:42:33,720 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE, mode: buffer
2025-05-06 09:42:33,745 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:33,757 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:33,769 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:33,770 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:33,772 - INFO - Using strategy buffer configuration
2025-05-06 09:42:33,775 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 09:42:33,824 - INFO - Successfully applied config to broker 2
2025-05-06 09:42:33,895 - INFO - Successfully applied config to broker 3
2025-05-06 09:42:33,992 - INFO - Successfully applied config to broker 1
2025-05-06 09:42:33,992 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 09:42:33,997 - INFO - Triggering leader election
2025-05-06 09:42:33,999 - INFO - Listing topics for leader election
2025-05-06 09:42:34,016 - INFO - Found 1 topics for leader election
2025-05-06 09:42:34,016 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 09:42:34,016 - INFO - Leader election completed in 0.02 seconds, success: False
2025-05-06 09:42:34,021 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 09:42:34,217 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:42:34,233 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:42:35,777 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:42:35,802 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:35,816 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:36,247 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:42:36,253 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:42:37,831 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:42:37,839 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:37,846 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:38,276 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:42:38,287 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:42:39,851 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:42:39,878 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:39,890 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:40,313 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:42:40,323 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:42:41,894 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:42:41,898 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:41,905 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:42,348 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:42:42,351 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:42:43,912 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:42:43,946 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:43,958 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:44,379 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:42:44,382 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:42:45,963 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:42:45,979 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:45,986 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:46,404 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:42:46,407 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:42:47,990 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:42:48,016 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:48,030 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:48,421 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:42:48,424 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:42:49,034 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 09:42:49,035 - INFO - Attempting broker recovery for kafka1
2025-05-06 09:42:49,035 - INFO - Attempting internal recovery for broker 1
2025-05-06 09:42:49,036 - INFO - Triggering internal recovery for broker 1
2025-05-06 09:42:49,053 - INFO - Found 1 partitions on broker 1
2025-05-06 09:42:49,053 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 09:42:49,053 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 09:42:49,053 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 09:42:49,056 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 09:42:49,069 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:49,093 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 09:42:49,093 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 09:42:49,093 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 09:42:50,033 - INFO - Skipping recovery for kafka1:9092, last attempt 16.3s ago
2025-05-06 09:42:50,040 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:50,046 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:50,439 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:42:50,443 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:42:52,485 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:42:52,488 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:42:54,514 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:42:54,528 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:42:55,053 - INFO - Skipping recovery for kafka1:9092, last attempt 21.3s ago
2025-05-06 09:42:55,078 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:55,091 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:42:56,548 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:42:56,555 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:42:58,570 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:42:58,573 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:43:00,100 - INFO - Skipping recovery for kafka1:9092, last attempt 26.4s ago
2025-05-06 09:43:00,117 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:43:00,127 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:43:00,585 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:43:00,590 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:43:02,611 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:43:02,614 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:43:04,618 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:43:04,623 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:43:05,161 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:43:05,182 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:43:05,200 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:43:06,634 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:43:06,637 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:43:08,648 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:43:08,653 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:43:10,241 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:43:10,269 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:43:10,286 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:43:10,667 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:43:10,670 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:43:12,701 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:43:12,704 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:43:14,714 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:43:14,720 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:43:15,317 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:43:15,333 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:43:15,339 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:43:16,766 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:43:16,773 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:43:18,788 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:43:18,791 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:43:20,382 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:43:20,408 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:43:20,420 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:43:20,803 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:43:20,813 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:43:22,840 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:43:22,843 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:43:24,851 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:43:24,853 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:43:25,457 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:43:25,476 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:43:25,488 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:43:26,878 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:43:26,881 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:43:28,892 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:43:28,894 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:43:30,516 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:43:30,539 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:43:30,560 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:43:30,907 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:43:30,914 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:43:32,923 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:43:32,926 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:43:34,962 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:43:34,971 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:43:35,595 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:43:35,616 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:43:35,625 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:43:36,993 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:43:36,997 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:43:39,007 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:43:39,012 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:43:40,666 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:43:40,690 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:43:40,707 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:43:41,026 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:43:41,029 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:43:43,057 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:43:43,065 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:43:45,071 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:43:45,074 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:43:45,743 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:43:45,763 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:43:45,778 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:43:47,123 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:43:47,129 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:43:49,140 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:43:49,143 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:43:50,805 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:43:50,832 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:43:50,854 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:43:51,151 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:43:51,154 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:43:53,174 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:43:53,177 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:43:55,191 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:43:55,197 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:43:55,899 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:43:55,923 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:43:55,930 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:43:57,230 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:43:57,233 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:43:59,261 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:43:59,265 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:44:00,954 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:00,970 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:00,985 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:01,282 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:44:01,285 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:44:03,309 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:44:03,312 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:44:05,333 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:44:05,336 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:44:06,018 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:06,043 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:06,066 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:07,369 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:44:07,381 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:44:09,395 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:44:09,399 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:44:11,094 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:11,125 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:11,141 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:11,424 - ERROR - API returned status code: 500
2025-05-06 09:44:13,455 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:44:13,458 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:44:15,470 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:44:15,472 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:44:16,162 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:16,180 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:16,186 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:17,513 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:44:17,526 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:44:19,540 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:44:19,543 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:44:21,205 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:21,221 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:21,236 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:21,551 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:44:21,554 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:44:23,592 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:44:23,595 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:44:25,609 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:44:25,614 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:44:26,264 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:26,301 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:26,312 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:27,653 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:44:27,664 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:44:29,672 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:44:29,674 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:44:31,338 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:31,358 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:31,376 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:31,687 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:44:31,689 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:44:33,720 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:44:33,724 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:44:35,741 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:44:35,745 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:44:36,378 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 09:44:36,379 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 09:44:36,380 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 09:44:36,380 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 09:44:36,380 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE, mode: buffer
2025-05-06 09:44:36,396 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:36,396 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:36,409 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:36,409 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:36,411 - INFO - Using strategy buffer configuration
2025-05-06 09:44:36,414 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 09:44:36,443 - INFO - Successfully applied config to broker 2
2025-05-06 09:44:36,582 - INFO - Successfully applied config to broker 3
2025-05-06 09:44:36,880 - INFO - Successfully applied config to broker 1
2025-05-06 09:44:36,880 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 09:44:36,884 - INFO - Triggering leader election
2025-05-06 09:44:36,889 - INFO - Listing topics for leader election
2025-05-06 09:44:36,905 - INFO - Found 1 topics for leader election
2025-05-06 09:44:36,913 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 09:44:36,913 - INFO - Leader election completed in 0.02 seconds, success: False
2025-05-06 09:44:37,775 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:44:37,779 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:44:37,921 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 09:44:38,413 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:44:38,432 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:38,448 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:39,796 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:44:39,801 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:44:40,453 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:44:40,477 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:40,486 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:41,859 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:44:41,885 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:44:42,493 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:44:42,536 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:42,548 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:43,912 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:44:43,915 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:44:44,554 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:44:44,560 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:44,571 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:45,937 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:44:45,942 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:44:46,577 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:44:46,592 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:46,606 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:47,972 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:44:47,978 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:44:48,611 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:44:48,636 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:48,647 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:49,987 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:44:49,991 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:44:50,652 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:44:50,661 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:50,668 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:52,013 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:44:52,016 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:44:52,671 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:44:52,698 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:52,713 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:52,938 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 09:44:52,938 - INFO - Attempting broker recovery for kafka1
2025-05-06 09:44:52,939 - INFO - Attempting internal recovery for broker 1
2025-05-06 09:44:52,939 - INFO - Triggering internal recovery for broker 1
2025-05-06 09:44:52,943 - INFO - Found 1 partitions on broker 1
2025-05-06 09:44:52,943 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 09:44:52,943 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 09:44:52,944 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 09:44:52,944 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 09:44:52,964 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:52,985 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 09:44:52,985 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 09:44:52,985 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 09:44:54,035 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:44:54,038 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:44:54,717 - INFO - Skipping recovery for kafka1:9092, last attempt 18.3s ago
2025-05-06 09:44:54,722 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:54,728 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:56,054 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:44:56,072 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:44:58,096 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:44:58,100 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:44:59,737 - INFO - Skipping recovery for kafka1:9092, last attempt 23.4s ago
2025-05-06 09:44:59,766 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:44:59,786 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:45:00,105 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:45:00,108 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:45:02,135 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:45:02,138 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:45:04,158 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:45:04,162 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:45:04,788 - INFO - Skipping recovery for kafka1:9092, last attempt 28.4s ago
2025-05-06 09:45:04,813 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:45:04,823 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:45:06,190 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:45:06,195 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:45:08,236 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:45:08,242 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:45:09,861 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:45:09,878 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:45:09,901 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:45:10,256 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:45:10,260 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:45:12,281 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:45:12,287 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:45:14,305 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:45:14,309 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:45:14,926 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:45:14,944 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:45:14,956 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:45:16,334 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:45:16,338 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:45:18,361 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:45:18,365 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:45:19,992 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:45:20,012 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:45:20,023 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:45:20,378 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:45:20,382 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:45:22,420 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:45:22,426 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:45:24,441 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:45:24,444 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:45:25,047 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:45:25,060 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:45:25,068 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:45:26,459 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:45:26,461 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:45:28,476 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:45:28,480 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:45:30,107 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:45:30,135 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:45:30,159 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:45:30,508 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:45:30,513 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:45:32,545 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:45:32,548 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:45:34,556 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:45:34,561 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:45:35,186 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:45:35,203 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:45:35,211 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:45:36,587 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:45:36,592 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:45:38,616 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:45:38,621 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:45:40,247 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:45:40,263 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:45:40,275 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:45:40,630 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:45:40,634 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:45:42,701 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:45:42,705 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:45:44,725 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:45:44,746 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:45:45,308 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:45:45,338 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:45:45,349 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:45:46,761 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:45:46,764 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:45:48,796 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:45:48,806 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:45:50,376 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:45:50,401 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:45:50,421 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:45:50,826 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:45:50,831 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:45:52,864 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:45:52,868 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:45:54,882 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:45:54,887 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:45:55,461 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:45:55,483 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:45:55,495 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:45:56,928 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:45:56,936 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:45:58,950 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:45:58,954 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:46:00,520 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:00,540 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:00,550 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:00,970 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:46:00,975 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:46:03,016 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:46:03,023 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:46:05,056 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:46:05,063 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:46:05,598 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:05,621 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:05,638 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:07,106 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:46:07,112 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:46:09,125 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:46:09,129 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:46:10,681 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:10,713 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:10,730 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:11,159 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:46:11,162 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:46:13,191 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:46:13,205 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:46:15,218 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:46:15,225 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:46:15,762 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:15,781 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:15,793 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:17,267 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:46:17,277 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:46:19,289 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:46:19,291 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:46:20,820 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:20,841 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:20,855 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:21,315 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:46:21,321 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:46:23,350 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:46:23,352 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:46:25,356 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:46:25,360 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:46:25,885 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:25,907 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:25,918 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:27,395 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:46:27,399 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:46:29,412 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:46:29,415 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:46:30,934 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:30,948 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:30,959 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:31,426 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:46:31,430 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:46:33,472 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:46:33,477 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:46:35,483 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:46:35,485 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:46:35,997 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:36,022 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:36,029 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:37,522 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:46:37,526 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:46:39,540 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:46:39,543 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:46:41,038 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 09:46:41,038 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 09:46:41,039 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 09:46:41,039 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 09:46:41,039 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE, mode: buffer
2025-05-06 09:46:41,063 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:41,063 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:41,080 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:41,081 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:41,083 - INFO - Using strategy buffer configuration
2025-05-06 09:46:41,086 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 09:46:41,122 - INFO - Successfully applied config to broker 2
2025-05-06 09:46:41,167 - INFO - Successfully applied config to broker 3
2025-05-06 09:46:41,240 - INFO - Successfully applied config to broker 1
2025-05-06 09:46:41,240 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 09:46:41,245 - INFO - Triggering leader election
2025-05-06 09:46:41,246 - INFO - Listing topics for leader election
2025-05-06 09:46:41,256 - INFO - Found 1 topics for leader election
2025-05-06 09:46:41,257 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 09:46:41,257 - INFO - Leader election completed in 0.01 seconds, success: False
2025-05-06 09:46:41,258 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 09:46:41,619 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:46:41,649 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:46:43,086 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:46:43,162 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:43,186 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:43,684 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:46:43,687 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:46:45,190 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:46:45,195 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:45,199 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:45,694 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:46:45,697 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:46:47,203 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:46:47,227 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:47,243 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:47,718 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:46:47,721 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:46:49,250 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:46:49,262 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:49,270 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:49,735 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:46:49,739 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:46:51,273 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:46:51,280 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:51,284 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:51,745 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:46:51,747 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:46:53,286 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:46:53,308 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:53,318 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:53,773 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:46:53,778 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:46:55,324 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:46:55,330 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:55,334 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:55,794 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:46:55,798 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:46:56,270 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 09:46:56,270 - INFO - Attempting broker recovery for kafka1
2025-05-06 09:46:56,270 - INFO - Attempting internal recovery for broker 1
2025-05-06 09:46:56,270 - INFO - Triggering internal recovery for broker 1
2025-05-06 09:46:56,279 - INFO - Found 1 partitions on broker 1
2025-05-06 09:46:56,280 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 09:46:56,280 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 09:46:56,280 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 09:46:56,281 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 09:46:56,304 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:56,333 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 09:46:56,333 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 09:46:56,333 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 09:46:57,340 - INFO - Skipping recovery for kafka1:9092, last attempt 16.3s ago
2025-05-06 09:46:57,358 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:57,368 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:46:57,833 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:46:57,845 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:46:59,857 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:46:59,863 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:47:01,895 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:47:01,903 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:47:02,375 - INFO - Skipping recovery for kafka1:9092, last attempt 21.3s ago
2025-05-06 09:47:02,424 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:47:02,446 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:47:03,943 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:47:03,948 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:47:05,973 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:47:05,984 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:47:07,456 - INFO - Skipping recovery for kafka1:9092, last attempt 26.4s ago
2025-05-06 09:47:07,473 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:47:07,486 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:47:08,002 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:47:08,008 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:47:10,020 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:47:10,023 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:47:12,039 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:47:12,042 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:47:12,534 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:47:12,554 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:47:12,709 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:47:14,052 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:47:14,059 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:47:16,188 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:47:16,276 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:47:17,754 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:47:17,787 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:47:17,807 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:47:18,313 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:47:18,318 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:47:20,342 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:47:20,346 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:47:22,361 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:47:22,364 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:47:22,828 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:47:22,846 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:47:22,856 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:47:24,386 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:47:24,394 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:47:26,404 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:47:26,409 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:47:27,910 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:47:27,937 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:47:27,952 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:47:28,452 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:47:28,457 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:47:30,466 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:47:30,469 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:47:32,508 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:47:32,511 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:47:33,076 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:47:33,166 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:47:33,293 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:47:34,605 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:47:34,631 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:47:36,657 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:47:36,662 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:47:38,339 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:47:38,371 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:47:38,390 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:47:38,704 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:47:38,709 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:47:40,717 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:47:40,724 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:47:42,756 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:47:42,760 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:47:43,420 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:47:43,438 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:47:43,450 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:47:44,783 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:47:44,788 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:47:46,821 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:47:46,841 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:47:48,484 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:47:48,500 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:47:48,518 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:47:48,854 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:47:48,857 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:47:50,877 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:47:50,882 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:47:52,901 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:47:52,904 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:47:53,551 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:47:53,631 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:47:53,727 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:47:54,934 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:47:54,938 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:47:56,976 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:47:56,992 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:47:58,751 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:47:58,774 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:47:58,791 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:47:59,011 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:47:59,014 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:48:01,032 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:48:01,037 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:48:03,079 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:48:03,094 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:48:03,837 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:03,871 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:03,887 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:05,109 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:48:05,117 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:48:07,145 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:48:07,149 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:48:08,934 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:08,957 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:08,979 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:09,184 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:48:09,189 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:48:11,196 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:48:11,198 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:48:13,217 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:48:13,220 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:48:14,015 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:14,036 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:14,046 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:15,226 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:48:15,228 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:48:17,256 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:48:17,260 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:48:19,069 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:19,085 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:19,101 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:19,272 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:48:19,274 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:48:21,299 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:48:21,307 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:48:23,344 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:48:23,349 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:48:24,132 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:24,157 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:24,184 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:25,381 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:48:25,391 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:48:27,424 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:48:27,428 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:48:29,229 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:29,268 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:29,295 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:29,461 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:48:29,470 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:48:31,506 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:48:31,514 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:48:33,560 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:48:33,576 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:48:34,340 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:34,376 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:34,398 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:35,605 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:48:35,611 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:48:37,647 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:48:37,651 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:48:39,424 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:39,451 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:39,466 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:39,664 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:48:39,667 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:48:41,697 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:48:41,707 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:48:43,746 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:48:43,751 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:48:44,468 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 09:48:44,469 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 09:48:44,470 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 09:48:44,471 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 09:48:44,471 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE, mode: buffer
2025-05-06 09:48:44,493 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:44,493 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:44,521 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:44,522 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:44,527 - INFO - Using strategy buffer configuration
2025-05-06 09:48:44,534 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 09:48:44,613 - INFO - Successfully applied config to broker 2
2025-05-06 09:48:44,706 - INFO - Successfully applied config to broker 3
2025-05-06 09:48:44,852 - INFO - Successfully applied config to broker 1
2025-05-06 09:48:44,853 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 09:48:44,859 - INFO - Triggering leader election
2025-05-06 09:48:44,865 - INFO - Listing topics for leader election
2025-05-06 09:48:44,882 - INFO - Found 1 topics for leader election
2025-05-06 09:48:44,882 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 09:48:44,883 - INFO - Leader election completed in 0.02 seconds, success: False
2025-05-06 09:48:44,887 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 09:48:45,783 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:48:45,791 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:48:46,527 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:48:46,583 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:46,613 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:47,844 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:48:47,889 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:48:48,618 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:48:48,643 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:48,662 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:49,956 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:48:49,965 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:48:50,667 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:48:50,697 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:50,721 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:52,021 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:48:52,027 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:48:52,729 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:48:52,753 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:52,772 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:54,072 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:48:54,083 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:48:54,783 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:48:54,810 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:54,825 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:56,124 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:48:56,140 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:48:56,833 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:48:56,858 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:56,883 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:58,185 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:48:58,193 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:48:58,889 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:48:58,913 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:58,938 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:59,893 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 09:48:59,894 - INFO - Attempting broker recovery for kafka1
2025-05-06 09:48:59,895 - INFO - Attempting internal recovery for broker 1
2025-05-06 09:48:59,896 - INFO - Triggering internal recovery for broker 1
2025-05-06 09:48:59,934 - INFO - Found 1 partitions on broker 1
2025-05-06 09:48:59,935 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 09:48:59,935 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 09:48:59,935 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 09:48:59,938 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 09:48:59,958 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:48:59,995 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 09:48:59,995 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 09:48:59,996 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 09:49:00,204 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:49:00,207 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:49:00,942 - INFO - Skipping recovery for kafka1:9092, last attempt 16.5s ago
2025-05-06 09:49:01,001 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:49:01,038 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:49:02,248 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:49:02,252 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:49:04,295 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:49:04,309 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:49:06,050 - INFO - Skipping recovery for kafka1:9092, last attempt 21.6s ago
2025-05-06 09:49:06,123 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:49:06,157 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:49:06,340 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:49:06,347 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:49:08,378 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:49:08,382 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:49:10,403 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:49:10,406 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:49:11,162 - INFO - Skipping recovery for kafka1:9092, last attempt 26.7s ago
2025-05-06 09:49:11,200 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:49:11,221 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:49:12,441 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:49:12,445 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:49:14,455 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:49:14,458 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:49:16,250 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:49:16,276 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:49:16,304 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:49:16,480 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:49:16,483 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:49:18,533 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:49:18,538 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:49:20,559 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:49:20,562 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:49:21,362 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:49:21,432 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:49:21,489 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:49:22,597 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:49:22,603 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:49:24,612 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:49:24,615 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:49:26,540 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:49:26,629 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:49:26,664 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:49:26,672 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:49:26,681 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:49:28,721 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:49:28,735 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:49:30,773 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:49:30,796 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:49:31,697 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:49:31,726 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:49:31,747 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:49:32,856 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:49:32,860 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:49:34,914 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:49:34,951 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:49:36,816 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:49:36,883 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:49:36,921 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:49:37,045 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:49:37,058 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:49:39,098 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:49:39,103 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:49:41,178 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:49:41,192 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:49:41,951 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:49:42,030 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:49:42,060 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:49:43,220 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:49:43,227 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:49:45,276 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:49:45,288 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:49:47,104 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:49:47,126 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:49:47,141 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:49:47,315 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:49:47,318 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:49:49,356 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:49:49,362 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:49:51,395 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:49:51,407 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:49:52,183 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:49:52,234 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:49:52,259 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:49:53,436 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:49:53,440 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:49:55,461 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:49:55,475 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:49:57,289 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:49:57,309 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:49:57,327 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:49:57,500 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:49:57,503 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:49:59,529 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:49:59,537 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:50:01,588 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:50:01,601 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:50:02,354 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:02,374 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:02,395 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:03,645 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:50:03,655 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:50:05,670 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:50:05,673 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:50:07,426 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:07,445 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:07,457 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:07,693 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:50:07,696 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:50:09,716 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:50:09,719 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:50:11,724 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:50:11,726 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:50:12,483 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:12,502 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:12,515 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:13,750 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:50:13,754 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:50:15,780 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:50:15,796 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:50:17,553 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:17,567 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:17,579 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:17,812 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:50:17,815 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:50:19,837 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:50:19,840 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:50:21,855 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:50:21,858 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:50:22,600 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:22,612 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:22,628 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:23,878 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:50:23,882 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:50:25,906 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:50:25,909 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:50:27,667 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:27,688 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:27,705 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:27,949 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:50:27,952 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:50:29,959 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:50:29,961 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:50:31,975 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:50:31,984 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:50:32,720 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:32,735 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:32,744 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:34,003 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:50:34,006 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:50:36,067 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:50:36,096 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:50:37,789 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:37,817 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:37,835 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:38,129 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:50:38,132 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:50:40,140 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:50:40,143 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:50:42,265 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:50:42,289 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:50:42,921 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:42,968 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:42,994 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:44,337 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:50:44,341 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:50:46,385 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:50:46,409 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:50:48,006 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 09:50:48,008 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 09:50:48,011 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 09:50:48,011 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 09:50:48,012 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE, mode: buffer
2025-05-06 09:50:48,043 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:48,043 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:48,065 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:48,066 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:48,074 - INFO - Using strategy buffer configuration
2025-05-06 09:50:48,081 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 09:50:48,158 - INFO - Successfully applied config to broker 2
2025-05-06 09:50:48,221 - INFO - Successfully applied config to broker 3
2025-05-06 09:50:48,400 - INFO - Successfully applied config to broker 1
2025-05-06 09:50:48,401 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 09:50:48,405 - INFO - Triggering leader election
2025-05-06 09:50:48,406 - INFO - Listing topics for leader election
2025-05-06 09:50:48,419 - INFO - Found 1 topics for leader election
2025-05-06 09:50:48,420 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 09:50:48,420 - INFO - Leader election completed in 0.01 seconds, success: False
2025-05-06 09:50:48,428 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 09:50:48,457 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:50:48,467 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:50:50,078 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:50:50,210 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:50,245 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:50,495 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:50:50,498 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:50:52,251 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:50:52,274 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:52,291 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:52,522 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:50:52,532 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:50:54,297 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:50:54,337 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:54,358 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:54,563 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:50:54,576 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:50:56,364 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:50:56,428 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:56,454 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:56,604 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:50:56,608 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:50:58,460 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:50:58,481 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:58,491 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:50:58,623 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:50:58,625 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:51:00,504 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:51:00,519 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:51:00,526 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:51:00,634 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:51:00,638 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:51:02,531 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:51:02,562 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:51:02,582 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:51:02,685 - ERROR - API returned status code: 500
2025-05-06 09:51:03,433 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 09:51:03,434 - INFO - Attempting broker recovery for kafka1
2025-05-06 09:51:03,435 - INFO - Attempting internal recovery for broker 1
2025-05-06 09:51:03,435 - INFO - Triggering internal recovery for broker 1
2025-05-06 09:51:03,454 - INFO - Found 1 partitions on broker 1
2025-05-06 09:51:03,454 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 09:51:03,454 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 09:51:03,454 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 09:51:03,457 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 09:51:03,480 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:51:03,515 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 09:51:03,515 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 09:51:03,515 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 09:51:04,587 - INFO - Skipping recovery for kafka1:9092, last attempt 16.6s ago
2025-05-06 09:51:04,616 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:51:04,633 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:51:04,728 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:51:04,733 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:51:06,795 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:51:06,811 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:51:08,844 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:51:08,848 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:51:09,637 - INFO - Skipping recovery for kafka1:9092, last attempt 21.6s ago
2025-05-06 09:51:09,664 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:51:09,678 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:51:10,886 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:51:10,902 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:51:12,943 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:51:12,947 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:51:14,687 - INFO - Skipping recovery for kafka1:9092, last attempt 26.7s ago
2025-05-06 09:51:14,745 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:51:14,767 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:51:14,982 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:51:14,987 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:51:17,052 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:51:17,079 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:51:19,119 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:51:19,125 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:51:19,801 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:51:19,818 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:51:19,835 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:51:21,161 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:51:21,173 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:51:23,221 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:51:23,229 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:51:24,869 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:51:24,901 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:51:24,917 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:51:25,259 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:51:25,266 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:51:27,316 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:51:27,340 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:51:29,368 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:51:29,380 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:51:30,001 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:51:30,035 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:51:30,056 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:51:31,422 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:51:31,426 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:51:33,463 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:51:33,473 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:51:35,094 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:51:35,129 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:51:35,146 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:51:35,499 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:51:35,502 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:51:37,559 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:51:37,564 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:51:39,596 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:51:39,601 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:51:40,169 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:51:40,190 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:51:40,202 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:51:41,607 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:51:41,609 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:51:43,656 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:51:43,660 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:51:45,224 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:51:45,249 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:51:45,264 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:51:45,670 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:51:45,675 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:51:47,704 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:51:47,708 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:51:49,721 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:51:49,724 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:51:50,307 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:51:50,344 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:51:50,360 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:51:51,751 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:51:51,761 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:51:53,777 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:51:53,782 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:51:55,402 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:51:55,426 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:51:55,435 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:51:55,797 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:51:55,801 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:51:57,835 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:51:57,846 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:51:59,858 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:51:59,862 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:52:00,470 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:00,482 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:00,493 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:01,875 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:52:01,878 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:52:03,897 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:52:03,901 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:52:05,524 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:05,541 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:05,551 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:05,915 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:52:05,919 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:52:07,950 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:52:07,953 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:52:10,000 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:52:10,027 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:52:10,587 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:10,623 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:10,661 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:12,243 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:52:12,311 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:52:14,361 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:52:14,365 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:52:15,697 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:15,722 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:15,739 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:16,396 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:52:16,403 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:52:18,440 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:52:18,443 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:52:20,458 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:52:20,470 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:52:20,775 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:20,801 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:20,820 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:22,502 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:52:22,508 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:52:24,544 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:52:24,554 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:52:25,863 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:25,886 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:25,898 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:26,567 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:52:26,570 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:52:28,589 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:52:28,592 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:52:30,616 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:52:30,620 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:52:30,926 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:30,950 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:30,968 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:32,647 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:52:32,650 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:52:34,725 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:52:34,731 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:52:36,017 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:36,088 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:36,142 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:36,775 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:52:36,802 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:52:38,840 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:52:38,849 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:52:40,874 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:52:40,879 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:52:41,284 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:41,320 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:41,359 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:42,980 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:52:42,999 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:52:45,055 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:52:45,064 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:52:46,406 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:46,429 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:46,446 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:47,094 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:52:47,100 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:52:49,126 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:52:49,131 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:52:51,141 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:52:51,144 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:52:51,451 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 09:52:51,453 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 09:52:51,456 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 09:52:51,457 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 09:52:51,457 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE, mode: buffer
2025-05-06 09:52:51,473 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:51,474 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:51,491 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:51,491 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:51,495 - INFO - Using strategy buffer configuration
2025-05-06 09:52:51,502 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 09:52:51,568 - INFO - Successfully applied config to broker 2
2025-05-06 09:52:51,692 - INFO - Successfully applied config to broker 3
2025-05-06 09:52:51,836 - INFO - Successfully applied config to broker 1
2025-05-06 09:52:51,837 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 09:52:51,842 - INFO - Triggering leader election
2025-05-06 09:52:51,843 - INFO - Listing topics for leader election
2025-05-06 09:52:51,853 - INFO - Found 1 topics for leader election
2025-05-06 09:52:51,853 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 09:52:51,853 - INFO - Leader election completed in 0.01 seconds, success: False
2025-05-06 09:52:51,856 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 09:52:53,174 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:52:53,179 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:52:53,501 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:52:53,541 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:53,559 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:55,188 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:52:55,191 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:52:55,563 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:52:55,572 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:55,577 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:57,217 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:52:57,221 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:52:57,581 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:52:57,603 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:57,619 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:59,240 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:52:59,243 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:52:59,625 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:52:59,644 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:52:59,653 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:53:01,310 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:53:01,327 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:53:01,656 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:53:01,671 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:53:01,684 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:53:03,347 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:53:03,364 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:53:03,688 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:53:03,711 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:53:03,736 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:53:05,369 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:53:05,379 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:53:05,738 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:53:05,744 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:53:05,749 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:53:06,870 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 09:53:06,877 - INFO - Attempting broker recovery for kafka1
2025-05-06 09:53:06,877 - INFO - Attempting internal recovery for broker 1
2025-05-06 09:53:06,877 - INFO - Triggering internal recovery for broker 1
2025-05-06 09:53:06,923 - INFO - Found 1 partitions on broker 1
2025-05-06 09:53:06,924 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 09:53:06,924 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 09:53:06,924 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 09:53:06,940 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 09:53:07,000 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:53:07,157 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 09:53:07,158 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 09:53:07,158 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 09:53:07,410 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:53:07,415 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:53:07,754 - INFO - Skipping recovery for kafka1:9092, last attempt 16.3s ago
2025-05-06 09:53:07,858 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:53:07,917 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:53:09,543 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:53:09,555 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:53:11,571 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:53:11,578 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:53:12,925 - INFO - Skipping recovery for kafka1:9092, last attempt 21.5s ago
2025-05-06 09:53:12,948 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:53:12,971 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:53:13,602 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:53:13,606 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:53:15,620 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:53:15,624 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:53:17,638 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:53:17,641 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:53:17,979 - INFO - Skipping recovery for kafka1:9092, last attempt 26.5s ago
2025-05-06 09:53:17,997 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:53:18,006 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:53:19,651 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:53:19,654 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:53:21,678 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:53:21,684 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:53:23,035 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:53:23,057 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:53:23,073 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:53:23,695 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:53:23,699 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:53:25,719 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:53:25,722 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:53:27,732 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:53:27,737 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:53:28,096 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:53:28,104 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:53:28,124 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:53:29,848 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:53:29,858 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:53:31,888 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:53:31,895 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:53:33,192 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:53:33,242 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:53:33,265 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:53:33,923 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:53:33,929 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:53:36,011 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:53:36,025 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:53:38,059 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:53:38,075 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:53:38,302 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:53:38,337 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:53:38,353 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:53:40,109 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:53:40,126 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:53:42,197 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:53:42,237 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:53:43,391 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:53:43,425 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:53:43,441 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:53:44,273 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:53:44,277 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:53:46,318 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:53:46,324 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:53:48,362 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:53:48,368 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:53:48,474 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:53:48,502 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:53:48,532 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:53:50,398 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:53:50,402 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:53:52,438 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:53:52,448 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:53:53,559 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:53:53,591 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:53:53,606 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:53:54,476 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:53:54,480 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:53:56,522 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:53:56,527 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:53:58,618 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:53:58,702 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:53:58,751 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:53:58,853 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:53:58,889 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:54:00,729 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:54:00,736 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:54:02,767 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:54:02,777 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:54:03,925 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:54:03,952 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:54:03,985 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:54:04,810 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:54:04,816 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:54:06,856 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:54:06,873 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:54:08,908 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:54:08,918 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:54:09,019 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:54:09,042 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:54:09,064 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:54:10,941 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:54:10,945 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:54:13,003 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:54:13,040 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:54:14,110 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:54:14,141 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:54:14,168 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:54:15,075 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:54:15,085 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:54:17,127 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:54:17,137 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:54:19,212 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:54:19,227 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:54:19,251 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:54:19,284 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:54:19,307 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:54:21,263 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:54:21,276 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:54:23,316 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:54:23,322 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:54:24,340 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:54:24,368 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:54:24,380 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:54:25,349 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:54:25,354 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:54:27,392 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:54:27,408 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:54:29,424 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:54:29,453 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:54:29,464 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:54:29,464 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:54:29,484 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:54:31,496 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:54:31,501 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:54:33,544 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:54:33,548 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:54:34,524 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:54:34,557 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:54:34,569 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:54:35,554 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:54:35,566 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:54:37,600 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:54:37,607 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:54:39,602 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:54:39,615 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:54:39,620 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:54:39,620 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:54:39,631 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:54:41,628 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:54:41,633 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:54:43,646 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:54:43,650 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:54:44,661 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:54:44,677 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:54:44,692 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:54:45,657 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:54:45,660 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:54:47,723 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:54:47,779 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:54:49,733 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:54:49,754 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:54:49,767 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:54:49,794 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:54:49,796 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:54:51,803 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:54:51,807 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:54:53,836 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:54:53,839 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:54:54,776 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 09:54:54,777 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 09:54:54,778 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 09:54:54,778 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 09:54:54,781 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE, mode: buffer
2025-05-06 09:54:54,798 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:54:54,798 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:54:54,812 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:54:54,812 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:54:54,814 - INFO - Using strategy buffer configuration
2025-05-06 09:54:54,818 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 09:54:54,880 - INFO - Successfully applied config to broker 2
2025-05-06 09:54:54,969 - INFO - Successfully applied config to broker 3
2025-05-06 09:54:55,056 - INFO - Successfully applied config to broker 1
2025-05-06 09:54:55,056 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 09:54:55,057 - INFO - Triggering leader election
2025-05-06 09:54:55,061 - INFO - Listing topics for leader election
2025-05-06 09:54:55,111 - INFO - Found 1 topics for leader election
2025-05-06 09:54:55,111 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 09:54:55,119 - INFO - Leader election completed in 0.05 seconds, success: False
2025-05-06 09:54:55,849 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:54:55,855 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:54:56,153 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 09:54:56,819 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:54:56,836 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:54:56,849 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:54:57,882 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:54:57,885 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:54:58,852 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:54:58,861 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:54:58,867 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:54:59,894 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:54:59,898 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:55:00,871 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:55:00,879 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:00,883 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:01,916 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:55:01,921 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:55:02,885 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:55:02,898 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:02,912 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:03,929 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:55:03,932 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:55:04,918 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:55:04,923 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:04,929 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:05,944 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:55:05,947 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:55:06,933 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:55:06,952 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:06,970 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:07,984 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:55:07,987 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:55:08,971 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:55:08,983 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:08,988 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:09,996 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:55:10,006 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:55:10,993 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:55:11,001 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:11,007 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:11,151 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 09:55:11,151 - INFO - Attempting broker recovery for kafka1
2025-05-06 09:55:11,151 - INFO - Attempting internal recovery for broker 1
2025-05-06 09:55:11,152 - INFO - Triggering internal recovery for broker 1
2025-05-06 09:55:11,155 - INFO - Found 1 partitions on broker 1
2025-05-06 09:55:11,155 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 09:55:11,155 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 09:55:11,155 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 09:55:11,156 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 09:55:11,167 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:11,194 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 09:55:11,194 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 09:55:11,194 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 09:55:12,020 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:55:12,022 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:55:13,009 - INFO - Skipping recovery for kafka1:9092, last attempt 18.2s ago
2025-05-06 09:55:13,020 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:13,032 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:14,031 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:55:14,033 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:55:16,060 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:55:16,066 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:55:18,041 - INFO - Skipping recovery for kafka1:9092, last attempt 23.3s ago
2025-05-06 09:55:18,070 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:18,090 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:55:18,091 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:18,095 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:55:20,102 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:55:20,104 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:55:22,140 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:55:22,146 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:55:23,101 - INFO - Skipping recovery for kafka1:9092, last attempt 28.3s ago
2025-05-06 09:55:23,122 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:23,133 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:24,156 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:55:24,161 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:55:26,184 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:55:26,194 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:55:28,160 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:28,178 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:28,194 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:28,208 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:55:28,211 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:55:30,222 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:55:30,225 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:55:32,237 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:55:32,241 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:55:33,207 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:33,222 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:33,231 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:34,262 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:55:34,266 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:55:36,277 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:55:36,281 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:55:38,261 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:38,282 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:38,307 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:38,325 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:55:38,329 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:55:40,346 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:55:40,361 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:55:42,398 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:55:42,404 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:55:43,329 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:43,343 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:43,352 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:44,412 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:55:44,415 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:55:46,447 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:55:46,451 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:55:48,390 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:48,405 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:48,417 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:48,460 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:55:48,462 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:55:50,492 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:55:50,497 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:55:52,509 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:55:52,512 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:55:53,444 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:53,466 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:53,480 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:54,534 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:55:54,543 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:55:56,561 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:55:56,569 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:55:58,516 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:58,529 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:58,542 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:55:58,576 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:55:58,578 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:56:00,586 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:56:00,589 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:56:02,622 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:56:02,628 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:56:03,567 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:56:03,587 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:56:03,603 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:56:04,665 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:56:04,669 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:56:06,676 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:56:06,680 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:56:08,641 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:56:08,651 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:56:08,669 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:56:08,692 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:56:08,696 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:56:10,703 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:56:10,708 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:56:12,744 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:56:12,748 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:56:13,691 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:56:13,713 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:56:13,726 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:56:14,757 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:56:14,759 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:56:16,790 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:56:16,799 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:56:18,762 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:56:18,774 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:56:18,785 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:56:18,807 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:56:18,809 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:56:20,853 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:56:20,860 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:56:22,890 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:56:22,900 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:56:23,819 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:56:23,855 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:56:23,873 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:56:24,950 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:56:24,973 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:56:27,041 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:56:27,049 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:56:28,911 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:56:28,931 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:56:28,943 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:56:29,082 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:56:29,086 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:56:31,141 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:56:31,160 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:56:33,190 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:56:33,197 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:56:33,975 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:56:33,993 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:56:34,011 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:56:35,222 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:56:35,244 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:56:37,271 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:56:37,274 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:56:39,031 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:56:39,048 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:56:39,061 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:56:39,295 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:56:39,299 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:56:41,334 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:56:41,353 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:56:43,383 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:56:43,387 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:56:44,094 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:56:44,118 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:56:44,147 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:56:45,423 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:56:45,436 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:56:47,480 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:56:47,487 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:56:49,179 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:56:49,205 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:56:49,222 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:56:49,514 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:56:49,518 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:56:51,562 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:56:51,568 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:56:53,606 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:56:53,613 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:56:54,259 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:56:54,295 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:56:54,310 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:56:55,668 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:56:55,689 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:56:57,713 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:56:57,717 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:56:59,322 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 09:56:59,326 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 09:56:59,333 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 09:56:59,335 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 09:56:59,335 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE, mode: buffer
2025-05-06 09:56:59,352 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:56:59,353 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:56:59,381 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:56:59,382 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:56:59,385 - INFO - Using strategy buffer configuration
2025-05-06 09:56:59,391 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 09:56:59,452 - INFO - Successfully applied config to broker 2
2025-05-06 09:56:59,510 - INFO - Successfully applied config to broker 3
2025-05-06 09:56:59,618 - INFO - Successfully applied config to broker 1
2025-05-06 09:56:59,618 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 09:56:59,623 - INFO - Triggering leader election
2025-05-06 09:56:59,624 - INFO - Listing topics for leader election
2025-05-06 09:56:59,632 - INFO - Found 1 topics for leader election
2025-05-06 09:56:59,633 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 09:56:59,633 - INFO - Leader election completed in 0.01 seconds, success: False
2025-05-06 09:56:59,639 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 09:56:59,828 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:56:59,863 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:57:01,411 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:57:01,625 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:57:01,667 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:57:01,895 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:57:01,900 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:57:03,673 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:57:03,700 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:57:03,724 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:57:03,925 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:57:03,929 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:57:05,735 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:57:05,783 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:57:05,806 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:57:05,945 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:57:05,949 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:57:07,811 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:57:07,902 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:57:07,932 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:57:07,997 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:57:08,001 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:57:09,939 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:57:09,980 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:57:10,016 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:57:10,038 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:57:10,054 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:57:12,021 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:57:12,058 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:57:12,101 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:57:12,114 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:57:12,117 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:57:14,105 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 09:57:14,150 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:57:14,152 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:57:14,159 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:57:14,170 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:57:14,643 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 09:57:14,643 - INFO - Attempting broker recovery for kafka1
2025-05-06 09:57:14,644 - INFO - Attempting internal recovery for broker 1
2025-05-06 09:57:14,644 - INFO - Triggering internal recovery for broker 1
2025-05-06 09:57:14,648 - INFO - Found 1 partitions on broker 1
2025-05-06 09:57:14,649 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 09:57:14,649 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 09:57:14,649 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 09:57:14,650 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 09:57:14,669 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:57:14,708 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 09:57:14,708 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 09:57:14,708 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 09:57:16,188 - INFO - Skipping recovery for kafka1:9092, last attempt 16.9s ago
2025-05-06 09:57:16,222 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:57:16,232 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:57:16,233 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:57:16,254 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:57:18,264 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:57:18,278 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:57:20,312 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:57:20,318 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:57:21,264 - INFO - Skipping recovery for kafka1:9092, last attempt 21.9s ago
2025-05-06 09:57:21,296 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:57:21,325 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:57:22,349 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:57:22,352 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:57:24,385 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:57:24,398 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:57:26,332 - INFO - Skipping recovery for kafka1:9092, last attempt 27.0s ago
2025-05-06 09:57:26,359 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:57:26,379 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:57:26,425 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:57:26,430 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:57:28,473 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:57:28,480 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:57:30,502 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:57:30,506 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:57:31,399 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:57:31,432 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:57:31,461 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:57:32,529 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:57:32,532 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:57:34,572 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:57:34,580 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:57:36,508 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:57:36,532 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:57:36,557 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:57:36,606 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:57:36,610 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:57:38,641 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:57:38,644 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:57:40,661 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:57:40,666 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:57:41,602 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:57:41,632 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:57:41,647 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:57:42,719 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:57:42,746 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:57:44,778 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:57:44,791 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:57:46,676 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:57:46,698 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:57:46,711 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:57:46,812 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:57:46,816 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:57:48,842 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:57:48,846 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:57:50,871 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:57:50,881 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:57:51,743 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:57:51,769 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:57:51,794 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:57:52,909 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:57:52,913 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:57:54,938 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:57:54,962 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:57:56,826 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:57:56,849 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:57:56,877 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:57:57,014 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:57:57,019 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:57:59,106 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:57:59,118 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:58:01,147 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:58:01,153 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:58:01,916 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:58:01,981 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:58:02,012 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:58:03,238 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:58:03,253 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:58:05,286 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:58:05,298 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:58:07,070 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:58:07,110 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:58:07,140 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:58:07,338 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:58:07,343 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:58:09,372 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:58:09,387 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:58:11,433 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:58:11,443 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:58:12,188 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:58:12,247 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:58:12,295 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:58:13,522 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:58:13,535 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:58:15,575 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:58:15,590 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:58:17,380 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:58:17,477 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:58:17,505 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:58:17,659 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:58:17,669 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:58:19,714 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:58:19,739 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:58:21,833 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:58:21,887 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:58:22,669 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:58:22,774 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:58:22,868 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:58:23,947 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:58:23,979 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:58:26,070 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:58:26,109 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:58:27,922 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:58:28,012 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:58:28,037 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:58:28,180 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:58:28,189 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:58:30,211 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:58:30,215 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:58:32,249 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:58:32,260 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:58:33,107 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:58:33,175 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:58:33,223 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:58:34,290 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:58:34,308 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:58:36,341 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:58:36,371 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:58:38,244 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:58:38,265 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:58:38,285 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:58:38,396 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:58:38,402 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:58:40,422 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:58:40,437 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:58:42,476 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:58:42,492 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:58:43,310 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:58:43,352 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:58:43,379 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:58:44,518 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:58:44,523 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:58:46,609 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:58:46,687 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:58:48,469 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:58:48,505 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:58:48,568 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:58:48,727 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:58:48,762 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:58:50,797 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:58:50,880 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:58:52,914 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:58:52,926 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:58:53,619 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:58:53,755 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:58:53,856 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:58:54,970 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:58:55,011 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:58:57,058 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:58:57,096 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:58:58,918 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 09:58:58,966 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:58:59,000 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:58:59,164 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:58:59,192 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:59:01,236 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:59:01,270 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:59:03,358 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:59:03,365 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 09:59:04,005 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 09:59:04,006 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 09:59:04,015 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 09:59:04,016 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 09:59:04,016 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE, mode: buffer
2025-05-06 09:59:04,066 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:59:04,078 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 09:59:04,099 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:59:04,099 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 09:59:04,103 - INFO - Using strategy buffer configuration
2025-05-06 09:59:04,115 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 09:59:04,484 - INFO - Successfully applied config to broker 2
2025-05-06 09:59:04,662 - INFO - Successfully applied config to broker 3
2025-05-06 09:59:04,878 - INFO - Successfully applied config to broker 1
2025-05-06 09:59:04,878 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 09:59:04,889 - INFO - Triggering leader election
2025-05-06 09:59:04,891 - INFO - Listing topics for leader election
2025-05-06 09:59:04,911 - INFO - Found 1 topics for leader election
2025-05-06 09:59:04,911 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 09:59:04,912 - INFO - Leader election completed in 0.02 seconds, success: False
2025-05-06 09:59:04,918 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 09:59:05,398 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 09:59:05,404 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:01:07,428 - INFO - PRIMARY KAFKA BROKERS (for monitoring): ['kafka1:9092', 'kafka2:9093', 'kafka3:9094']
2025-05-06 10:01:07,431 - INFO - Container names: ['kafka1', 'kafka2', 'kafka3']
2025-05-06 10:01:07,431 - INFO - Alternative addresses (for connection attempts ONLY): ['kafka1:29092', 'kafka2:29093', 'kafka3:29094']
2025-05-06 10:01:07,431 - INFO - Starting Kafka Arms Controller
2025-05-06 10:01:07,434 - INFO - Started Prometheus metrics server on port 8002
2025-05-06 10:01:07,444 - INFO - Loaded strategy buffer: QUICK_REBALANCE
2025-05-06 10:01:07,485 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:01:07,488 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:01:09,507 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:01:09,520 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:01:11,438 - INFO - Monitoring these brokers ONLY: ['kafka1:9092', 'kafka2:9093', 'kafka3:9094']
2025-05-06 10:01:11,440 - INFO - TEST MODE ENABLED - Will simulate failures for kafka1:9092 every 120 seconds
2025-05-06 10:01:11,440 - INFO - Test mode initialized, broker kafka1:9092 will be tested on next check
2025-05-06 10:01:11,440 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 10:01:11,441 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 10:01:11,449 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 10:01:11,450 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 10:01:11,450 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: CONTROLLED_GRADUAL, mode: buffer
2025-05-06 10:01:11,555 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:01:11,559 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:01:13,568 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:01:13,573 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:01:15,701 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:01:15,719 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:01:17,758 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:01:17,773 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:01:19,984 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:01:19,990 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:01:20,316 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:01:20,328 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:01:20,398 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:01:20,404 - INFO - Using strategy buffer configuration
2025-05-06 10:01:20,436 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 10:01:20,724 - INFO - Successfully applied config to broker 2
2025-05-06 10:01:21,332 - INFO - Successfully applied config to broker 3
2025-05-06 10:01:21,413 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:01:21,516 - INFO - Successfully applied config to broker 1
2025-05-06 10:01:21,524 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 10:01:21,540 - INFO - Triggering leader election
2025-05-06 10:01:21,544 - INFO - Listing topics for leader election
2025-05-06 10:01:21,579 - WARNING - No topics found for leader election
2025-05-06 10:01:21,583 - WARNING - Leader election not completely successful, but continuing recovery
2025-05-06 10:01:21,584 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 10:01:22,049 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:01:22,106 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:01:23,421 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:01:23,495 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:01:23,614 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:01:24,149 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:01:24,220 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:01:25,622 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:01:25,726 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:01:25,882 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:01:26,306 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:01:26,368 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:03:37,796 - INFO - PRIMARY KAFKA BROKERS (for monitoring): ['kafka1:9092', 'kafka2:9093', 'kafka3:9094']
2025-05-06 10:03:37,797 - INFO - Container names: ['kafka1', 'kafka2', 'kafka3']
2025-05-06 10:03:37,798 - INFO - Alternative addresses (for connection attempts ONLY): ['kafka1:29092', 'kafka2:29093', 'kafka3:29094']
2025-05-06 10:03:37,798 - INFO - Starting Kafka Arms Controller
2025-05-06 10:03:37,811 - INFO - Successfully registered all initial metrics
2025-05-06 10:03:37,819 - INFO - Started Prometheus metrics server on port 8002
2025-05-06 10:03:37,840 - INFO - Loaded strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:03:37,910 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:03:37,962 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:03:40,019 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:03:40,029 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:03:41,827 - INFO - Monitoring these brokers ONLY: ['kafka1:9092', 'kafka2:9093', 'kafka3:9094']
2025-05-06 10:03:41,828 - INFO - TEST MODE ENABLED - Will simulate failures for kafka1:9092 every 120 seconds
2025-05-06 10:03:41,828 - INFO - Test mode initialized, broker kafka1:9092 will be tested on next check
2025-05-06 10:03:41,828 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 10:03:41,828 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 10:03:41,829 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 10:03:41,830 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 10:03:41,830 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: CONTROLLED_GRADUAL, mode: buffer
2025-05-06 10:03:42,051 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:03:42,061 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:03:44,095 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:03:44,112 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:03:46,130 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:03:46,138 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:03:48,169 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:03:48,177 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:03:50,220 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:03:50,263 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:03:51,852 - WARNING - Broker kafka2:9093 availability check failed: KafkaError{code=_TRANSPORT,val=-195,str="Failed to get metadata: Local: Broker transport failure"}
2025-05-06 10:03:51,856 - WARNING - Broker kafka2:9093 availability check failed: KafkaError{code=_TRANSPORT,val=-195,str="Failed to get metadata: Local: Broker transport failure"}
2025-05-06 10:03:52,273 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:03:52,279 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:03:52,604 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 1]
2025-05-06 10:03:52,623 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 1]
2025-05-06 10:03:54,388 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:03:54,482 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:03:54,848 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:03:54,875 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:03:54,898 - INFO - Using strategy buffer configuration
2025-05-06 10:03:55,216 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 10:03:55,937 - INFO - Successfully applied config to broker 2
2025-05-06 10:03:56,523 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:03:56,562 - INFO - Successfully applied config to broker 3
2025-05-06 10:03:56,570 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:03:56,845 - INFO - Successfully applied config to broker 1
2025-05-06 10:03:56,846 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 10:03:56,849 - INFO - Triggering leader election
2025-05-06 10:03:56,863 - INFO - Listing topics for leader election
2025-05-06 10:03:56,863 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:03:56,947 - INFO - Found 1 topics for leader election
2025-05-06 10:03:56,949 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:03:56,951 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 10:03:56,953 - INFO - Leader election completed in 0.09 seconds, success: False
2025-05-06 10:03:56,962 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 10:03:57,010 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:03:58,590 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:03:58,602 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:04:00,015 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:04:00,150 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:00,314 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:00,628 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:04:00,669 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:04:02,372 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:04:02,492 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:02,516 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:02,695 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:04:02,702 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:04:04,531 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:04:04,610 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:04,655 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:04,725 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:04:04,728 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:04:06,670 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:04:06,698 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:06,721 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:06,752 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:04:06,757 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:04:08,724 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:04:08,750 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:08,783 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:08,790 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:04:08,799 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:04:10,797 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:04:10,951 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:11,093 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:04:11,179 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:04:11,181 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:12,004 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 10:04:12,019 - INFO - Attempting broker recovery for kafka1
2025-05-06 10:04:12,020 - INFO - Attempting internal recovery for broker 1
2025-05-06 10:04:12,020 - INFO - Triggering internal recovery for broker 1
2025-05-06 10:04:12,169 - INFO - Found 1 partitions on broker 1
2025-05-06 10:04:12,170 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 10:04:12,170 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 10:04:12,170 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 10:04:12,175 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 10:04:12,247 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:12,404 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 10:04:12,405 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 10:04:12,405 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 10:04:13,221 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:04:13,222 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:13,242 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:04:13,254 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:13,273 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:15,279 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:04:15,283 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:04:17,308 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:04:17,348 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:04:18,305 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:18,324 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:18,350 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:19,366 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:04:19,373 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:04:21,396 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:04:21,408 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:04:23,385 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:23,398 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:23,416 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:23,418 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:04:23,421 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:04:25,457 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:04:25,469 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:04:27,491 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:04:27,494 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:04:28,441 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:28,453 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:28,464 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:29,507 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:04:29,510 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:04:31,529 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:04:31,534 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:04:33,501 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:33,550 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:33,584 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:04:33,587 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:33,609 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:04:35,625 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:04:35,636 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:04:37,661 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:04:37,665 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:04:38,621 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:38,639 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:38,655 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:39,690 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:04:39,694 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:04:41,711 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:04:41,718 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:04:43,686 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:43,700 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:43,713 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:43,726 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:04:43,734 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:04:45,769 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:04:45,773 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:04:47,815 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:04:47,823 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:04:48,736 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:48,752 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:48,762 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:49,886 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:04:49,892 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:04:51,906 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:04:51,910 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:04:53,783 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:53,798 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:53,819 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:53,933 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:04:53,935 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:04:55,943 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:04:55,954 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:04:57,994 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:04:58,001 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:04:58,842 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:58,855 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:04:58,872 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:00,021 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:05:00,028 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:05:02,042 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:05:02,046 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:05:03,886 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:03,904 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:03,927 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:04,070 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:05:04,077 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:05:06,083 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:05:06,086 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:05:08,125 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:05:08,129 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:05:08,962 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:08,976 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:08,989 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:10,161 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:05:10,165 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:05:12,176 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:05:12,179 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:05:14,008 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:14,020 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:14,040 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:14,204 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:05:14,207 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:05:16,219 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:05:16,224 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:05:18,263 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:05:18,270 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:05:19,074 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:19,090 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:19,098 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:20,314 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:05:20,324 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:05:22,339 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:05:22,342 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:05:24,123 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:24,150 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:24,179 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:24,367 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:05:24,370 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:05:26,395 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:05:26,398 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:05:28,409 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:05:28,416 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:05:29,208 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:29,222 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:29,233 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:30,434 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:05:30,442 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:05:32,461 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:05:32,465 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:05:34,264 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:34,285 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:34,304 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:34,487 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:05:34,490 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:05:36,499 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:05:36,503 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:05:38,546 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:05:38,556 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:05:39,336 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:39,350 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:39,364 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:40,587 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:05:40,591 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:05:42,600 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:05:42,604 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:05:44,369 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 10:05:44,372 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 10:05:44,373 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 10:05:44,374 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 10:05:44,377 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE, mode: buffer
2025-05-06 10:05:44,417 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:44,418 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:44,440 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:44,441 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:44,453 - INFO - Using strategy buffer configuration
2025-05-06 10:05:44,458 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 10:05:44,516 - INFO - Successfully applied config to broker 2
2025-05-06 10:05:44,582 - INFO - Successfully applied config to broker 3
2025-05-06 10:05:44,667 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:05:44,673 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:05:44,705 - INFO - Successfully applied config to broker 1
2025-05-06 10:05:44,707 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 10:05:44,752 - INFO - Triggering leader election
2025-05-06 10:05:44,759 - INFO - Listing topics for leader election
2025-05-06 10:05:44,792 - INFO - Found 1 topics for leader election
2025-05-06 10:05:44,793 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 10:05:44,794 - INFO - Leader election completed in 0.03 seconds, success: False
2025-05-06 10:05:44,796 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 10:05:46,447 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:05:46,477 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:46,489 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:46,706 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:05:46,711 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:05:48,495 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:05:48,523 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:48,536 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:48,725 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:05:48,729 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:05:50,540 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:05:50,547 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:50,562 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:50,740 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:05:50,743 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:05:52,566 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:05:52,582 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:52,595 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:52,765 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:05:52,772 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:05:54,606 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:05:54,625 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:54,637 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:54,785 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:05:54,787 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:05:56,647 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:05:56,655 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:56,662 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:56,804 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:05:56,809 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:05:58,668 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:05:58,708 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:58,723 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:05:58,828 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:05:58,832 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:05:59,811 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 10:05:59,815 - INFO - Attempting broker recovery for kafka1
2025-05-06 10:05:59,815 - INFO - Attempting internal recovery for broker 1
2025-05-06 10:05:59,815 - INFO - Triggering internal recovery for broker 1
2025-05-06 10:05:59,938 - INFO - Found 1 partitions on broker 1
2025-05-06 10:05:59,938 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 10:05:59,938 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 10:05:59,938 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 10:05:59,943 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 10:06:00,028 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:06:00,165 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 10:06:00,165 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 10:06:00,166 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 10:06:00,716 - INFO - Skipping recovery for kafka1:9092, last attempt 16.3s ago
2025-05-06 10:06:00,733 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:06:00,745 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:06:00,829 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:06:00,832 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:06:02,857 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:06:02,863 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:06:05,006 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:06:05,022 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:06:05,754 - INFO - Skipping recovery for kafka1:9092, last attempt 21.4s ago
2025-05-06 10:06:05,785 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:06:05,927 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:06:07,062 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:06:07,067 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:06:09,082 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:06:09,084 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:06:10,932 - INFO - Skipping recovery for kafka1:9092, last attempt 26.6s ago
2025-05-06 10:06:10,953 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:06:10,972 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:06:11,107 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:06:11,110 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:06:13,143 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:06:13,151 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:06:15,169 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:06:15,176 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:06:15,999 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:06:16,018 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:06:16,051 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:06:17,199 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:06:17,203 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:06:19,227 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:06:19,232 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:06:21,079 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:06:21,092 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:06:21,122 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:06:21,256 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:06:21,258 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:06:23,269 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:06:23,272 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:06:25,285 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:06:25,290 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:06:26,138 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:06:26,149 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:06:26,164 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:06:27,303 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:06:27,306 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:06:29,321 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:06:29,323 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:06:31,204 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:06:31,220 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:06:31,240 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:06:31,345 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:06:31,348 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:06:33,379 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:06:33,383 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:06:35,399 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:06:35,411 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:06:36,262 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:06:36,278 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:06:36,297 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:06:37,440 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:06:37,443 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:06:39,452 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:06:39,454 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:06:41,332 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:06:41,348 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:06:41,368 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:06:41,487 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:06:41,490 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:06:43,507 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:06:43,512 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:06:45,549 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:06:45,553 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:06:46,389 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:06:46,406 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:06:46,430 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:06:47,568 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:06:47,571 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:06:49,635 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:06:49,648 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:06:51,466 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:06:51,487 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:06:51,500 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:06:51,663 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:06:51,665 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:06:53,671 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:06:53,673 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:06:55,695 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:06:55,699 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:06:56,537 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:06:56,566 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:06:56,591 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:06:57,720 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:06:57,743 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:06:59,779 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:06:59,784 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:07:01,627 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:01,649 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:01,691 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:01,796 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:07:01,799 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:07:03,807 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:07:03,811 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:07:05,833 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:07:05,838 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:07:06,721 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:06,748 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:06,765 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:07,863 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:07:07,879 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:07:09,918 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:07:09,922 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:07:11,800 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:11,822 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:11,842 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:11,958 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:07:11,982 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:07:14,001 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:07:14,008 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:07:16,030 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:07:16,040 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:07:16,886 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:16,904 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:16,939 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:18,056 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:07:18,058 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:07:20,073 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:07:20,075 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:07:21,969 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:21,983 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:22,005 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:22,082 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:07:22,084 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:07:24,101 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:07:24,105 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:07:26,125 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:07:26,127 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:07:27,032 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:27,049 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:27,065 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:28,141 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:07:28,150 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:07:30,170 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:07:30,176 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:07:32,101 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:32,185 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:32,232 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:07:32,255 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:07:32,261 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:34,283 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:07:34,286 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:07:36,296 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:07:36,298 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:07:37,296 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:37,310 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:37,329 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:38,328 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:07:38,331 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:07:40,364 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:07:40,376 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:07:42,362 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:42,390 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:42,400 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:07:42,404 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:07:42,408 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:44,414 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:07:44,416 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:07:46,432 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:07:46,436 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:07:47,415 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 10:07:47,417 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 10:07:47,418 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 10:07:47,424 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 10:07:47,424 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE, mode: buffer
2025-05-06 10:07:47,452 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:47,452 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:47,475 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:47,475 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:47,479 - INFO - Using strategy buffer configuration
2025-05-06 10:07:47,484 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 10:07:47,566 - INFO - Successfully applied config to broker 2
2025-05-06 10:07:47,629 - INFO - Successfully applied config to broker 3
2025-05-06 10:07:47,703 - INFO - Successfully applied config to broker 1
2025-05-06 10:07:47,704 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 10:07:47,706 - INFO - Triggering leader election
2025-05-06 10:07:47,709 - INFO - Listing topics for leader election
2025-05-06 10:07:47,720 - INFO - Found 1 topics for leader election
2025-05-06 10:07:47,720 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 10:07:47,720 - INFO - Leader election completed in 0.01 seconds, success: False
2025-05-06 10:07:47,727 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 10:07:48,443 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:07:48,445 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:07:49,479 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:07:49,504 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:49,605 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:50,467 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:07:50,471 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:07:51,613 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:07:51,629 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:51,644 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:52,479 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:07:52,482 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:07:53,647 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:07:53,653 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:53,664 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:54,489 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:07:54,491 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:07:55,671 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:07:55,679 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:55,689 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:56,506 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:07:56,509 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:07:57,695 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:07:57,734 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:57,750 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:58,520 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:07:58,523 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:07:59,753 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:07:59,797 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:07:59,822 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:08:00,538 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:08:00,541 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:08:01,826 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:08:01,839 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:08:01,851 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:08:02,553 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:08:02,556 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:08:02,728 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 10:08:02,728 - INFO - Attempting broker recovery for kafka1
2025-05-06 10:08:02,728 - INFO - Attempting internal recovery for broker 1
2025-05-06 10:08:02,729 - INFO - Triggering internal recovery for broker 1
2025-05-06 10:08:02,734 - INFO - Found 1 partitions on broker 1
2025-05-06 10:08:02,734 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 10:08:02,734 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 10:08:02,735 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 10:08:02,736 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 10:08:02,755 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:08:02,778 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 10:08:02,778 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 10:08:02,778 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 10:08:03,852 - INFO - Skipping recovery for kafka1:9092, last attempt 16.4s ago
2025-05-06 10:08:03,856 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:08:03,862 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:08:04,584 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:08:04,588 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:08:06,603 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:08:06,607 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:08:08,611 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:08:08,613 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:08:08,870 - INFO - Skipping recovery for kafka1:9092, last attempt 21.5s ago
2025-05-06 10:08:08,906 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:08:08,945 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:08:10,646 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:08:10,650 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:08:12,662 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:08:12,664 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:08:14,701 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:08:14,713 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:08:14,957 - INFO - Skipping recovery for kafka1:9092, last attempt 27.5s ago
2025-05-06 10:08:15,019 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:08:15,063 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:08:16,748 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:08:16,756 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:08:18,764 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:08:18,767 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:08:20,108 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:08:20,137 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:08:20,164 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:08:20,785 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:08:20,787 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:08:22,801 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:08:22,807 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:08:24,838 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:08:24,854 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:08:25,191 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:08:25,216 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:08:25,238 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:08:26,863 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:08:26,866 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:08:28,891 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:08:28,894 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:08:30,264 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:08:30,280 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:08:30,298 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:08:30,907 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:08:30,922 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:08:32,944 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:08:32,959 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:08:34,987 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:08:34,989 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:08:35,339 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:08:35,354 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:08:35,399 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:08:36,998 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:08:37,001 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:08:39,026 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:08:39,043 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:08:40,434 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:08:40,450 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:08:40,468 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:08:41,062 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:08:41,065 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:08:43,084 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:08:43,087 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:08:45,102 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:08:45,105 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:08:45,493 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:08:45,511 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:08:45,535 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:08:47,114 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:08:47,119 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:08:49,140 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:08:49,149 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:08:50,567 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:08:50,580 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:08:50,594 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:08:51,164 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:08:51,167 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:08:53,182 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:08:53,185 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:08:55,209 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:08:55,216 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:08:55,617 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:08:55,640 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:08:55,659 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:08:57,230 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:08:57,234 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:08:59,255 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:08:59,263 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:09:00,700 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:00,716 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:00,731 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:01,279 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:09:01,283 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:09:03,304 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:09:03,308 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:09:05,350 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:09:05,354 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:09:05,764 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:05,779 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:05,799 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:07,370 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:09:07,373 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:09:09,400 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:09:09,403 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:09:10,829 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:10,866 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:10,895 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:11,424 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:09:11,440 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:09:13,486 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:09:13,517 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:09:15,549 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:09:15,555 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:09:15,926 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:15,947 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:15,974 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:17,595 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:09:17,599 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:09:19,647 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:09:19,657 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:09:21,002 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:21,016 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:21,026 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:21,670 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:09:21,673 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:09:23,705 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:09:23,708 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:09:25,720 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:09:25,723 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:09:26,055 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:26,069 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:26,101 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:27,746 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:09:27,749 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:09:29,757 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:09:29,760 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:09:31,139 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:31,149 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:31,173 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:31,778 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:09:31,781 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:09:33,789 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:09:33,792 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:09:35,823 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:09:35,829 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:09:36,200 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:36,217 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:36,234 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:37,841 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:09:37,844 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:09:39,875 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:09:39,880 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:09:41,280 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:41,299 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:41,329 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:41,886 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:09:41,889 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:09:43,903 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:09:43,907 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:09:45,916 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:09:45,921 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:09:46,359 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:46,374 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:46,413 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:47,942 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:09:47,945 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:09:49,956 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:09:49,958 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:09:51,418 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 10:09:51,419 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 10:09:51,420 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 10:09:51,435 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 10:09:51,438 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE, mode: buffer
2025-05-06 10:09:51,489 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:51,491 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:51,632 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:51,632 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:51,641 - INFO - Using strategy buffer configuration
2025-05-06 10:09:51,649 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 10:09:51,761 - INFO - Successfully applied config to broker 2
2025-05-06 10:09:52,053 - INFO - Successfully applied config to broker 3
2025-05-06 10:09:52,197 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:09:52,223 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:09:52,314 - INFO - Successfully applied config to broker 1
2025-05-06 10:09:52,314 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 10:09:52,338 - INFO - Triggering leader election
2025-05-06 10:09:52,349 - INFO - Listing topics for leader election
2025-05-06 10:09:52,365 - INFO - Found 1 topics for leader election
2025-05-06 10:09:52,366 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 10:09:52,366 - INFO - Leader election completed in 0.02 seconds, success: False
2025-05-06 10:09:52,368 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 10:09:53,648 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:09:53,681 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:53,711 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:54,284 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:09:54,313 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:09:55,722 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:09:55,757 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:55,780 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:56,335 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:09:56,339 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:09:57,782 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:09:57,790 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:57,799 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:58,350 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:09:58,353 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:09:59,803 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:09:59,826 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:09:59,846 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:10:00,365 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:10:00,369 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:10:01,852 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:10:01,868 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:10:01,883 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:10:02,388 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:10:02,391 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:10:03,885 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:10:03,889 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:10:03,894 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:10:04,408 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:10:04,418 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:10:05,901 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:10:05,925 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:10:05,945 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:10:06,437 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:10:06,440 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:10:07,382 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 10:10:07,383 - INFO - Attempting broker recovery for kafka1
2025-05-06 10:10:07,383 - INFO - Attempting internal recovery for broker 1
2025-05-06 10:10:07,383 - INFO - Triggering internal recovery for broker 1
2025-05-06 10:10:07,388 - INFO - Found 1 partitions on broker 1
2025-05-06 10:10:07,388 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 10:10:07,388 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 10:10:07,388 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 10:10:07,390 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 10:10:07,405 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:10:07,431 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 10:10:07,431 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 10:10:07,431 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 10:10:07,948 - INFO - Skipping recovery for kafka1:9092, last attempt 16.5s ago
2025-05-06 10:10:07,958 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:10:07,964 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:10:08,447 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:10:08,449 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:10:10,479 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:10:10,489 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:10:12,525 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:10:12,539 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:10:12,971 - INFO - Skipping recovery for kafka1:9092, last attempt 21.6s ago
2025-05-06 10:10:12,986 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:10:12,994 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:10:14,554 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:10:14,575 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:10:16,599 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:10:16,604 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:10:18,005 - INFO - Skipping recovery for kafka1:9092, last attempt 26.6s ago
2025-05-06 10:10:18,025 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:10:18,061 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:10:18,619 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:10:18,624 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:10:20,658 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:10:20,663 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:10:22,691 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:10:22,696 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:10:23,094 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:10:23,118 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:10:23,141 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:10:24,713 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:10:24,730 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:10:26,737 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:10:26,739 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:10:28,167 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:10:28,186 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:10:28,205 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:10:28,759 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:10:28,763 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:10:30,773 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:10:30,776 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:10:32,788 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:10:32,792 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:10:33,230 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:10:33,239 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:10:33,251 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:10:34,816 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:10:34,828 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:10:36,846 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:10:36,855 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:10:38,279 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:10:38,289 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:10:38,310 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:10:38,870 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:10:38,872 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:10:40,883 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:10:40,890 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:10:42,899 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:10:42,902 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:10:43,333 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:10:43,340 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:10:43,356 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:10:44,943 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:10:44,948 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:10:46,982 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:10:46,993 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:10:48,385 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:10:48,400 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:10:48,421 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:10:49,006 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:10:49,009 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:10:51,042 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:10:51,058 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:10:53,076 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:10:53,085 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:10:53,447 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:10:53,463 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:10:53,486 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:10:55,107 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:10:55,112 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:10:57,129 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:10:57,133 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:10:58,516 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:10:58,532 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:10:58,551 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:10:59,143 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:10:59,154 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:11:01,183 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:11:01,189 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:11:03,207 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:11:03,210 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:11:03,571 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:11:03,581 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:11:03,597 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:11:05,229 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:11:05,231 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:11:07,265 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:11:07,269 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:11:08,656 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:11:08,730 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:11:08,795 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:11:09,287 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:11:09,298 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:11:11,314 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:11:11,318 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:11:13,325 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:11:13,327 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:11:13,847 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:11:13,856 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:11:13,877 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:11:15,346 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:11:15,349 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:11:17,376 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:11:17,388 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:11:18,906 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:11:18,938 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:11:18,959 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:11:19,414 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:11:19,419 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:11:21,442 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:11:21,447 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:11:23,453 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:11:23,456 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:11:23,972 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:11:23,980 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:11:24,007 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:11:25,468 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:11:25,474 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:11:27,487 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:11:27,492 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:11:29,052 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:11:29,074 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:11:29,090 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:11:29,515 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:11:29,522 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:11:31,556 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:11:31,561 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:11:33,578 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:11:33,582 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:11:34,105 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:11:34,121 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:11:34,147 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:11:35,604 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:11:35,607 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:11:37,623 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:11:37,627 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:11:39,192 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:11:39,212 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:11:39,231 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:11:39,661 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:11:39,676 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:11:41,689 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:11:41,693 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:11:43,719 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:11:43,721 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:11:44,255 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:11:44,288 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:11:44,318 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:11:45,754 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:11:45,761 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:11:47,770 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:11:47,773 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:11:49,342 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:11:49,359 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:11:49,370 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:11:49,795 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:11:49,799 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:11:51,847 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:11:51,862 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:11:53,889 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:11:53,895 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:11:54,373 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 10:11:54,374 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 10:11:54,375 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 10:11:54,375 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 10:11:54,375 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE, mode: buffer
2025-05-06 10:11:54,396 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:11:54,397 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:11:54,421 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:11:54,421 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:11:54,424 - INFO - Using strategy buffer configuration
2025-05-06 10:11:54,430 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 10:11:54,493 - INFO - Successfully applied config to broker 2
2025-05-06 10:11:54,774 - INFO - Successfully applied config to broker 3
2025-05-06 10:11:55,354 - INFO - Successfully applied config to broker 1
2025-05-06 10:11:55,356 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 10:11:55,401 - INFO - Triggering leader election
2025-05-06 10:11:55,417 - INFO - Listing topics for leader election
2025-05-06 10:11:55,455 - INFO - Found 1 topics for leader election
2025-05-06 10:11:55,456 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 10:11:55,457 - INFO - Leader election completed in 0.04 seconds, success: False
2025-05-06 10:11:55,467 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 10:11:56,052 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:11:56,074 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:11:56,427 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:11:56,697 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:11:56,734 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:11:58,114 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:11:58,129 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:11:58,739 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:11:58,755 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:11:58,777 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:12:00,224 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:12:00,235 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:12:00,785 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:12:00,797 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:12:00,812 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:12:02,325 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:12:02,408 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:12:02,816 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:12:02,837 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:12:02,866 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:12:04,434 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:12:04,442 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:12:04,872 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:12:04,880 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:12:04,892 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:12:06,449 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:12:06,452 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:12:06,897 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:12:06,911 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:12:06,922 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:12:08,490 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:12:08,496 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:12:08,926 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:12:08,942 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:12:08,957 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:12:10,473 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 10:12:10,479 - INFO - Attempting broker recovery for kafka1
2025-05-06 10:12:10,480 - INFO - Attempting internal recovery for broker 1
2025-05-06 10:12:10,480 - INFO - Triggering internal recovery for broker 1
2025-05-06 10:12:10,507 - INFO - Found 1 partitions on broker 1
2025-05-06 10:12:10,509 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 10:12:10,510 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 10:12:10,510 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 10:12:10,519 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 10:12:10,555 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:12:10,560 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:12:10,563 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:12:10,584 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 10:12:10,584 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 10:12:10,584 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 10:12:10,965 - INFO - Skipping recovery for kafka1:9092, last attempt 16.6s ago
2025-05-06 10:12:10,977 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:12:10,992 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:12:12,581 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:12:12,587 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:12:14,646 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:12:14,652 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:12:15,996 - INFO - Skipping recovery for kafka1:9092, last attempt 21.6s ago
2025-05-06 10:12:16,020 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:12:16,051 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:12:16,673 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:12:16,676 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:12:18,723 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:12:18,731 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:12:20,763 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:12:20,778 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:12:21,058 - INFO - Skipping recovery for kafka1:9092, last attempt 26.7s ago
2025-05-06 10:12:21,076 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:12:21,093 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:12:22,807 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:12:22,810 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:12:24,819 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:12:24,822 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:12:26,128 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:12:26,140 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:12:26,159 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:12:26,835 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:12:26,841 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:12:28,852 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:12:28,855 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:12:30,865 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:12:30,882 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:12:31,184 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:12:31,205 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:12:31,237 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:12:32,908 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:12:32,911 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:12:34,935 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:12:34,945 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:12:36,259 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:12:36,270 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:12:36,286 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:12:36,952 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:12:36,954 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:12:38,967 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:12:38,970 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:12:40,988 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:12:40,993 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:12:41,312 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:12:41,328 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:12:41,349 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:12:43,014 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:12:43,021 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:12:45,043 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:12:45,046 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:12:46,378 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:12:46,393 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:12:46,410 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:12:47,063 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:12:47,067 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:12:49,104 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:12:49,124 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:12:51,149 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:12:51,160 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:12:51,443 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:12:51,459 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:12:51,472 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:12:53,172 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:12:53,176 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:12:55,209 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:12:55,222 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:12:56,489 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:12:56,504 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:12:56,516 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:12:57,239 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:12:57,243 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:12:59,250 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:12:59,258 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:13:01,273 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:13:01,279 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:13:01,548 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:13:01,557 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:13:01,577 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:13:03,288 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:13:03,291 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:13:05,317 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:13:05,322 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:13:06,603 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:13:06,625 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:13:06,639 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:13:07,336 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:13:07,339 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:13:09,373 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:13:09,383 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:13:11,394 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:13:11,397 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:13:11,677 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:13:11,687 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:13:11,703 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:13:13,443 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:13:13,460 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:13:15,479 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:13:15,483 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:13:16,729 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:13:16,746 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:13:16,763 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:13:17,494 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:13:17,498 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:13:19,529 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:13:19,536 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:13:21,557 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:13:21,561 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:13:21,807 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:13:21,827 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:13:21,862 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:13:23,578 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:13:23,580 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:13:25,609 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:13:25,613 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:13:26,883 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:13:26,906 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:13:26,920 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:13:27,626 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:13:27,630 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:13:29,661 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:13:29,666 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:13:31,680 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:13:31,685 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:13:31,941 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:13:31,952 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:13:31,966 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:13:33,727 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:13:33,749 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:13:35,766 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:13:35,779 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:13:36,986 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:13:37,001 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:13:37,013 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:13:37,801 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:13:37,816 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:13:39,835 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:13:39,848 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:13:41,859 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:13:41,861 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:13:42,040 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:13:42,052 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:13:42,065 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:13:43,895 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:13:43,899 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:13:45,907 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:13:45,910 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:13:47,086 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:13:47,103 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:13:47,127 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:13:47,944 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:13:47,947 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:13:49,977 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:13:49,987 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:13:51,996 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:13:52,000 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:13:52,148 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:13:52,162 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:13:52,178 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:13:54,025 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:13:54,028 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:13:56,038 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:13:56,040 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:13:57,185 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 10:13:57,186 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 10:13:57,187 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 10:13:57,187 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 10:13:57,187 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE, mode: buffer
2025-05-06 10:13:57,204 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:13:57,205 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:13:57,224 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:13:57,224 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:13:57,227 - INFO - Using strategy buffer configuration
2025-05-06 10:13:57,232 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 10:13:57,278 - INFO - Successfully applied config to broker 2
2025-05-06 10:13:57,350 - INFO - Successfully applied config to broker 3
2025-05-06 10:13:57,431 - INFO - Successfully applied config to broker 1
2025-05-06 10:13:57,432 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 10:13:57,436 - INFO - Triggering leader election
2025-05-06 10:13:57,441 - INFO - Listing topics for leader election
2025-05-06 10:13:57,450 - INFO - Found 1 topics for leader election
2025-05-06 10:13:57,451 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 10:13:57,451 - INFO - Leader election completed in 0.01 seconds, success: False
2025-05-06 10:13:57,454 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 10:13:58,069 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:13:58,075 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:13:59,227 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:13:59,255 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:13:59,279 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:00,089 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:14:00,097 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:14:01,285 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:14:01,295 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:01,307 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:02,106 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:14:02,108 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:14:03,310 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:14:03,318 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:03,325 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:04,135 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:14:04,144 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:14:05,330 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:14:05,356 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:05,380 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:06,153 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:14:06,157 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:14:07,387 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:14:07,395 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:07,405 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:08,175 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:14:08,179 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:14:09,409 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:14:09,445 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:09,476 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:10,218 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:14:10,226 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:14:11,488 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:14:11,503 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:11,522 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:12,248 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:14:12,257 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:14:12,466 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 10:14:12,466 - INFO - Attempting broker recovery for kafka1
2025-05-06 10:14:12,467 - INFO - Attempting internal recovery for broker 1
2025-05-06 10:14:12,467 - INFO - Triggering internal recovery for broker 1
2025-05-06 10:14:12,474 - INFO - Found 1 partitions on broker 1
2025-05-06 10:14:12,474 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 10:14:12,474 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 10:14:12,474 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 10:14:12,475 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 10:14:12,500 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:12,530 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 10:14:12,531 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 10:14:12,531 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 10:14:13,524 - INFO - Skipping recovery for kafka1:9092, last attempt 16.3s ago
2025-05-06 10:14:13,536 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:13,544 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:14,266 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:14:14,273 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:14:16,292 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:14:16,294 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:14:18,320 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:14:18,328 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:14:18,553 - INFO - Skipping recovery for kafka1:9092, last attempt 21.4s ago
2025-05-06 10:14:18,567 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:18,584 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:20,369 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:14:20,376 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:14:22,385 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:14:22,393 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:14:23,587 - INFO - Skipping recovery for kafka1:9092, last attempt 26.4s ago
2025-05-06 10:14:23,605 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:23,624 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:24,422 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:14:24,426 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:14:26,436 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:14:26,440 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:14:28,458 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:14:28,460 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:14:28,663 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:28,679 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:28,709 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:30,482 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:14:30,487 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:14:32,493 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:14:32,495 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:14:33,726 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:33,738 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:33,783 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:34,525 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:14:34,528 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:14:36,539 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:14:36,542 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:14:38,568 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:14:38,576 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:14:38,899 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:38,951 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:38,981 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:40,605 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:14:40,609 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:14:42,617 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:14:42,619 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:14:44,011 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:44,062 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:44,092 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:44,640 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:14:44,645 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:14:46,662 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:14:46,667 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:14:48,680 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:14:48,684 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:14:49,122 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:49,138 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:49,153 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:50,710 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:14:50,713 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:14:52,740 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:14:52,743 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:14:54,183 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:54,199 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:54,217 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:54,756 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:14:54,759 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:14:56,769 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:14:56,772 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:14:58,777 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:14:58,785 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:14:59,252 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:59,267 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:14:59,283 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:15:00,804 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:15:00,809 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:15:02,828 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:15:02,831 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:15:04,314 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:15:04,332 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:15:04,355 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:15:04,841 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:15:04,844 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:15:06,859 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:15:06,862 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:15:08,918 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:15:08,946 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:15:09,395 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:15:09,417 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:15:09,439 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:15:10,983 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:15:10,993 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:15:13,001 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:15:13,005 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:15:14,465 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:15:14,492 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:15:14,520 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:15:15,030 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:15:15,041 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:15:17,049 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:15:17,054 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:15:19,103 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:15:19,121 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:15:19,570 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:15:19,581 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:15:19,600 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:15:21,142 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:15:21,146 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:15:23,182 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:15:23,195 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:15:24,644 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:15:24,696 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:15:24,724 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:15:25,222 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:15:25,230 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:15:27,256 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:15:27,275 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:15:29,386 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:15:29,424 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:15:29,800 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:15:29,827 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:15:29,878 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:15:31,434 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:15:31,463 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:15:33,494 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:15:33,505 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:15:34,908 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:15:34,942 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:15:34,976 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:15:35,539 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:15:35,545 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:15:37,576 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:15:37,586 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:15:39,649 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:15:39,674 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:15:40,021 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:15:40,042 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:15:40,069 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:15:41,691 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:15:41,708 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:15:43,722 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:15:43,726 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:15:45,101 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:15:45,136 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:15:45,165 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:15:45,765 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:15:45,793 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:15:47,821 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:15:47,825 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:15:49,888 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:15:49,920 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:15:50,208 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:15:50,233 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:15:50,264 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:15:51,954 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:15:51,966 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:15:54,036 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:15:54,058 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:15:55,292 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:15:55,324 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:15:55,359 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:15:56,079 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:15:56,084 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:15:58,097 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:15:58,110 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:16:00,162 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:16:00,190 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:16:00,360 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 10:16:00,360 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 10:16:00,362 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 10:16:00,364 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 10:16:00,364 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE, mode: buffer
2025-05-06 10:16:00,397 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:00,399 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:00,456 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:00,464 - INFO - Using strategy buffer configuration
2025-05-06 10:16:00,485 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 10:16:00,721 - INFO - Successfully applied config to broker 2
2025-05-06 10:16:00,920 - INFO - Successfully applied config to broker 3
2025-05-06 10:16:01,172 - INFO - Successfully applied config to broker 1
2025-05-06 10:16:01,173 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 10:16:01,181 - INFO - Triggering leader election
2025-05-06 10:16:01,182 - INFO - Listing topics for leader election
2025-05-06 10:16:01,410 - INFO - Found 1 topics for leader election
2025-05-06 10:16:01,419 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 10:16:01,423 - INFO - Leader election completed in 0.24 seconds, success: False
2025-05-06 10:16:01,428 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 10:16:01,436 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:02,255 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:16:02,315 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:16:04,397 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:16:04,450 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:16:04,514 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:16:04,549 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:04,691 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:06,542 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:16:06,573 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:16:06,697 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:16:06,727 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:06,761 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:08,596 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:16:08,629 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:16:08,762 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:16:08,793 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:08,813 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:10,695 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:16:10,710 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:16:10,820 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:16:10,929 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:10,998 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:12,745 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:16:12,749 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:16:13,006 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:16:13,025 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:13,053 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:14,768 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:16:14,775 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:16:15,059 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:16:15,066 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:15,074 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:16,439 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 10:16:16,440 - INFO - Attempting broker recovery for kafka1
2025-05-06 10:16:16,440 - INFO - Attempting internal recovery for broker 1
2025-05-06 10:16:16,440 - INFO - Triggering internal recovery for broker 1
2025-05-06 10:16:16,469 - INFO - Found 1 partitions on broker 1
2025-05-06 10:16:16,469 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 10:16:16,469 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 10:16:16,469 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 10:16:16,470 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 10:16:16,506 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:16,553 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 10:16:16,553 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 10:16:16,553 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 10:16:16,789 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:16:16,799 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:16:17,079 - INFO - Skipping recovery for kafka1:9092, last attempt 16.7s ago
2025-05-06 10:16:17,112 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:17,132 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:18,822 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:16:18,829 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:16:20,869 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:16:20,889 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:16:22,136 - INFO - Skipping recovery for kafka1:9092, last attempt 21.8s ago
2025-05-06 10:16:22,151 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:22,180 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:22,916 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:16:22,920 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:16:24,953 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:16:24,981 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:16:27,014 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:16:27,026 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:16:27,190 - INFO - Skipping recovery for kafka1:9092, last attempt 26.8s ago
2025-05-06 10:16:27,228 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:27,252 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:29,082 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:16:29,134 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:16:31,192 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:16:31,218 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:16:32,339 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:32,379 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:32,410 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:33,258 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:16:33,268 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:16:35,315 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:16:35,328 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:16:37,440 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:16:37,451 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:16:37,464 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:37,483 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:37,503 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:39,480 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:16:39,486 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:16:41,508 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:16:41,560 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:16:42,542 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:42,571 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:42,592 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:43,584 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:16:43,630 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:16:45,651 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:16:45,678 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:16:47,642 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:47,686 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:47,719 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:16:47,720 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:47,739 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:16:49,753 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:16:49,758 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:16:51,816 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:16:51,841 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:16:52,750 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:52,770 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:52,789 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:53,883 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:16:53,898 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:16:55,908 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:16:55,927 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:16:57,828 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:57,855 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:57,881 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:16:57,948 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:16:57,973 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:17:00,147 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:17:00,188 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:17:02,237 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:17:02,300 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:17:02,956 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:17:02,991 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:17:03,027 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:17:04,393 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:17:04,397 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:17:06,464 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:17:06,508 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:17:08,146 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:17:08,241 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:17:08,334 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:17:10,716 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:17:10,913 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:17:12,962 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:17:12,968 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:17:13,403 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:17:13,436 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:17:13,549 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:17:15,000 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:17:15,017 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:37:40,730 - INFO - PRIMARY KAFKA BROKERS (for monitoring): ['kafka1:9092', 'kafka2:9093', 'kafka3:9094']
2025-05-06 10:37:40,731 - INFO - Container names: ['kafka1', 'kafka2', 'kafka3']
2025-05-06 10:37:40,731 - INFO - Alternative addresses (for connection attempts ONLY): ['kafka1:29092', 'kafka2:29093', 'kafka3:29094']
2025-05-06 10:37:40,732 - INFO - Starting Kafka Arms Controller
2025-05-06 10:37:40,736 - INFO - Successfully registered all initial metrics
2025-05-06 10:37:40,738 - INFO - Started Prometheus metrics server on port 8002
2025-05-06 10:37:40,775 - INFO - Loaded strategy buffer: QUICK_REBALANCE
2025-05-06 10:37:40,818 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:37:40,827 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:37:42,848 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:37:42,880 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:37:44,745 - INFO - Monitoring these brokers ONLY: ['kafka1:9092', 'kafka2:9093', 'kafka3:9094']
2025-05-06 10:37:44,746 - INFO - TEST MODE ENABLED - Will simulate failures for kafka1:9092 every 120 seconds
2025-05-06 10:37:44,746 - INFO - Test mode initialized, broker kafka1:9092 will be tested on next check
2025-05-06 10:37:44,746 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 10:37:44,746 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 10:37:44,746 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 10:37:44,747 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 10:37:44,747 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: CONTROLLED_GRADUAL, mode: buffer
2025-05-06 10:37:44,895 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:37:44,899 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:37:46,929 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:37:46,936 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:37:48,952 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:37:48,959 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:37:51,045 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:37:51,077 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:37:53,126 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:37:53,155 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:37:54,433 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3]
2025-05-06 10:37:54,461 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3]
2025-05-06 10:37:54,506 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:37:54,506 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:37:55,188 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:37:55,202 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:37:55,525 - INFO - Using strategy buffer configuration
2025-05-06 10:37:55,574 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 10:37:56,035 - INFO - Successfully applied config to broker 2
2025-05-06 10:37:56,304 - INFO - Successfully applied config to broker 3
2025-05-06 10:37:56,395 - INFO - Successfully applied config to broker 1
2025-05-06 10:37:56,395 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 10:37:56,397 - INFO - Triggering leader election
2025-05-06 10:37:56,404 - INFO - Listing topics for leader election
2025-05-06 10:37:56,431 - INFO - Found 1 topics for leader election
2025-05-06 10:37:56,432 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 10:37:56,432 - INFO - Leader election completed in 0.03 seconds, success: False
2025-05-06 10:37:56,434 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 10:37:56,513 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:37:56,525 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:37:56,557 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:37:57,278 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:37:57,313 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:37:58,563 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:37:58,637 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:37:58,690 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:37:59,357 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:37:59,414 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:38:00,698 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:38:00,723 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:00,743 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:01,456 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:38:01,477 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:38:02,748 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:38:02,762 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:02,772 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:03,486 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:38:03,492 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:38:04,776 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:38:04,789 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:04,799 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:05,515 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:38:05,533 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:38:06,804 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:38:06,830 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:06,845 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:07,547 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:38:07,549 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:38:08,849 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:38:08,870 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:08,884 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:09,574 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:38:09,578 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:38:10,891 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:38:10,907 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:10,915 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:11,442 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 10:38:11,442 - INFO - Attempting broker recovery for kafka1
2025-05-06 10:38:11,442 - INFO - Attempting internal recovery for broker 1
2025-05-06 10:38:11,443 - INFO - Triggering internal recovery for broker 1
2025-05-06 10:38:11,450 - INFO - Found 1 partitions on broker 1
2025-05-06 10:38:11,450 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 10:38:11,450 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 10:38:11,450 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 10:38:11,451 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 10:38:11,461 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:11,480 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 10:38:11,481 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 10:38:11,481 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 10:38:11,584 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:38:11,590 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:38:12,919 - INFO - Skipping recovery for kafka1:9092, last attempt 28.2s ago
2025-05-06 10:38:12,932 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:12,944 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:13,604 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:38:13,606 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:38:15,612 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:38:15,614 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:38:17,643 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:38:17,650 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:38:17,968 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:17,988 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:18,006 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:19,678 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:38:19,683 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:38:21,695 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:38:21,698 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:38:23,030 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:23,049 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:23,073 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:23,714 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:38:23,718 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:38:25,733 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:38:25,735 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:38:27,753 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:38:27,758 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:38:28,100 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:28,117 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:28,133 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:29,766 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:38:29,769 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:38:31,778 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:38:31,780 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:38:33,154 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:33,178 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:33,206 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:33,809 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:38:33,814 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:38:35,824 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:38:35,827 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:38:37,852 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:38:37,859 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:38:38,234 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:38,248 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:38,276 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:39,863 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:38:39,866 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:38:41,880 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:38:41,883 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:38:43,291 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:43,332 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:43,378 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:43,895 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:38:43,898 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:38:46,371 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:38:46,475 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:38:48,406 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:48,422 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:48,477 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:48,584 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:38:48,608 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:38:50,658 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:38:50,662 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:38:52,687 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:38:52,696 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:38:53,526 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:53,548 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:53,564 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:54,710 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:38:54,713 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:38:56,725 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:38:56,730 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:38:58,588 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:58,599 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:58,614 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:38:58,743 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 10:38:58,746 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:39:00,768 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:39:00,773 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:39:02,791 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:39:02,794 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:39:03,637 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:03,659 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:03,690 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:04,817 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:39:04,820 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:39:06,842 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:39:06,902 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:39:08,712 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:08,735 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:08,764 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:08,916 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:39:08,926 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:39:10,969 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:39:11,121 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:39:13,157 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:39:13,161 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:39:13,782 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:13,802 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:13,817 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:15,186 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:39:15,230 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:39:17,276 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:39:17,280 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:39:18,862 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:18,889 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:18,926 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:19,297 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:39:19,301 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:39:21,316 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:39:21,319 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:39:23,330 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:39:23,334 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:39:23,958 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:23,975 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:23,989 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:25,351 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:39:25,355 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:39:27,368 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:39:27,372 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:39:29,017 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:29,029 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:29,042 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:29,379 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:39:29,382 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:39:31,387 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:39:31,395 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:39:33,411 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:39:33,414 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:39:34,066 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:34,088 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:34,121 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:35,425 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:39:35,428 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:39:37,444 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:39:37,447 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:39:39,151 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:39,177 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:39,200 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:39,471 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:39:39,476 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:39:41,506 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:39:41,511 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:39:43,521 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:39:43,524 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:39:44,222 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:44,239 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:44,262 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:45,532 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:39:45,537 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:39:47,575 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:39:47,580 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:39:49,265 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 10:39:49,266 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 10:39:49,267 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 10:39:49,267 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 10:39:49,267 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE, mode: buffer
2025-05-06 10:39:49,322 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:49,322 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:49,355 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:49,356 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:49,368 - INFO - Using strategy buffer configuration
2025-05-06 10:39:49,376 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 10:39:49,464 - INFO - Successfully applied config to broker 2
2025-05-06 10:39:49,532 - INFO - Successfully applied config to broker 3
2025-05-06 10:39:49,642 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:39:49,644 - INFO - Successfully applied config to broker 1
2025-05-06 10:39:49,645 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 10:39:49,667 - INFO - Triggering leader election
2025-05-06 10:39:49,670 - INFO - Listing topics for leader election
2025-05-06 10:39:49,695 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:39:49,700 - INFO - Found 1 topics for leader election
2025-05-06 10:39:49,700 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 10:39:49,701 - INFO - Leader election completed in 0.03 seconds, success: False
2025-05-06 10:39:49,704 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 10:39:51,374 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:39:51,392 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:51,408 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:51,714 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:39:51,717 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:39:53,413 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:39:53,430 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:53,445 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:53,746 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:39:53,750 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:39:55,446 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:39:55,457 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:55,465 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:55,758 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:39:55,761 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:39:57,468 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:39:57,478 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:57,494 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:57,777 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:39:57,781 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:39:59,495 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:39:59,500 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:59,505 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:39:59,789 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:39:59,791 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:40:01,511 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:40:01,528 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:40:01,536 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:40:01,810 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:40:01,815 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:40:03,540 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:40:03,549 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:40:03,557 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:40:03,828 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:40:03,831 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:40:04,709 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 10:40:04,709 - INFO - Attempting broker recovery for kafka1
2025-05-06 10:40:04,709 - INFO - Attempting internal recovery for broker 1
2025-05-06 10:40:04,710 - INFO - Triggering internal recovery for broker 1
2025-05-06 10:40:04,718 - INFO - Found 1 partitions on broker 1
2025-05-06 10:40:04,718 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 10:40:04,719 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 10:40:04,719 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 10:40:04,720 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 10:40:04,730 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:40:04,758 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 10:40:04,758 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 10:40:04,758 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 10:40:05,564 - INFO - Skipping recovery for kafka1:9092, last attempt 16.3s ago
2025-05-06 10:40:05,568 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:40:05,574 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:40:05,840 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:40:05,842 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:40:07,867 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:40:07,870 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:40:09,891 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:40:09,895 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:40:10,579 - INFO - Skipping recovery for kafka1:9092, last attempt 21.3s ago
2025-05-06 10:40:10,608 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:40:10,630 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:40:11,926 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:40:11,939 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:40:13,951 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:40:13,956 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:40:15,636 - INFO - Skipping recovery for kafka1:9092, last attempt 26.4s ago
2025-05-06 10:40:15,672 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:40:15,717 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:40:16,012 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:40:16,048 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:40:18,096 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:40:18,120 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:40:20,160 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:40:20,166 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:40:20,836 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:40:20,878 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:40:20,907 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:40:22,258 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:40:22,283 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:40:24,296 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:40:24,304 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:40:25,929 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:40:25,953 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:40:25,970 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:40:26,320 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:40:26,328 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:40:28,343 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:40:28,350 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:40:30,453 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:40:30,487 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:40:31,024 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:40:31,110 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:40:31,156 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:40:32,515 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:40:32,518 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:40:34,533 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:40:34,546 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:40:36,561 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:40:36,565 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:40:37,177 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:40:37,200 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:40:37,233 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:40:38,575 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:40:38,579 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:40:40,609 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:40:40,617 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:40:42,256 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:40:42,314 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:40:42,359 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:40:42,645 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:40:42,651 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:40:44,675 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:40:44,701 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:40:46,728 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:40:46,733 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:40:47,376 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:40:47,391 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:40:47,414 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:40:48,746 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:40:48,750 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:40:50,761 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:40:50,765 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:40:52,434 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:40:52,451 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:40:52,482 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:40:52,797 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:40:52,801 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:40:54,807 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:40:54,812 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:40:56,860 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:40:56,869 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:40:57,513 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:40:57,545 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:40:57,573 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:40:58,922 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:40:58,954 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:41:01,000 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:41:01,017 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:41:02,592 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:41:02,612 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:41:02,630 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:41:03,048 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:41:03,052 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:41:05,065 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:41:05,072 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:41:07,084 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:41:07,087 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:41:07,648 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:41:07,660 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:41:07,678 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:41:09,094 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:41:09,097 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:41:11,120 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:41:11,123 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:41:12,695 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:41:12,716 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:41:12,731 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:41:13,153 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:41:13,161 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:41:15,200 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:41:15,256 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:41:17,309 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:41:17,348 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:41:17,795 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:41:17,837 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:41:18,083 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:41:19,373 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:41:19,380 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:41:21,392 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:41:21,398 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:41:23,105 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:41:23,130 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:41:23,152 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:41:23,435 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:41:23,452 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:41:25,472 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:41:25,475 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:41:27,509 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:41:27,524 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:41:28,187 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:41:28,214 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:41:28,238 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:41:29,536 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:41:29,538 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:41:31,543 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:41:31,545 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:41:33,259 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:41:33,283 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:41:33,311 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:41:33,564 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:41:33,568 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:41:35,577 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:41:35,585 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:41:37,608 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:41:37,629 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:41:38,328 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:41:38,339 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:41:38,357 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:41:39,643 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:41:39,656 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:41:41,670 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:41:41,674 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:41:43,377 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:41:43,407 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:41:43,438 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:41:43,694 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:41:43,730 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:41:45,758 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:41:45,763 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:41:47,807 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:41:47,814 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:41:48,460 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:41:48,479 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:41:48,500 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:41:49,827 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:41:49,831 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:41:51,865 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:41:51,875 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:41:53,504 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 10:41:53,505 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 10:41:53,506 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 10:41:53,506 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 10:41:53,506 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE, mode: buffer
2025-05-06 10:41:53,527 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:41:53,527 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:41:53,565 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:41:53,565 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:41:53,571 - INFO - Using strategy buffer configuration
2025-05-06 10:41:53,582 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 10:41:53,756 - INFO - Successfully applied config to broker 2
2025-05-06 10:41:53,865 - INFO - Successfully applied config to broker 3
2025-05-06 10:41:53,902 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:41:53,915 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:41:54,328 - INFO - Successfully applied config to broker 1
2025-05-06 10:41:54,331 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 10:41:54,353 - INFO - Triggering leader election
2025-05-06 10:41:54,356 - INFO - Listing topics for leader election
2025-05-06 10:41:54,386 - INFO - Found 1 topics for leader election
2025-05-06 10:41:54,391 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 10:41:54,391 - INFO - Leader election completed in 0.04 seconds, success: False
2025-05-06 10:41:54,398 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 10:41:55,577 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:41:55,601 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:41:55,640 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:41:55,951 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:41:55,961 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:41:57,645 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:41:57,661 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:41:57,688 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:41:57,988 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:41:57,999 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:41:59,695 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:41:59,763 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:41:59,793 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:42:00,124 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:42:00,143 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:42:01,802 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:42:01,865 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:42:01,904 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:42:02,170 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:42:02,176 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:42:03,907 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:42:03,924 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:42:03,939 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:42:04,193 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:42:04,260 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:42:05,943 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:42:05,950 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:42:05,958 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:42:06,271 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:42:06,275 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:42:07,964 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:42:07,985 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:42:08,019 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:42:08,296 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:42:08,303 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:42:09,401 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 10:42:09,402 - INFO - Attempting broker recovery for kafka1
2025-05-06 10:42:09,402 - INFO - Attempting internal recovery for broker 1
2025-05-06 10:42:09,403 - INFO - Triggering internal recovery for broker 1
2025-05-06 10:42:09,412 - INFO - Found 1 partitions on broker 1
2025-05-06 10:42:09,412 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 10:42:09,412 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 10:42:09,412 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 10:42:09,414 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 10:42:09,428 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:42:09,468 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 10:42:09,468 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 10:42:09,468 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 10:42:10,024 - INFO - Skipping recovery for kafka1:9092, last attempt 16.5s ago
2025-05-06 10:42:10,080 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:42:10,121 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:42:10,330 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:42:10,333 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:42:12,349 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:42:12,356 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:42:14,366 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:42:14,369 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:42:15,135 - INFO - Skipping recovery for kafka1:9092, last attempt 21.6s ago
2025-05-06 10:42:15,176 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:42:15,210 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:42:16,384 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:42:16,389 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:42:18,402 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:42:18,410 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:42:20,212 - INFO - Skipping recovery for kafka1:9092, last attempt 26.7s ago
2025-05-06 10:42:20,267 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:42:20,312 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:42:20,438 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:42:20,445 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:42:22,468 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:42:22,472 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:42:24,479 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:42:24,482 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:42:25,344 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:42:25,493 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:42:25,536 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:42:26,497 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:42:26,500 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:42:28,551 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:42:28,569 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:42:30,576 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:42:30,610 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:42:30,632 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:42:30,690 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:42:30,746 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:42:32,656 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:42:32,674 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:42:34,699 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:42:34,714 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:42:35,807 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:42:35,905 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:42:35,983 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:42:36,735 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:42:36,750 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:42:38,762 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:42:38,779 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:42:40,820 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:42:40,843 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:42:41,016 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:42:41,044 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:42:41,063 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:42:42,863 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:42:42,869 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:42:44,879 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:42:44,907 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:42:46,096 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:42:46,147 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:42:46,209 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:42:46,957 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:42:46,978 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:42:49,062 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:42:49,122 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:42:51,155 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:42:51,210 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:42:51,430 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:42:51,524 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:42:51,595 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:42:53,253 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:42:53,260 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:42:55,274 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:42:55,278 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:42:57,308 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:42:57,314 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:42:57,630 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:42:57,652 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:42:57,706 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:42:59,354 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:42:59,358 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:43:01,387 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:43:01,398 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:43:02,724 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:43:02,745 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:43:02,767 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:43:03,429 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:43:03,455 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:43:05,468 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:43:05,473 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:43:07,490 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:43:07,492 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:43:07,786 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:43:07,799 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:43:07,814 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:43:09,500 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:43:09,530 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:43:11,559 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:43:11,571 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:43:12,835 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:43:12,882 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:43:12,907 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:43:13,778 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:43:13,844 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:43:15,882 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:43:15,903 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:43:17,951 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:43:17,954 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:43:17,963 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:43:17,976 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:43:18,032 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:43:19,993 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:43:20,018 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:43:22,055 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:43:22,084 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:43:23,052 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:43:23,074 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:43:23,106 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:43:24,120 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:43:24,150 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:43:26,160 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:43:26,171 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:43:28,131 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:43:28,163 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:43:28,193 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:43:28,206 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:43:28,210 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:43:30,249 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:43:30,287 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:43:32,318 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:43:32,332 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:43:33,215 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:43:33,242 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:43:33,291 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:43:34,369 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:43:34,373 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:43:36,404 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:43:36,425 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:43:38,320 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:43:38,344 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:43:38,372 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:43:38,435 - ERROR - API returned status code: 500
2025-05-06 10:43:40,453 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:43:40,457 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:43:42,471 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:43:42,493 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:43:43,398 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:43:43,415 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:43:43,442 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:43:44,505 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:43:44,532 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:43:46,554 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:43:46,562 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:43:48,478 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:43:48,521 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:43:48,548 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:43:48,584 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:43:48,590 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:43:50,623 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:43:50,641 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:43:52,681 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:43:52,696 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:43:53,550 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 10:43:53,551 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 10:43:53,552 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 10:43:53,553 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 10:43:53,555 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE, mode: buffer
2025-05-06 10:43:53,597 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:43:53,597 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:43:53,629 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:43:53,633 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:43:53,643 - INFO - Using strategy buffer configuration
2025-05-06 10:43:53,648 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 10:43:53,890 - INFO - Successfully applied config to broker 2
2025-05-06 10:43:54,109 - INFO - Successfully applied config to broker 3
2025-05-06 10:43:54,657 - INFO - Successfully applied config to broker 1
2025-05-06 10:43:54,657 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 10:43:54,660 - INFO - Triggering leader election
2025-05-06 10:43:54,665 - INFO - Listing topics for leader election
2025-05-06 10:43:54,705 - INFO - Found 1 topics for leader election
2025-05-06 10:43:54,709 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 10:43:54,710 - INFO - Leader election completed in 0.04 seconds, success: False
2025-05-06 10:43:54,717 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 10:43:54,774 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:43:54,869 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:43:55,645 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:43:55,690 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:43:55,756 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:43:56,890 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:43:56,895 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:43:57,762 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:43:57,774 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:43:57,791 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:43:58,931 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:43:58,962 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:43:59,795 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:43:59,844 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:43:59,884 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:44:00,986 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:44:00,990 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:44:01,888 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:44:01,912 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:44:01,937 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:44:03,012 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:44:03,017 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:44:03,942 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:44:03,950 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:44:03,960 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:44:05,031 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:44:05,035 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:44:05,965 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:44:05,977 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:44:05,994 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:44:07,047 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:44:07,051 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:44:07,998 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:44:08,009 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:44:08,020 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:44:09,058 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:44:09,062 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:44:09,724 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 10:44:09,724 - INFO - Attempting broker recovery for kafka1
2025-05-06 10:44:09,725 - INFO - Attempting internal recovery for broker 1
2025-05-06 10:44:09,725 - INFO - Triggering internal recovery for broker 1
2025-05-06 10:44:09,736 - INFO - Found 1 partitions on broker 1
2025-05-06 10:44:09,736 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 10:44:09,736 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 10:44:09,736 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 10:44:09,738 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 10:44:09,760 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:44:09,838 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 10:44:09,838 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 10:44:09,838 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 10:44:10,030 - INFO - Skipping recovery for kafka1:9092, last attempt 16.5s ago
2025-05-06 10:44:10,042 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:44:10,064 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:44:11,085 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:44:11,088 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:44:13,106 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:44:13,110 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:44:15,074 - INFO - Skipping recovery for kafka1:9092, last attempt 21.5s ago
2025-05-06 10:44:15,100 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:44:15,126 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:44:15,148 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:44:15,153 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:44:17,186 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:44:17,193 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:44:19,197 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:44:19,199 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:44:20,135 - INFO - Skipping recovery for kafka1:9092, last attempt 26.6s ago
2025-05-06 10:44:20,177 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:44:20,214 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:44:21,222 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:44:21,226 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:44:23,235 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:44:23,240 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:44:25,247 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:44:25,260 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:44:25,265 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:44:25,269 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:44:25,306 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:44:27,310 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:44:27,347 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:44:29,358 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:44:29,364 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:44:30,350 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:44:30,392 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:44:30,432 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:44:31,376 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:44:31,380 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:44:33,415 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:44:33,422 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:44:35,440 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:44:35,446 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:44:35,487 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:44:35,523 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:44:35,559 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:44:37,468 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:44:37,472 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:44:39,477 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:44:39,479 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:44:40,606 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:44:40,669 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:44:40,703 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:44:41,503 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:44:41,510 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:44:43,533 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:44:43,538 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:44:45,557 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:44:45,560 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:44:45,735 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:44:45,761 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:44:45,805 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:44:47,577 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:44:47,582 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:44:49,609 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:44:49,616 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:44:50,835 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:44:50,885 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:44:50,907 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:44:51,645 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:44:51,655 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:44:53,670 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:44:53,673 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:44:55,687 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:44:55,708 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:44:55,931 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:44:55,949 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:44:56,002 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:44:57,725 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:44:57,729 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:44:59,749 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:44:59,752 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:45:01,030 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:45:01,078 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:45:01,097 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:45:01,769 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:45:01,772 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:45:03,809 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:45:03,827 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:45:05,871 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:45:05,879 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:45:06,167 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:45:06,216 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:45:06,268 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:45:07,910 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:45:07,917 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:45:09,963 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:45:09,983 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:45:11,290 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:45:11,353 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:45:11,376 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:45:12,011 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:45:12,016 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:45:14,033 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:45:14,046 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:45:16,060 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:45:16,066 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:45:16,406 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:45:16,440 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:45:16,481 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:45:18,085 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:45:18,089 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:45:20,114 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:45:20,124 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:45:21,531 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:45:21,580 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:45:21,645 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:45:22,152 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:45:22,166 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:45:24,180 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:45:24,187 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:45:26,204 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:45:26,213 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:45:26,688 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:45:26,723 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:45:26,767 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:45:28,226 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:45:28,229 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:45:30,252 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:45:30,286 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:45:31,793 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:45:31,809 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:45:31,845 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:45:32,300 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:45:32,312 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:45:34,326 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:45:34,329 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:45:36,377 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:45:36,393 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:45:36,890 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:45:37,036 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:45:37,097 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:45:38,421 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:45:38,426 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:45:40,444 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:45:40,454 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:45:42,126 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:45:42,160 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:45:42,210 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:45:42,467 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:45:42,472 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:45:44,483 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:45:44,489 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:45:46,510 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:45:46,539 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:45:47,279 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:45:47,356 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:45:47,447 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:45:48,586 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:45:48,605 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:45:50,662 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:45:50,748 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:45:52,468 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:45:52,490 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:45:52,522 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:45:52,762 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:45:52,766 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:45:54,783 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:45:54,795 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:45:56,834 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:45:56,853 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:45:57,530 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 10:45:57,531 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 10:45:57,533 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 10:45:57,535 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 10:45:57,538 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE, mode: buffer
2025-05-06 10:45:57,563 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:45:57,573 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:45:57,596 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:45:57,598 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:45:57,606 - INFO - Using strategy buffer configuration
2025-05-06 10:45:57,612 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 10:45:58,049 - INFO - Successfully applied config to broker 2
2025-05-06 10:45:58,236 - INFO - Successfully applied config to broker 3
2025-05-06 10:45:58,780 - INFO - Successfully applied config to broker 1
2025-05-06 10:45:58,780 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 10:45:58,788 - INFO - Triggering leader election
2025-05-06 10:45:58,791 - INFO - Listing topics for leader election
2025-05-06 10:45:58,808 - INFO - Found 1 topics for leader election
2025-05-06 10:45:58,809 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 10:45:58,810 - INFO - Leader election completed in 0.02 seconds, success: False
2025-05-06 10:45:58,827 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 10:45:58,892 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:45:58,917 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:45:59,610 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:45:59,628 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:45:59,641 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:46:00,954 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:46:00,963 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:46:01,644 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:46:01,667 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:46:01,724 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:46:02,975 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:46:02,978 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:46:03,731 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:46:03,745 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:46:03,762 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:46:04,984 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:46:05,003 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:46:05,766 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:46:05,782 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:46:05,829 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:46:07,024 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:46:07,027 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:46:07,837 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:46:07,861 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:46:07,893 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:46:09,043 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:46:09,048 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:46:09,900 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:46:09,982 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:46:10,016 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:46:11,091 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:46:11,095 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:46:12,033 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 10:46:12,046 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:46:12,065 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:46:13,113 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:46:13,118 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:46:13,836 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 10:46:13,838 - INFO - Attempting broker recovery for kafka1
2025-05-06 10:46:13,838 - INFO - Attempting internal recovery for broker 1
2025-05-06 10:46:13,838 - INFO - Triggering internal recovery for broker 1
2025-05-06 10:46:13,851 - INFO - Found 1 partitions on broker 1
2025-05-06 10:46:13,851 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 10:46:13,851 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 10:46:13,851 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 10:46:13,852 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 10:46:13,881 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:46:13,918 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 10:46:13,918 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 10:46:13,918 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 10:46:14,068 - INFO - Skipping recovery for kafka1:9092, last attempt 16.5s ago
2025-05-06 10:46:14,071 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:46:14,079 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:46:15,123 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:46:15,127 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:46:17,154 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:46:17,158 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:46:19,078 - INFO - Skipping recovery for kafka1:9092, last attempt 21.5s ago
2025-05-06 10:46:19,108 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:46:19,140 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:46:19,170 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:46:19,175 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:46:21,190 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:46:21,206 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:46:23,243 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:46:23,247 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:46:24,146 - INFO - Skipping recovery for kafka1:9092, last attempt 26.6s ago
2025-05-06 10:46:24,194 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:46:25,229 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:46:25,265 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:46:25,273 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:46:27,296 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:46:27,302 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:46:29,309 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:46:29,312 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:46:30,256 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:46:30,275 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:46:30,293 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:46:31,322 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:46:31,325 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:46:33,331 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:46:33,334 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:46:35,324 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:46:35,373 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:46:35,383 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:46:35,401 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:46:35,410 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:46:37,424 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:46:37,431 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:46:39,448 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:46:39,460 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:46:40,449 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:46:40,497 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:46:40,524 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:46:41,471 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:46:41,475 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:46:43,508 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:46:43,517 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:46:45,524 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:46:45,528 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:46:45,562 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:46:45,593 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:46:45,672 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:46:47,539 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:46:47,544 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:46:49,562 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:46:49,565 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:46:50,707 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:46:50,729 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:46:50,746 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:46:51,576 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:46:51,579 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:46:53,604 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:46:53,609 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:46:55,633 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:46:55,639 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:46:56,048 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:46:56,141 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:46:56,197 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:46:57,669 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:46:57,675 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:46:59,704 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 10:46:59,735 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:47:01,733 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:47:01,909 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:47:01,975 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:47:02,072 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:47:02,078 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:47:04,147 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:47:04,169 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:47:06,183 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:47:06,187 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 10:47:08,103 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 10:47:08,123 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 10:47:08,153 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 10:47:08,234 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 10:47:08,242 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:14:30,083 - INFO - PRIMARY KAFKA BROKERS (for monitoring): ['kafka1:9092', 'kafka2:9093', 'kafka3:9094']
2025-05-06 13:14:30,084 - INFO - Container names: ['kafka1', 'kafka2', 'kafka3']
2025-05-06 13:14:30,084 - INFO - Alternative addresses (for connection attempts ONLY): ['kafka1:29092', 'kafka2:29093', 'kafka3:29094']
2025-05-06 13:14:30,085 - INFO - Starting Kafka Arms Controller
2025-05-06 13:14:30,089 - INFO - Successfully registered all initial metrics
2025-05-06 13:14:30,092 - INFO - Started Prometheus metrics server on port 8002
2025-05-06 13:14:30,144 - INFO - Loaded strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:14:30,158 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:14:30,213 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:14:32,233 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:14:32,238 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:14:34,106 - INFO - Monitoring these brokers ONLY: ['kafka1:9092', 'kafka2:9093', 'kafka3:9094']
2025-05-06 13:14:34,108 - INFO - TEST MODE ENABLED - Will simulate failures for kafka1:9092 every 120 seconds
2025-05-06 13:14:34,108 - INFO - Test mode initialized, broker kafka1:9092 will be tested on next check
2025-05-06 13:14:34,108 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 13:14:34,109 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 13:14:34,109 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 13:14:34,126 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 13:14:34,126 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: CONTROLLED_GRADUAL, mode: buffer
2025-05-06 13:14:34,265 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:14:34,281 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:14:36,302 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:14:36,366 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:14:38,402 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:14:38,431 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:14:40,475 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:14:40,550 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:14:42,611 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:14:42,764 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:14:44,129 - WARNING - Broker kafka2:9093 availability check failed: KafkaError{code=_TIMED_OUT,val=-185,str="Failed to get metadata: Local: Timed out"}
2025-05-06 13:14:44,192 - WARNING - Broker kafka2:9093 availability check failed: KafkaError{code=_TIMED_OUT,val=-185,str="Failed to get metadata: Local: Timed out"}
2025-05-06 13:14:44,861 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:14:44,900 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:14:46,998 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:14:47,082 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:14:49,184 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:14:49,200 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:14:51,273 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:14:51,296 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:14:52,690 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:14:52,704 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:14:52,794 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:14:52,821 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:14:52,832 - INFO - Using strategy buffer configuration
2025-05-06 13:14:52,873 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 13:14:53,153 - INFO - Successfully applied config to broker 2
2025-05-06 13:14:53,399 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:14:53,460 - INFO - Successfully applied config to broker 3
2025-05-06 13:14:53,469 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:14:53,791 - INFO - Successfully applied config to broker 1
2025-05-06 13:14:53,791 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 13:14:53,795 - INFO - Triggering leader election
2025-05-06 13:14:53,810 - INFO - Listing topics for leader election
2025-05-06 13:14:53,867 - INFO - Found 1 topics for leader election
2025-05-06 13:14:53,867 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 13:14:53,867 - INFO - Leader election completed in 0.06 seconds, success: False
2025-05-06 13:14:53,880 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 13:14:55,489 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:14:55,493 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:14:55,824 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:14:55,836 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:14:55,862 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:14:57,517 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:14:57,521 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:14:57,867 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:14:57,880 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:14:57,890 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:14:59,547 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:14:59,550 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:14:59,894 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:14:59,910 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:14:59,921 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:01,567 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:15:01,575 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:15:01,927 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:15:01,955 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:01,979 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:03,612 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:15:03,617 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:15:03,987 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:15:04,002 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:04,012 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:05,622 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:15:05,631 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:15:06,017 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:15:06,023 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:06,029 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:07,643 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:15:07,646 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:15:08,033 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:15:08,044 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:08,058 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:08,908 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 13:15:08,908 - INFO - Attempting broker recovery for kafka1
2025-05-06 13:15:08,908 - INFO - Attempting internal recovery for broker 1
2025-05-06 13:15:08,908 - INFO - Triggering internal recovery for broker 1
2025-05-06 13:15:08,919 - INFO - Found 1 partitions on broker 1
2025-05-06 13:15:08,919 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 13:15:08,919 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 13:15:08,919 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 13:15:08,921 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 13:15:08,941 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:08,983 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 13:15:08,986 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 13:15:08,986 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 13:15:09,673 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:15:09,680 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:15:10,071 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:10,077 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:10,082 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:11,701 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:15:11,704 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:15:13,724 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:15:13,726 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:15:15,107 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:15,121 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:15,130 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:15,751 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:15:15,755 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:15:17,768 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:15:17,772 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:15:19,787 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:15:19,797 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:15:20,146 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:20,156 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:20,171 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:21,808 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:15:21,811 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:15:23,829 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:15:23,832 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:15:25,187 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:25,195 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:25,211 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:25,851 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:15:25,871 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:15:27,895 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:15:27,922 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:15:29,954 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:15:29,958 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:15:30,254 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:30,270 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:30,287 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:31,981 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:15:31,989 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:15:34,012 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:15:34,022 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:15:35,311 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:35,343 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:35,377 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:36,065 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:15:36,074 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:15:38,098 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:15:38,103 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:15:40,114 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:15:40,119 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:15:40,395 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:40,408 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:40,415 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:42,154 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:15:42,163 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:15:44,175 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:15:44,178 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:15:45,433 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:45,447 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:45,461 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:46,182 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:15:46,184 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:15:48,206 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:15:48,213 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:15:50,248 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:15:50,265 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:15:50,476 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:50,502 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:50,513 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:52,366 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:15:52,469 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:15:54,561 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:15:54,600 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:15:55,577 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:55,654 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:55,727 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:15:56,628 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:15:56,670 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:15:58,714 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:15:58,729 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:16:00,759 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:16:00,760 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:00,786 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:16:00,796 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:00,860 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:02,821 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:16:02,837 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:16:04,986 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:16:05,001 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:16:05,896 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:05,973 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:06,038 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:07,053 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:16:07,068 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:16:09,102 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:16:09,110 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:16:11,056 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:11,084 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:11,134 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:11,149 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:16:11,156 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:16:13,166 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:16:13,168 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:16:15,229 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:16:15,234 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:16:16,197 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:16,300 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:16,320 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:17,285 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:16:17,343 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:16:19,370 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:16:19,389 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:16:21,355 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:21,424 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:21,454 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:16:21,471 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:21,529 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:16:23,551 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:16:23,576 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:16:25,603 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:16:25,631 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:16:27,512 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:27,535 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:27,581 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:27,647 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:16:27,676 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:16:29,690 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:16:29,693 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:16:31,742 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:16:31,747 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:16:32,594 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:32,626 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:32,649 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:33,776 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:16:33,779 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:16:35,814 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:16:35,887 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:16:37,656 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 13:16:37,665 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 13:16:37,677 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 13:16:37,695 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 13:16:37,695 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE, mode: buffer
2025-05-06 13:16:37,731 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:37,737 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:37,777 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:37,777 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:37,787 - INFO - Using strategy buffer configuration
2025-05-06 13:16:37,794 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 13:16:37,916 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:16:37,957 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:16:38,655 - INFO - Successfully applied config to broker 2
2025-05-06 13:16:38,888 - INFO - Successfully applied config to broker 3
2025-05-06 13:16:39,484 - INFO - Successfully applied config to broker 1
2025-05-06 13:16:39,485 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 13:16:39,489 - INFO - Triggering leader election
2025-05-06 13:16:39,493 - INFO - Listing topics for leader election
2025-05-06 13:16:39,525 - INFO - Found 1 topics for leader election
2025-05-06 13:16:39,526 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 13:16:39,526 - INFO - Leader election completed in 0.03 seconds, success: False
2025-05-06 13:16:39,528 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 13:16:39,790 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:16:39,803 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:39,813 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:39,977 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:16:39,996 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:16:41,818 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:16:41,831 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:41,841 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:42,006 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:16:42,009 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:16:43,845 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:16:43,863 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:43,881 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:44,021 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:16:44,034 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:16:45,889 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:16:45,936 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:45,982 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:46,059 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:16:46,064 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:16:47,996 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:16:48,037 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:48,095 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:48,113 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:16:48,167 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:16:50,103 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:16:50,131 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:50,148 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:50,206 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:16:50,210 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:16:52,159 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:16:52,179 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:52,192 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:52,235 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:16:52,238 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:16:54,196 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:16:54,211 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:54,221 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:54,255 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:16:54,258 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:16:54,535 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 13:16:54,536 - INFO - Attempting broker recovery for kafka1
2025-05-06 13:16:54,536 - INFO - Attempting internal recovery for broker 1
2025-05-06 13:16:54,536 - INFO - Triggering internal recovery for broker 1
2025-05-06 13:16:54,543 - INFO - Found 1 partitions on broker 1
2025-05-06 13:16:54,543 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 13:16:54,543 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 13:16:54,543 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 13:16:54,544 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 13:16:54,565 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:54,609 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 13:16:54,609 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 13:16:54,609 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 13:16:56,227 - INFO - Skipping recovery for kafka1:9092, last attempt 18.6s ago
2025-05-06 13:16:56,234 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:56,249 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:16:56,268 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:16:56,279 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:16:58,304 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:16:58,320 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:17:00,399 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:17:00,440 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:17:01,252 - INFO - Skipping recovery for kafka1:9092, last attempt 23.6s ago
2025-05-06 13:17:01,333 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:17:01,361 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:17:02,461 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:17:02,465 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:17:04,488 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:17:04,492 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:17:06,373 - INFO - Skipping recovery for kafka1:9092, last attempt 28.7s ago
2025-05-06 13:17:06,398 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:17:06,435 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:17:06,510 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:17:06,515 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:17:08,523 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:17:08,526 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:17:10,551 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:17:10,567 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:17:11,458 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:17:11,484 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:17:11,533 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:17:12,605 - ERROR - API returned status code: 500
2025-05-06 13:17:14,624 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:17:14,636 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:17:16,563 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:17:16,594 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:17:16,650 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:17:16,677 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:17:16,741 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:17:18,877 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:17:18,925 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:17:21,001 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:17:21,031 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:17:22,693 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:17:22,721 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:17:22,766 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:17:23,043 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:17:23,047 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:17:25,059 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:17:25,069 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:17:27,104 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:17:27,115 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:17:27,794 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:17:27,821 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:17:27,856 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:17:29,158 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:17:29,208 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:17:31,266 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:17:31,308 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:17:32,891 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:17:32,925 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:17:32,976 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:17:33,325 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:17:33,335 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:17:35,355 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:17:35,358 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:17:37,379 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:17:37,382 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:17:38,016 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:17:38,050 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:17:38,079 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:17:39,390 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:17:39,393 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:17:41,423 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:17:41,517 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:17:43,105 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:17:43,150 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:17:43,180 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:17:43,531 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:17:43,550 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:17:45,584 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:17:45,609 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:17:47,637 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:17:47,665 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:17:48,209 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:17:48,239 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:17:48,261 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:17:49,687 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:17:49,692 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:17:51,706 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:17:51,709 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:17:53,275 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:17:53,310 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:17:53,327 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:17:53,722 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:17:53,738 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:17:55,770 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:17:55,778 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:17:57,793 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:17:57,800 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:17:58,341 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:17:58,379 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:17:58,414 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:17:59,829 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:17:59,859 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:18:01,885 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:18:01,940 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:18:03,457 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:03,497 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:03,525 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:03,963 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:18:03,993 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:18:06,002 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:18:06,004 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:18:08,017 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:18:08,023 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:18:08,550 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:08,577 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:08,630 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:10,041 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:18:10,054 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:18:12,083 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:18:12,103 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:18:13,652 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:13,691 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:13,742 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:14,137 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:18:14,148 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:18:16,177 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:18:16,224 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:18:18,243 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:18:18,246 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:18:18,763 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:18,782 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:18,808 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:20,260 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:18:20,262 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:18:22,269 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:18:22,272 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:18:23,835 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:23,875 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:23,931 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:24,293 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:18:24,321 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:18:26,334 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:18:26,378 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:18:28,476 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:18:28,527 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:18:28,961 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:29,010 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:29,201 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:30,563 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:18:30,593 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:18:32,810 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:18:32,908 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:18:34,216 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:34,234 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:34,262 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:34,929 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:18:34,940 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:18:36,961 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:18:36,964 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:18:38,976 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:18:39,005 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:18:39,264 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 13:18:39,264 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 13:18:39,273 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 13:18:39,276 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 13:18:39,276 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: CONTROLLED_GRADUAL, mode: buffer
2025-05-06 13:18:39,342 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:39,354 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:39,390 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:39,391 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:39,394 - INFO - Using strategy buffer configuration
2025-05-06 13:18:39,405 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 13:18:39,920 - INFO - Successfully applied config to broker 2
2025-05-06 13:18:40,631 - INFO - Successfully applied config to broker 3
2025-05-06 13:18:41,121 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:18:41,161 - INFO - Successfully applied config to broker 1
2025-05-06 13:18:41,161 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 13:18:41,169 - INFO - Triggering leader election
2025-05-06 13:18:41,200 - INFO - Listing topics for leader election
2025-05-06 13:18:41,200 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:18:41,411 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:18:41,646 - INFO - Found 1 topics for leader election
2025-05-06 13:18:41,648 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 13:18:41,649 - INFO - Leader election completed in 0.45 seconds, success: False
2025-05-06 13:18:41,671 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 13:18:41,714 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:41,755 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:43,267 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:18:43,287 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:18:43,771 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:18:43,810 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:43,863 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:45,317 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:18:45,424 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:18:45,873 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:18:45,943 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:46,025 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:47,481 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:18:47,542 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:18:48,033 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:18:48,077 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:48,124 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:49,563 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:18:49,605 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:18:50,127 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:18:50,182 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:50,218 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:51,637 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:18:51,667 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:18:52,227 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:18:52,259 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:52,275 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:53,684 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:18:53,688 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:18:54,285 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:18:54,305 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:54,317 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:55,700 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:18:55,704 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:18:56,320 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:18:56,327 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:56,351 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:56,662 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 13:18:56,663 - INFO - Attempting broker recovery for kafka1
2025-05-06 13:18:56,663 - INFO - Attempting internal recovery for broker 1
2025-05-06 13:18:56,663 - INFO - Triggering internal recovery for broker 1
2025-05-06 13:18:56,713 - INFO - Found 1 partitions on broker 1
2025-05-06 13:18:56,716 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 13:18:56,717 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 13:18:56,718 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 13:18:57,716 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:18:57,722 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 13:18:57,733 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:18:57,763 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:57,834 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 13:18:57,834 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 13:18:57,834 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 13:18:58,360 - INFO - Skipping recovery for kafka1:9092, last attempt 19.1s ago
2025-05-06 13:18:58,402 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:58,425 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:18:59,776 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:18:59,801 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:19:01,831 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:19:01,894 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:19:03,434 - INFO - Skipping recovery for kafka1:9092, last attempt 24.2s ago
2025-05-06 13:19:03,511 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:19:03,952 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:19:04,008 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:19:04,550 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:19:06,031 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:19:06,049 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:19:08,095 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:19:08,115 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:19:09,582 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:19:09,616 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:19:09,632 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:19:10,134 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:19:10,143 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:19:12,193 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:19:12,204 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:19:14,218 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:19:14,249 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:19:14,695 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:19:14,741 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:19:14,770 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:19:16,272 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:19:16,311 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:19:18,353 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:19:18,445 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:19:19,872 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:19:20,009 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:19:20,077 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:19:20,488 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:19:20,561 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:19:22,589 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:19:22,685 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:19:24,702 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:19:24,750 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:19:25,124 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:19:25,164 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:19:25,191 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:19:26,783 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:19:26,792 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:19:28,825 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:19:28,839 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:19:30,210 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:19:30,233 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:19:30,251 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:19:30,855 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:19:30,864 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:19:32,892 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:19:32,920 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:19:34,931 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:19:34,949 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:19:35,286 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:19:35,347 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:19:35,419 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:19:36,977 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:19:36,982 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:19:39,010 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:19:39,017 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:19:40,466 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:19:40,659 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:19:40,701 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:19:41,055 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:19:41,114 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:19:43,140 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:19:43,170 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:19:45,198 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:19:45,207 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:19:45,761 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:19:45,786 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:19:45,829 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:19:47,217 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:19:47,223 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:19:49,261 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:19:49,267 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:19:50,886 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:19:50,927 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:19:50,968 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:19:51,290 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:19:51,318 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:19:53,338 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:19:53,353 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:19:55,395 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:19:55,408 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:19:56,001 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:19:56,043 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:19:56,156 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:19:57,492 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:19:57,495 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:19:59,503 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:19:59,532 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:20:01,185 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:01,219 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:01,260 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:01,549 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:20:01,551 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:20:03,584 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:20:03,592 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:20:05,649 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:20:05,668 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:20:06,319 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:06,354 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:06,394 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:07,719 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:20:07,759 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:20:09,792 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:20:09,817 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:20:11,411 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:11,490 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:11,860 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:20:11,893 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:20:12,532 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:13,909 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:20:13,913 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:20:15,984 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:20:16,010 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:20:17,560 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:17,597 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:17,613 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:18,049 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:20:18,056 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:20:20,094 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:20:20,165 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:20:22,195 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:20:22,200 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:20:22,631 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:22,673 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:22,708 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:24,231 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:20:24,237 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:20:26,271 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:20:26,330 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:20:27,755 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:27,809 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:27,892 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:28,362 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:20:28,391 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:20:30,407 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:20:30,418 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:20:32,456 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:20:32,464 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:20:32,930 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:33,012 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:33,036 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:34,499 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:20:34,541 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:20:36,555 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:20:36,558 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:20:38,081 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:38,149 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:38,244 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:38,590 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:20:38,648 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:20:40,716 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:20:40,722 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:20:42,748 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:20:42,754 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:20:43,249 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 13:20:43,250 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 13:20:43,251 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 13:20:43,252 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 13:20:43,252 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: CONTROLLED_GRADUAL, mode: buffer
2025-05-06 13:20:43,298 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:43,298 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:43,391 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:43,392 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:43,398 - INFO - Using strategy buffer configuration
2025-05-06 13:20:43,412 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 13:20:43,656 - INFO - Successfully applied config to broker 2
2025-05-06 13:20:44,196 - INFO - Successfully applied config to broker 3
2025-05-06 13:20:44,532 - INFO - Successfully applied config to broker 1
2025-05-06 13:20:44,533 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 13:20:44,542 - INFO - Triggering leader election
2025-05-06 13:20:44,543 - INFO - Listing topics for leader election
2025-05-06 13:20:44,736 - INFO - Found 1 topics for leader election
2025-05-06 13:20:44,736 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 13:20:44,737 - INFO - Leader election completed in 0.19 seconds, success: False
2025-05-06 13:20:44,775 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 13:20:44,844 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:20:44,856 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:20:45,401 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:20:45,432 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:45,549 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:46,890 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:20:46,904 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:20:47,565 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:20:47,618 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:47,662 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:48,934 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:20:48,938 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:20:49,674 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:20:49,711 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:49,727 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:50,965 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:20:50,968 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:20:51,733 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:20:51,756 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:51,835 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:53,006 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:20:53,033 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:20:53,844 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:20:53,884 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:53,919 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:55,049 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:20:55,073 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:20:55,923 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:20:55,949 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:55,999 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:57,102 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:20:57,154 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:20:58,019 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:20:58,060 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:58,320 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:20:59,185 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:20:59,215 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:20:59,785 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 13:20:59,785 - INFO - Attempting broker recovery for kafka1
2025-05-06 13:20:59,785 - INFO - Attempting internal recovery for broker 1
2025-05-06 13:20:59,785 - INFO - Triggering internal recovery for broker 1
2025-05-06 13:20:59,821 - INFO - Found 1 partitions on broker 1
2025-05-06 13:20:59,822 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 13:20:59,822 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 13:20:59,822 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 13:20:59,828 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 13:20:59,948 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:21:00,293 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 13:21:00,295 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 13:21:00,295 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 13:21:00,325 - INFO - Skipping recovery for kafka1:9092, last attempt 17.1s ago
2025-05-06 13:21:00,374 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:21:01,267 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:21:01,293 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:21:01,424 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:21:03,351 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:21:03,369 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:21:05,385 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:21:05,407 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:21:06,431 - INFO - Skipping recovery for kafka1:9092, last attempt 23.2s ago
2025-05-06 13:21:06,506 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:21:06,827 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:21:07,446 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:21:07,457 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:21:09,491 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:21:09,547 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:21:11,584 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:21:11,598 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:21:11,834 - INFO - Skipping recovery for kafka1:9092, last attempt 28.6s ago
2025-05-06 13:21:11,864 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:21:11,905 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:21:13,638 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:21:13,641 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:21:15,648 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:21:15,653 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:21:16,967 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:21:16,985 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:21:17,008 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:21:17,665 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:21:17,668 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:21:19,705 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:21:19,738 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:21:21,768 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:21:21,773 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:21:22,018 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:21:22,044 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:21:22,105 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:21:23,824 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:21:23,833 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:21:25,878 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:21:25,910 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:21:27,129 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:21:27,150 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:21:27,191 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:21:27,935 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:21:27,947 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:21:29,976 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:21:29,984 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:21:32,011 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:21:32,022 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:21:32,214 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:21:32,260 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:21:32,315 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:21:34,073 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:21:34,098 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:21:36,135 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:21:36,148 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:21:37,361 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:21:37,399 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:21:37,570 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:21:38,171 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:21:38,186 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:21:40,233 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:21:40,266 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:21:42,285 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:21:42,323 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:21:42,618 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:21:42,677 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:21:42,799 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:21:44,414 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:21:44,434 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:21:46,449 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:21:46,465 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:21:47,830 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:21:47,879 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:21:47,932 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:21:48,490 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:21:48,493 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:21:50,524 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:21:50,531 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:21:52,561 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:21:52,577 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:21:52,986 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:21:53,024 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:21:53,060 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:21:54,613 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:21:54,642 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:21:56,696 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:21:56,722 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:21:58,078 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:21:58,098 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:21:58,121 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:21:58,736 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:21:58,738 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:22:00,748 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:22:00,751 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:22:02,797 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:22:02,803 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:22:03,147 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:03,197 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:03,241 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:04,823 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:22:04,830 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:22:06,852 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:22:06,857 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:22:08,264 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:08,313 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:08,375 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:08,911 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:22:08,929 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:22:10,954 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:22:10,978 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:22:13,011 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:22:13,045 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:22:13,386 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:13,413 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:13,453 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:15,075 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:22:15,081 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:22:17,134 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:22:17,142 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:22:18,513 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:18,561 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:18,618 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:19,169 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:22:19,187 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:22:21,242 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:22:21,273 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:22:23,325 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:22:23,338 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:22:23,647 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:23,684 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:23,737 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:25,363 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:22:25,371 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:22:27,463 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:22:27,468 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:22:28,757 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:28,791 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:28,825 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:29,484 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:22:29,501 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:22:31,510 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:22:31,512 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:22:33,520 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:22:33,524 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:22:33,852 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:33,898 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:33,943 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:35,563 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:22:35,609 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:22:37,634 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:22:37,639 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:22:39,153 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:39,204 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:39,269 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:39,683 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:22:39,702 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:22:41,725 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:22:41,744 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:22:43,770 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:22:43,773 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:22:44,270 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 13:22:44,271 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 13:22:44,271 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 13:22:44,271 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 13:22:44,271 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: CONTROLLED_GRADUAL, mode: buffer
2025-05-06 13:22:44,290 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:44,290 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:44,326 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:44,326 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:44,330 - INFO - Using strategy buffer configuration
2025-05-06 13:22:44,344 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 13:22:44,498 - INFO - Successfully applied config to broker 2
2025-05-06 13:22:44,871 - INFO - Successfully applied config to broker 3
2025-05-06 13:22:45,135 - INFO - Successfully applied config to broker 1
2025-05-06 13:22:45,136 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 13:22:45,144 - INFO - Triggering leader election
2025-05-06 13:22:45,157 - INFO - Listing topics for leader election
2025-05-06 13:22:45,192 - INFO - Found 1 topics for leader election
2025-05-06 13:22:45,192 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 13:22:45,193 - INFO - Leader election completed in 0.04 seconds, success: False
2025-05-06 13:22:45,798 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:22:45,808 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:22:46,195 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 13:22:46,331 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:22:46,338 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:46,363 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:47,815 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:22:47,822 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:22:48,370 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:22:48,419 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:48,436 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:49,841 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:22:49,873 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:22:50,443 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:22:50,478 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:50,518 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:51,901 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:22:51,907 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:22:52,532 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:22:52,591 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:52,632 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:53,958 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:22:53,977 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:22:54,639 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:22:54,667 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:54,724 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:56,008 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:22:56,045 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:22:56,728 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:22:56,762 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:57,794 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:58,067 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:22:58,071 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:22:59,802 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:22:59,824 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:22:59,833 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:23:00,088 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:23:00,091 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:23:01,205 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 13:23:01,210 - INFO - Attempting broker recovery for kafka1
2025-05-06 13:23:01,210 - INFO - Attempting internal recovery for broker 1
2025-05-06 13:23:01,210 - INFO - Triggering internal recovery for broker 1
2025-05-06 13:23:01,240 - INFO - Found 1 partitions on broker 1
2025-05-06 13:23:01,243 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 13:23:01,243 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 13:23:01,243 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 13:23:01,245 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 13:23:01,276 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:23:01,428 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 13:23:01,428 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 13:23:01,428 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 13:23:01,834 - INFO - Skipping recovery for kafka1:9092, last attempt 17.6s ago
2025-05-06 13:23:01,847 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:23:01,864 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:23:02,106 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:23:02,108 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:23:04,153 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:23:04,158 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:23:06,188 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:23:06,210 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:23:06,870 - INFO - Skipping recovery for kafka1:9092, last attempt 22.6s ago
2025-05-06 13:23:06,911 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:23:06,981 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:23:08,233 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:23:08,249 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:23:10,284 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:23:10,289 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:23:11,989 - INFO - Skipping recovery for kafka1:9092, last attempt 27.7s ago
2025-05-06 13:23:12,048 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:23:12,079 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:23:12,322 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:23:12,330 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:23:14,347 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:23:14,350 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:23:16,359 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:23:16,384 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:23:17,109 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:23:17,119 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:23:17,132 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:23:18,409 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:23:18,414 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:23:20,441 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:23:20,446 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:23:22,163 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:23:22,207 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:23:22,256 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:23:22,488 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:23:22,556 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:23:24,629 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:23:24,659 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:23:26,729 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:23:26,779 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:23:27,286 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:23:27,324 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:23:27,353 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:23:28,808 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:23:28,816 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:23:30,836 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:23:30,840 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:23:32,373 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:23:32,393 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:23:32,424 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:23:32,860 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:23:32,865 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:23:34,879 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:23:34,885 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:23:36,910 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:23:36,919 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:23:37,445 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:23:37,474 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:23:37,509 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:23:38,948 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:23:38,988 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:23:41,032 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:23:41,136 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:23:42,536 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:23:42,587 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:23:42,610 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:23:43,329 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:23:43,379 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:23:45,394 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:23:45,412 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:23:47,434 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:23:47,442 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:23:47,642 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:23:47,668 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:23:47,694 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:23:49,461 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:23:49,477 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:23:51,503 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:23:51,542 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:23:52,725 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:23:52,763 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:23:52,803 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:23:53,603 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:23:53,631 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:23:55,673 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:23:55,700 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:23:57,772 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:23:57,784 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:23:57,854 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:23:57,911 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:23:57,986 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:23:59,798 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:23:59,807 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:24:01,817 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:24:01,820 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:24:03,004 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:03,029 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:03,058 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:03,832 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:24:03,836 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:24:05,882 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:24:05,902 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:24:07,980 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:24:08,085 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:24:08,175 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:08,251 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:08,367 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:10,134 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:24:10,148 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:24:12,199 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:24:12,253 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:24:13,441 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:13,492 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:13,555 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:14,294 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:24:14,330 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:24:16,365 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:24:16,384 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:24:18,425 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:24:18,442 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:24:18,616 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:18,707 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:19,054 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:20,475 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:24:20,487 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:24:22,502 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:24:22,508 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:24:24,079 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:24,100 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:24,132 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:24,524 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:24:24,528 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:24:26,552 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:24:26,562 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:24:28,596 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:24:28,638 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:24:29,152 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:29,206 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:29,239 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:30,668 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:24:30,728 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:24:32,751 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:24:32,757 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:24:34,270 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:34,330 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:34,362 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:34,774 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:24:34,805 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:24:36,840 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:24:36,845 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:24:38,909 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:24:38,925 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:24:39,419 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:39,482 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:39,528 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:40,952 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:24:40,957 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:24:42,986 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:24:43,005 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:24:44,543 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 13:24:44,543 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 13:24:44,543 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 13:24:44,544 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 13:24:44,544 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: RESOURCE_OPTIMIZED, mode: buffer
2025-05-06 13:24:44,572 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:44,579 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:44,599 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:44,626 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:44,627 - INFO - Using strategy buffer configuration
2025-05-06 13:24:44,634 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 13:24:45,018 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:24:45,027 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:24:45,320 - INFO - Successfully applied config to broker 2
2025-05-06 13:24:45,743 - INFO - Successfully applied config to broker 3
2025-05-06 13:24:46,325 - INFO - Successfully applied config to broker 1
2025-05-06 13:24:46,330 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 13:24:46,335 - INFO - Triggering leader election
2025-05-06 13:24:46,350 - INFO - Listing topics for leader election
2025-05-06 13:24:46,389 - INFO - Found 1 topics for leader election
2025-05-06 13:24:46,390 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 13:24:46,393 - INFO - Leader election completed in 0.04 seconds, success: False
2025-05-06 13:24:46,395 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 13:24:46,641 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:24:46,676 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:46,704 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:47,045 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:24:47,047 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:24:48,709 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:24:48,756 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:48,852 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:49,505 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:24:49,524 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:24:50,874 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:24:50,929 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:50,970 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:51,548 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:24:51,570 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:24:52,979 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:24:53,123 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:53,196 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:53,604 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:24:53,629 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:24:55,204 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:24:55,257 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:55,322 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:55,679 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:24:55,729 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:24:57,332 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:24:57,362 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:57,435 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:57,752 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:24:57,772 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:24:59,439 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:24:59,473 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:59,558 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:24:59,797 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:24:59,844 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:25:01,400 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 13:25:01,402 - INFO - Attempting broker recovery for kafka1
2025-05-06 13:25:01,404 - INFO - Attempting internal recovery for broker 1
2025-05-06 13:25:01,404 - INFO - Triggering internal recovery for broker 1
2025-05-06 13:25:01,505 - INFO - Found 1 partitions on broker 1
2025-05-06 13:25:01,505 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 13:25:01,505 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 13:25:01,505 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 13:25:01,562 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:25:01,845 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:25:01,924 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:25:01,985 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:25:02,017 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:25:02,522 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 13:25:02,636 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:25:02,709 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 13:25:02,717 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 13:25:02,718 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 13:25:03,927 - INFO - Skipping recovery for kafka1:9092, last attempt 19.4s ago
2025-05-06 13:25:03,987 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:25:04,040 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:25:04,058 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:25:04,091 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:25:06,119 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:25:06,154 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:25:09,083 - INFO - Skipping recovery for kafka1:9092, last attempt 24.5s ago
2025-05-06 13:25:09,294 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:25:09,362 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:25:09,619 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:25:09,670 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:25:11,701 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:25:11,775 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:25:13,849 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:25:13,896 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:25:14,369 - INFO - Skipping recovery for kafka1:9092, last attempt 29.8s ago
2025-05-06 13:25:14,701 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:25:14,996 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:25:15,943 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:25:16,016 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:25:18,057 - ERROR - API returned status code: 500
2025-05-06 13:25:20,088 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:25:20,111 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:25:20,165 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:25:20,202 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:25:20,245 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:25:22,200 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:25:22,237 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:25:24,261 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:25:24,337 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:25:25,272 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:25:26,364 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:25:26,368 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:25:27,924 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:25:28,023 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:25:28,409 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:25:28,428 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:25:30,466 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:25:30,478 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:25:32,507 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:25:32,532 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:25:34,074 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:25:34,128 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:25:34,190 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:25:34,559 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:25:34,596 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:25:36,640 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:25:36,648 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:25:38,679 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:25:38,686 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:25:39,232 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:25:39,285 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:25:39,309 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:25:40,712 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:25:40,717 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:25:42,791 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:25:42,795 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:25:44,333 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:25:44,377 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:25:44,416 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:25:44,816 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:25:44,841 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:25:46,868 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:25:46,885 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:25:48,953 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:25:48,966 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:25:49,441 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:25:49,474 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:25:49,514 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:25:51,013 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:25:51,125 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:25:53,166 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:25:53,185 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:25:54,578 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:25:54,643 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:25:54,706 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:25:55,273 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:25:55,296 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:25:57,343 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:25:57,409 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:25:59,449 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:25:59,469 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:25:59,727 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:25:59,757 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:25:59,781 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:26:01,491 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:26:01,503 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:26:03,534 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:26:03,551 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:26:04,874 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:26:04,905 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:26:04,945 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:26:05,583 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:26:05,595 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:26:07,699 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:26:07,734 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:26:09,781 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:26:09,833 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:26:10,056 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:26:10,087 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:26:10,117 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:26:11,862 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:26:11,900 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:26:13,910 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:26:13,916 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:26:15,144 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:26:15,167 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:26:15,206 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:26:15,934 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:26:15,940 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:26:17,946 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:26:17,950 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:26:19,972 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:26:19,982 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:26:20,227 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:26:20,253 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:26:20,278 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:26:22,005 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:26:22,010 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:26:24,050 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:26:24,076 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:26:25,309 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:26:25,358 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:26:25,431 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:26:26,128 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:26:26,177 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:26:28,216 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:26:28,263 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:26:30,283 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:26:30,290 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:26:30,451 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:26:30,511 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:26:30,546 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:26:32,309 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:26:32,320 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:26:34,335 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:26:34,369 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:26:35,609 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:26:35,666 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:26:35,765 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:26:36,410 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:26:36,502 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:26:38,534 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:26:38,544 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:26:40,603 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:26:40,634 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:26:40,952 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:26:41,181 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:26:41,278 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:26:42,627 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:26:42,677 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:26:44,687 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:26:44,695 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:26:46,254 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 13:26:46,257 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 13:26:46,267 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 13:26:46,268 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 13:26:46,268 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE, mode: buffer
2025-05-06 13:26:46,319 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:26:46,327 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:26:46,445 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:26:46,454 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:26:46,474 - INFO - Using strategy buffer configuration
2025-05-06 13:26:46,500 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 13:26:46,717 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:26:46,781 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:26:48,465 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:26:48,494 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:26:48,531 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:26:48,804 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:26:48,832 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:26:50,535 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:26:50,562 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:26:52,495 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:26:52,562 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:26:52,708 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:26:54,646 - INFO - Successfully applied config to broker 2
2025-05-06 13:26:54,942 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:26:55,038 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:26:55,711 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:26:55,895 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:26:56,067 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:26:57,913 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:26:58,060 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:26:58,070 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:26:58,125 - INFO - Successfully applied config to broker 3
2025-05-06 13:26:58,170 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:26:59,264 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:26:59,497 - INFO - Successfully applied config to broker 1
2025-05-06 13:26:59,501 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 13:26:59,505 - INFO - Triggering leader election
2025-05-06 13:26:59,543 - INFO - Listing topics for leader election
2025-05-06 13:26:59,587 - INFO - Found 1 topics for leader election
2025-05-06 13:26:59,587 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 13:26:59,589 - INFO - Leader election completed in 0.04 seconds, success: False
2025-05-06 13:26:59,608 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 13:27:00,114 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:27:00,234 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:27:02,248 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:27:02,290 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:27:02,312 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:27:02,322 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:27:02,366 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:27:04,324 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:27:04,327 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:27:04,375 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:27:04,425 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:27:04,481 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:27:06,354 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:27:06,374 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:27:06,485 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:27:06,529 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:27:07,582 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:27:08,401 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:27:08,406 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:27:09,599 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:27:09,635 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:27:09,653 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:27:10,440 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:27:10,492 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:27:11,658 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:27:11,717 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:27:11,766 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:27:12,522 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:27:12,575 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:27:13,801 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:27:13,888 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:27:13,930 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:27:14,607 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:27:14,626 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:27:14,645 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 13:27:14,647 - INFO - Attempting broker recovery for kafka1
2025-05-06 13:27:14,648 - INFO - Attempting internal recovery for broker 1
2025-05-06 13:27:14,648 - INFO - Triggering internal recovery for broker 1
2025-05-06 13:27:14,662 - INFO - Found 1 partitions on broker 1
2025-05-06 13:27:14,662 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 13:27:14,662 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 13:27:14,662 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 13:27:14,665 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 13:27:14,695 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:27:14,790 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 13:27:14,790 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 13:27:14,790 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 13:27:15,934 - INFO - Skipping recovery for kafka1:9092, last attempt 29.7s ago
2025-05-06 13:27:15,999 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:27:16,078 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:27:16,676 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:27:16,721 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:27:18,746 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:27:18,751 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:27:20,790 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:27:20,815 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:27:21,112 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:27:21,127 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:27:21,155 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:27:22,869 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:27:22,898 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:27:24,918 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:27:24,941 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:27:26,190 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:27:26,233 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:27:26,281 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:27:26,961 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:27:26,994 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:27:29,042 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:27:29,066 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:27:31,131 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:27:31,205 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:27:31,400 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:27:31,509 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:27:31,561 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:27:33,217 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:27:33,223 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:27:35,232 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:27:35,234 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:27:36,599 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:27:36,666 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:27:36,708 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:27:37,244 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:27:37,247 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:27:39,263 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:27:39,271 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:27:41,304 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:27:41,313 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:27:41,757 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:27:41,811 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:27:41,875 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:27:43,343 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:27:43,361 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:27:45,397 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:27:45,406 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:27:47,060 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:27:47,251 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:27:47,485 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:27:47,575 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:27:47,675 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:27:49,761 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:27:49,817 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:27:51,847 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:27:51,854 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:27:52,584 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:27:52,791 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:27:52,866 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:27:53,876 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:27:53,891 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:27:55,905 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:27:55,952 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:27:57,947 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:27:58,015 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:27:58,015 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:27:58,033 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:27:58,084 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:28:01,681 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:28:01,732 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:28:03,121 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:28:03,188 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:28:05,643 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:28:05,710 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:28:05,794 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:28:07,762 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:28:07,765 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:28:09,792 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:28:09,824 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:28:10,910 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:28:10,935 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:28:11,009 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:28:11,843 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:28:11,917 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:28:13,941 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:28:14,010 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:28:16,096 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:28:16,125 - ERROR - API returned status code: 500
2025-05-06 13:28:16,159 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:28:16,242 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:28:18,177 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:28:18,203 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:28:20,245 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:28:20,317 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:28:21,306 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:28:21,379 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:28:21,499 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:28:22,368 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:28:22,538 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:28:24,562 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:28:24,736 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:28:26,615 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:28:26,721 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:28:26,930 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:28:26,981 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:28:27,116 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:28:29,252 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:28:29,299 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:28:32,002 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:28:32,063 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:28:32,110 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:28:32,300 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:28:32,424 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:28:34,171 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:28:34,185 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:28:36,206 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:28:36,229 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:28:37,524 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:28:37,550 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:28:37,603 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:28:38,249 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:28:38,291 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:28:40,315 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:28:40,350 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:28:42,385 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:28:42,402 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:28:42,650 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:28:42,748 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:28:42,781 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:28:44,426 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:28:44,477 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:28:46,511 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:28:46,524 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:28:47,794 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 13:28:47,796 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 13:28:47,800 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 13:28:47,800 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 13:28:47,800 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: CONTROLLED_GRADUAL, mode: buffer
2025-05-06 13:28:47,831 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:28:47,831 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:28:47,885 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:28:47,902 - INFO - Using strategy buffer configuration
2025-05-06 13:28:47,927 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 13:28:48,047 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:28:48,545 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:28:48,568 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:28:48,758 - INFO - Successfully applied config to broker 2
2025-05-06 13:28:49,436 - INFO - Successfully applied config to broker 3
2025-05-06 13:28:50,039 - INFO - Successfully applied config to broker 1
2025-05-06 13:28:50,043 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 13:28:50,054 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:28:50,056 - INFO - Triggering leader election
2025-05-06 13:28:50,077 - INFO - Listing topics for leader election
2025-05-06 13:28:50,214 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:28:50,218 - INFO - Found 1 topics for leader election
2025-05-06 13:28:50,218 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 13:28:50,220 - INFO - Leader election completed in 0.14 seconds, success: False
2025-05-06 13:28:50,225 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 13:28:50,230 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:28:50,595 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:28:50,623 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:28:52,235 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:28:52,301 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:28:52,393 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:28:52,654 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:28:52,764 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:28:54,396 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:28:54,418 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:28:54,459 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:28:54,790 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:28:54,998 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:28:56,476 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:28:56,627 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:28:56,764 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:28:57,113 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:28:57,187 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:28:58,767 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:28:58,842 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:28:58,918 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:28:59,266 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:28:59,335 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:29:00,930 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:29:01,039 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:29:01,107 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:29:01,362 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:29:01,468 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:29:03,119 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:29:03,288 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:29:03,522 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:29:03,625 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:29:03,947 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:29:05,231 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 13:29:05,243 - INFO - Attempting broker recovery for kafka1
2025-05-06 13:29:05,252 - INFO - Attempting internal recovery for broker 1
2025-05-06 13:29:05,252 - INFO - Triggering internal recovery for broker 1
2025-05-06 13:29:05,375 - INFO - Found 1 partitions on broker 1
2025-05-06 13:29:05,375 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 13:29:05,376 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 13:29:05,376 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 13:29:05,377 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 13:29:05,534 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:29:05,726 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:29:06,033 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:29:06,228 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:29:06,320 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:29:06,339 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:29:06,450 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 13:29:06,451 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 13:29:06,451 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 13:29:08,347 - INFO - Skipping recovery for kafka1:9092, last attempt 20.6s ago
2025-05-06 13:29:08,373 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:29:08,386 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:29:08,414 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:29:08,524 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:29:10,431 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:29:10,489 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:29:12,541 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:29:12,607 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:29:13,530 - INFO - Skipping recovery for kafka1:9092, last attempt 25.7s ago
2025-05-06 13:29:13,711 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:29:13,829 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:29:14,631 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:29:14,643 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:29:16,713 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:29:16,730 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:29:18,758 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:29:18,769 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:29:18,958 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:29:19,025 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:29:19,086 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:29:21,838 - ERROR - API returned status code: 500
2025-05-06 13:29:23,897 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:29:23,942 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:29:24,143 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:29:24,207 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:29:24,264 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:29:26,076 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:29:26,110 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:29:28,231 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:29:28,411 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:29:29,368 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:29:29,455 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:29:29,504 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:29:30,467 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:29:30,627 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:29:32,677 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:29:32,684 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:29:34,749 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:29:34,750 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:29:34,852 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:29:34,927 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:29:35,012 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:29:36,977 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:29:37,012 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:29:39,039 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:29:39,067 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:29:40,092 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:29:40,148 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:29:40,227 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:29:41,098 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:29:41,125 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:29:43,180 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:29:43,207 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:29:45,251 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:29:45,297 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:29:45,341 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:29:45,387 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:29:45,448 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:29:47,340 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:29:47,405 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:29:50,071 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:29:50,120 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:29:50,556 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:29:50,627 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:29:50,694 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:29:52,175 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:29:52,217 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:29:54,331 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:29:54,355 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:29:55,805 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:29:55,888 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:29:55,968 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:29:56,392 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:29:56,441 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:29:58,476 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:29:58,492 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:30:00,579 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:30:00,666 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:30:01,106 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:30:01,191 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:30:01,254 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:30:02,721 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:30:02,738 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:30:04,757 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:30:04,779 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:30:06,374 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:30:06,434 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:30:06,559 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:30:06,833 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:30:06,937 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:30:08,978 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:30:08,985 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:30:11,093 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:30:11,170 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:30:13,182 - ERROR - API returned status code: 500
2025-05-06 13:30:13,318 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:30:13,696 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:30:13,860 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:30:15,216 - ERROR - API returned status code: 500
2025-05-06 13:30:17,252 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:30:17,331 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:30:18,907 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:30:19,010 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:30:19,120 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:30:19,353 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:30:19,357 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:30:21,384 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:30:21,399 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:30:23,426 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:30:23,437 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:30:24,163 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:30:25,223 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:30:25,395 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:30:25,457 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:30:25,479 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:30:27,541 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:30:27,573 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:30:29,653 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:30:29,711 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:30:30,438 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:30:30,534 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:30:30,584 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:30:31,741 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:30:31,762 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:30:33,798 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:30:33,835 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:30:35,650 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:30:35,738 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:30:35,810 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:30:35,885 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:30:36,104 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:30:38,152 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:30:38,232 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:30:40,308 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:30:40,409 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:30:40,953 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:30:41,332 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:30:41,537 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:30:42,452 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:30:42,554 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:30:44,586 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:30:44,750 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:30:46,683 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:30:46,813 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:30:46,839 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:30:46,873 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:30:47,135 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:30:48,909 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:30:48,925 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:30:50,995 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:30:51,019 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:30:52,147 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 13:30:52,167 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 13:30:52,169 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 13:30:52,170 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 13:30:52,170 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE, mode: buffer
2025-05-06 13:30:52,283 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:30:52,285 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:30:52,421 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:30:52,444 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:30:52,449 - INFO - Using strategy buffer configuration
2025-05-06 13:30:52,488 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 13:30:52,903 - INFO - Successfully applied config to broker 2
2025-05-06 13:30:53,322 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:30:53,361 - INFO - Successfully applied config to broker 3
2025-05-06 13:30:53,425 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:30:53,953 - INFO - Successfully applied config to broker 1
2025-05-06 13:30:53,955 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 13:30:53,981 - INFO - Triggering leader election
2025-05-06 13:30:53,994 - INFO - Listing topics for leader election
2025-05-06 13:30:54,139 - INFO - Found 1 topics for leader election
2025-05-06 13:30:54,141 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 13:30:54,142 - INFO - Leader election completed in 0.15 seconds, success: False
2025-05-06 13:30:54,170 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 13:30:54,457 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:30:54,468 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:30:54,515 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:30:55,481 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:30:55,536 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:30:56,521 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:30:56,645 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:30:56,763 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:30:57,602 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:30:57,768 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:30:58,782 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:30:58,897 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:30:59,008 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:30:59,835 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:30:59,908 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:31:01,033 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:31:01,225 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:31:01,311 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:31:02,018 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:31:02,038 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:31:03,323 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:31:03,409 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:31:03,471 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:31:04,329 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:31:04,389 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:31:05,482 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:31:05,519 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:31:05,603 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:31:06,417 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:31:06,422 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:31:07,605 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:31:07,702 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:31:07,792 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:31:08,446 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:31:08,450 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:31:09,295 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 13:31:09,295 - INFO - Attempting broker recovery for kafka1
2025-05-06 13:31:09,295 - INFO - Attempting internal recovery for broker 1
2025-05-06 13:31:09,295 - INFO - Triggering internal recovery for broker 1
2025-05-06 13:31:09,363 - INFO - Found 1 partitions on broker 1
2025-05-06 13:31:09,363 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 13:31:09,363 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 13:31:09,363 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 13:31:09,365 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 13:31:09,534 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:31:09,796 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:31:09,810 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 13:31:09,810 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 13:31:09,810 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 13:31:09,819 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:31:09,886 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:31:10,475 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:31:10,566 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:31:11,895 - INFO - Skipping recovery for kafka1:9092, last attempt 19.7s ago
2025-05-06 13:31:11,927 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:31:11,990 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:31:12,582 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:31:12,595 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:31:14,639 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:31:14,643 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:31:16,716 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:31:16,748 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:31:18,014 - INFO - Skipping recovery for kafka1:9092, last attempt 25.9s ago
2025-05-06 13:31:18,112 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:31:18,173 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:31:18,808 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:31:18,824 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:31:20,931 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:31:20,960 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:31:23,147 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:31:23,389 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:31:23,426 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:31:23,493 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:31:23,617 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:31:26,216 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:31:26,430 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:31:28,764 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:31:29,047 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:31:29,177 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:31:29,588 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:31:29,808 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:31:31,240 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:31:31,284 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:31:33,473 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:31:33,738 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:31:35,113 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:31:36,067 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:31:36,120 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:31:36,758 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:31:36,824 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:31:39,488 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:31:39,639 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:31:48,152 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:31:48,542 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:31:51,268 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:31:51,488 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:31:51,495 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:31:53,594 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:31:55,039 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:31:55,385 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:31:57,415 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:31:58,067 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:31:58,192 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:32:00,530 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-05-06 13:32:00,631 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:32:03,052 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:32:03,175 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:32:04,778 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:32:05,590 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:32:05,734 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:32:08,600 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:32:08,971 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:32:10,586 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:32:11,281 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:32:11,427 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:32:11,706 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:32:14,094 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:32:14,318 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:32:16,626 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:32:16,711 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:32:19,225 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:32:19,430 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:32:19,994 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:32:21,567 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:32:21,760 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:32:23,350 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:32:23,901 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:32:24,003 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:32:26,610 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:32:26,694 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:32:28,495 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:32:28,999 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:32:29,113 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:32:32,035 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:32:32,106 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:32:34,486 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:32:34,584 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:32:35,605 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:32:36,845 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:32:36,938 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:32:36,987 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:32:38,938 - INFO - Broker kafka3:9094 available. Broker IDs: [3, 1]
2025-05-06 13:32:39,877 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:32:39,988 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:32:42,194 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:32:42,525 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:32:44,672 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:32:44,780 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:32:46,435 - INFO - Broker kafka1:9092 available. Broker IDs: [3, 1]
2025-05-06 13:32:47,109 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:32:47,181 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:32:48,367 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:32:49,387 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:32:49,480 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:32:49,742 - INFO - Broker kafka3:9094 available. Broker IDs: [3, 1]
2025-05-06 13:32:51,664 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:32:51,915 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:32:54,167 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:32:54,264 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:32:55,778 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 13:32:55,783 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 13:32:55,925 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 13:32:55,928 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 13:32:55,928 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE, mode: buffer
2025-05-06 13:32:57,031 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:32:57,080 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:32:59,202 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:32:59,226 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:32:59,545 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:32:59,610 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:33:01,145 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:33:01,184 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:33:01,268 - INFO - Using strategy buffer configuration
2025-05-06 13:33:01,506 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 13:33:01,735 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:33:01,784 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:33:03,303 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:33:04,209 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:33:04,532 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:33:07,439 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:33:07,615 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:33:07,893 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:33:10,173 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:33:10,230 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:33:11,244 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:33:11,950 - INFO - Successfully applied config to broker 2
2025-05-06 13:33:12,356 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:33:12,411 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:33:12,667 - INFO - Successfully applied config to broker 3
2025-05-06 13:33:13,311 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:33:14,064 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:33:14,711 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:33:14,783 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:33:15,108 - INFO - Successfully applied config to broker 1
2025-05-06 13:33:15,108 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 13:33:15,117 - INFO - Triggering leader election
2025-05-06 13:33:15,129 - INFO - Listing topics for leader election
2025-05-06 13:33:15,249 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:33:15,506 - INFO - Found 1 topics for leader election
2025-05-06 13:33:15,518 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 13:33:15,519 - INFO - Leader election completed in 0.39 seconds, success: False
2025-05-06 13:33:15,529 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 13:33:16,983 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:33:17,244 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:33:17,259 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:33:18,019 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:33:18,214 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:33:19,331 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:33:19,379 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:33:20,220 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:33:20,367 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:33:21,482 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:33:21,589 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:33:21,592 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:33:23,614 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:33:23,676 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:33:23,681 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:33:23,705 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:33:23,767 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:33:25,760 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:33:25,773 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:33:25,829 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:33:25,854 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:33:25,900 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:33:27,876 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:33:27,901 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:33:27,902 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:33:27,928 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:33:27,955 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:33:29,919 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:33:29,924 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:33:29,962 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:33:29,987 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:33:30,002 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:33:30,541 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 13:33:30,542 - INFO - Attempting broker recovery for kafka1
2025-05-06 13:33:30,542 - INFO - Attempting internal recovery for broker 1
2025-05-06 13:33:30,542 - INFO - Triggering internal recovery for broker 1
2025-05-06 13:33:30,559 - INFO - Found 1 partitions on broker 1
2025-05-06 13:33:30,559 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 13:33:30,559 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 13:33:30,560 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 13:33:30,563 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 13:33:30,600 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:33:30,735 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 13:33:30,735 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 13:33:30,735 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 13:33:31,966 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:33:31,989 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:33:32,035 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:33:32,088 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:33:32,128 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:33:34,040 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:33:34,071 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:33:36,111 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:33:36,127 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:33:37,202 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:33:37,319 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:33:37,452 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:33:38,170 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:33:38,202 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:33:40,377 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:33:40,754 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:33:42,874 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:33:43,008 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:33:43,815 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:34:54,603 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:34:55,421 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:34:55,530 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:34:55,990 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:34:57,570 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:34:57,606 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:34:59,754 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:35:00,053 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:35:01,003 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 13:35:01,018 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 13:35:01,023 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 13:35:01,051 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 13:35:01,063 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE, mode: buffer
2025-05-06 13:35:01,167 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:35:01,172 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:35:01,250 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:35:02,190 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:35:02,205 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:35:02,243 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:35:02,254 - INFO - Using strategy buffer configuration
2025-05-06 13:35:02,282 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 13:35:02,696 - INFO - Successfully applied config to broker 2
2025-05-06 13:35:03,262 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:35:03,278 - INFO - Successfully applied config to broker 3
2025-05-06 13:35:03,474 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:35:03,538 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:35:04,074 - INFO - Successfully applied config to broker 1
2025-05-06 13:35:04,075 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 13:35:04,090 - INFO - Triggering leader election
2025-05-06 13:35:04,103 - INFO - Listing topics for leader election
2025-05-06 13:35:04,176 - INFO - Found 1 topics for leader election
2025-05-06 13:35:04,176 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 13:35:04,176 - INFO - Leader election completed in 0.07 seconds, success: False
2025-05-06 13:35:04,191 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 13:35:04,637 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:35:04,669 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:35:05,558 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:35:05,689 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:35:05,774 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:35:06,748 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:35:06,842 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:35:07,779 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:35:07,815 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:35:07,848 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:35:08,866 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:35:08,945 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:35:09,856 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:35:09,886 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:35:09,913 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:35:10,991 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:35:11,020 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:35:11,923 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:35:12,010 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:35:12,090 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:35:13,068 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:35:13,074 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:35:14,095 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:35:14,142 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:35:14,231 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:35:15,084 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:35:15,101 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:35:16,238 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:35:16,254 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:35:16,383 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:35:17,396 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:35:17,402 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:35:18,392 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:35:18,606 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:35:18,656 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:35:19,192 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 13:35:19,193 - INFO - Attempting broker recovery for kafka1
2025-05-06 13:35:19,193 - INFO - Attempting internal recovery for broker 1
2025-05-06 13:35:19,196 - INFO - Triggering internal recovery for broker 1
2025-05-06 13:35:19,218 - INFO - Found 1 partitions on broker 1
2025-05-06 13:35:19,225 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 13:35:19,226 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 13:35:19,232 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 13:35:19,235 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 13:35:19,383 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:35:19,418 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:35:19,449 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:35:19,544 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 13:35:19,544 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 13:35:19,544 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 13:35:20,657 - INFO - Skipping recovery for kafka1:9092, last attempt 19.7s ago
2025-05-06 13:35:20,674 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:35:20,719 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:35:21,490 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:35:21,504 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:35:23,537 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:35:23,576 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:35:25,637 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:35:25,653 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:35:25,747 - INFO - Skipping recovery for kafka1:9092, last attempt 24.7s ago
2025-05-06 13:35:25,871 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:35:25,931 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:35:27,693 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:35:27,717 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:35:29,756 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:35:29,762 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:35:30,939 - INFO - Skipping recovery for kafka1:9092, last attempt 29.9s ago
2025-05-06 13:35:31,010 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:35:31,045 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:35:31,802 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:35:31,809 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:35:33,900 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:35:33,927 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:35:35,995 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:35:36,035 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:35:36,178 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:35:36,294 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:35:36,466 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:35:38,201 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:35:38,279 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:35:40,516 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:35:40,532 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:35:41,684 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:35:41,807 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:35:41,854 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:35:42,584 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:35:42,606 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:35:44,977 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:35:45,022 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:35:46,917 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:35:46,983 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:35:47,037 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:35:47,065 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:35:47,122 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:35:49,153 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:35:49,196 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:35:51,210 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:35:51,213 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:35:53,068 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:35:53,097 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:35:53,121 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:35:53,245 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:35:53,272 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:36:06,150 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:36:06,155 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:36:08,190 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:36:08,209 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:36:09,034 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:36:09,091 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:36:09,126 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:36:10,254 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:36:10,270 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:36:12,308 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:36:12,314 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:36:14,158 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:36:14,191 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:36:14,332 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:36:14,334 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:36:15,248 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:36:16,353 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:36:16,361 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:36:18,377 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:36:18,379 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:36:20,277 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:36:20,306 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:36:20,329 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:36:20,402 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:36:20,430 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:36:22,439 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:36:22,453 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:36:24,575 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:36:24,621 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:36:25,423 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:36:25,482 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:36:25,594 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:36:26,678 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:36:26,711 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:36:28,807 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-05-06 13:36:29,137 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:36:30,772 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:36:30,839 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:36:30,918 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:36:31,193 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:36:31,249 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:36:33,330 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:36:33,380 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:36:50,735 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:36:50,750 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:36:51,298 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:36:51,458 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:36:51,516 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:36:52,801 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:36:52,810 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:36:54,834 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:36:54,837 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:36:56,544 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:36:56,579 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:36:56,592 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:36:56,851 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:36:56,854 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:36:58,862 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:36:58,900 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:37:00,929 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:37:00,932 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:37:01,596 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 13:37:01,599 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 13:37:01,608 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 13:37:01,611 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 13:37:01,611 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE, mode: buffer
2025-05-06 13:37:01,643 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:37:01,647 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:37:01,660 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:37:01,687 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:37:01,688 - INFO - Using strategy buffer configuration
2025-05-06 13:37:01,697 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 13:37:02,903 - INFO - Successfully applied config to broker 2
2025-05-06 13:37:02,963 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:37:03,004 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:37:03,525 - INFO - Successfully applied config to broker 3
2025-05-06 13:37:03,693 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:37:03,785 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:37:03,815 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:37:03,929 - INFO - Successfully applied config to broker 1
2025-05-06 13:37:03,930 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 13:37:04,957 - INFO - Triggering leader election
2025-05-06 13:37:04,963 - INFO - Listing topics for leader election
2025-05-06 13:37:05,005 - INFO - Found 1 topics for leader election
2025-05-06 13:37:05,005 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 13:37:05,006 - INFO - Leader election completed in 0.04 seconds, success: False
2025-05-06 13:37:05,010 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 13:37:05,052 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:37:05,078 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:37:05,820 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:37:05,868 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:37:05,886 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:37:07,114 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:37:07,143 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:37:07,888 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:37:07,930 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:37:07,953 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:37:09,172 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:37:09,192 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:37:09,958 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:37:09,976 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:37:09,999 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:37:11,209 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:37:11,229 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:37:12,008 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:37:12,025 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:37:12,038 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:37:13,250 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:37:13,276 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:37:14,043 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:37:14,060 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:37:14,083 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:37:15,292 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:37:15,323 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:37:16,087 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:37:16,102 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:37:16,114 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:37:17,344 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:37:17,367 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:37:18,119 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:37:18,151 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:37:18,178 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:37:19,392 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:37:19,402 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:37:20,014 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 13:37:20,016 - INFO - Attempting broker recovery for kafka1
2025-05-06 13:37:20,051 - INFO - Attempting internal recovery for broker 1
2025-05-06 13:37:20,062 - INFO - Triggering internal recovery for broker 1
2025-05-06 13:37:20,140 - INFO - Found 1 partitions on broker 1
2025-05-06 13:37:20,140 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 13:37:20,140 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 13:37:20,141 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 13:37:20,144 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 13:37:20,174 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:37:20,187 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:37:20,212 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:37:20,247 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:38:11,587 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 13:38:11,588 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 13:38:11,588 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 13:38:12,378 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:38:12,461 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:38:13,229 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:38:13,253 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:38:14,339 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:38:14,511 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:38:14,780 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:38:16,816 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:38:16,841 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:38:18,891 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:38:18,895 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:38:19,371 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:38:19,414 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:38:19,451 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:38:20,953 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:38:20,973 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:38:23,013 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:38:23,024 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:38:24,496 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:38:24,524 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:38:24,564 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:38:25,060 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:38:25,074 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:38:27,135 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:38:27,141 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:38:29,220 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:38:29,229 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:38:29,587 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:38:29,632 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:38:29,716 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:38:31,257 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:38:31,276 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:38:33,289 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:38:33,299 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:38:34,762 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:38:34,790 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:38:34,824 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:38:35,340 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:38:35,376 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:38:37,420 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:38:37,448 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:38:39,473 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:38:39,530 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:38:39,850 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:38:39,889 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:38:39,931 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:38:41,550 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:38:41,627 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:38:43,651 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:38:43,724 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:38:44,973 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:38:44,998 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:38:45,738 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:38:45,740 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:38:46,021 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:38:47,757 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:38:47,783 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:38:49,811 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:38:49,833 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:38:51,052 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:38:51,090 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:38:51,122 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:38:51,844 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:38:51,945 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:38:53,957 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:38:53,960 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:38:56,973 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:38:57,064 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:38:57,149 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:38:57,338 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:38:58,295 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:38:59,397 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:38:59,464 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:39:01,571 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:39:01,616 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:39:03,312 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 13:39:03,338 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery using buffer mode...
2025-05-06 13:39:03,344 - INFO - Starting recovery thread for kafka1:9092
2025-05-06 13:39:03,345 - INFO - Extracted broker ID 1 from container name kafka1
2025-05-06 13:39:03,345 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE, mode: buffer
2025-05-06 13:39:03,739 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:39:04,198 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:39:04,252 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:39:04,261 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:39:04,934 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:39:05,425 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:39:05,485 - INFO - Using strategy buffer configuration
2025-05-06 13:39:05,517 - INFO - Found broker IDs: [2, 3, 1]
2025-05-06 13:39:06,637 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:39:06,875 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:39:06,969 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:39:07,030 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:39:07,039 - INFO - Successfully applied config to broker 2
2025-05-06 13:39:07,197 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:39:08,150 - INFO - Successfully applied config to broker 3
2025-05-06 13:39:09,255 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:39:09,675 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:39:09,694 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:39:09,730 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:42:00,647 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:42:00,742 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:42:01,920 - INFO - Successfully applied config to broker 1
2025-05-06 13:42:01,928 - INFO - Applied configuration to all available brokers from buffer
2025-05-06 13:42:03,091 - INFO - Triggering leader election
2025-05-06 13:42:03,162 - INFO - Listing topics for leader election
2025-05-06 13:42:03,192 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:42:03,338 - INFO - Found 1 topics for leader election
2025-05-06 13:42:03,339 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 13:42:03,339 - INFO - Leader election completed in 0.18 seconds, success: False
2025-05-06 13:42:03,351 - INFO - Waiting 15 seconds for cluster to stabilize
2025-05-06 13:42:03,565 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:42:03,653 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:42:05,978 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:42:06,035 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:42:06,278 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:42:07,134 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:42:08,689 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:42:08,713 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:42:09,099 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:42:11,143 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:42:13,592 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:42:13,740 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:42:15,289 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:42:15,828 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:42:15,840 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:42:16,973 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:42:17,900 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:42:17,967 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:42:18,352 - INFO - Restarting broker kafka1 (ID: 1)
2025-05-06 13:42:18,353 - INFO - Attempting broker recovery for kafka1
2025-05-06 13:42:18,353 - INFO - Attempting internal recovery for broker 1
2025-05-06 13:42:18,353 - INFO - Triggering internal recovery for broker 1
2025-05-06 13:42:18,779 - INFO - Found 1 partitions on broker 1
2025-05-06 13:42:18,810 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-05-06 13:42:18,811 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-05-06 13:42:18,811 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-05-06 13:42:18,825 - INFO - Successfully triggered internal recovery for broker 1
2025-05-06 13:42:18,825 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-05-06 13:42:19,024 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-05-06 13:42:19,220 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:42:20,209 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:42:20,297 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:42:20,658 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:42:21,143 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:42:22,103 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-05-06 13:42:22,105 - INFO - Recovery successful for broker kafka1:9092
2025-05-06 13:42:22,105 - INFO - Recovery thread for kafka1:9092 completed
2025-05-06 13:42:22,362 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:42:22,392 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:42:22,706 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:42:23,927 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:42:23,999 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:42:25,160 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:42:25,215 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:42:27,244 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:42:27,251 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:42:29,047 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:42:29,079 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:42:29,103 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:42:29,291 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:42:29,297 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:42:31,321 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:42:31,325 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:42:33,345 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:42:33,372 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:42:34,150 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:42:35,189 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:42:35,237 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:42:35,400 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:42:35,410 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:42:37,451 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:42:37,474 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:42:39,520 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:42:39,549 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:42:40,285 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:42:40,324 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:42:40,352 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:42:41,575 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:42:41,578 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:42:43,593 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:42:43,595 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:42:45,483 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:42:45,606 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:42:45,709 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:42:45,739 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:42:45,747 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:42:47,787 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:42:47,791 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:42:49,804 - ERROR - API returned status code: 500
2025-05-06 13:42:50,754 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-05-06 13:42:50,776 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-05-06 13:42:50,799 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-05-06 13:42:51,823 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:42:51,826 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-05-06 13:42:53,838 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-05-06 13:42:53,840 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
