2025-04-26 21:01:09,229 - INFO - PRIMARY KAFKA BROKERS (for monitoring): ['kafka1:9092', 'kafka2:9093', 'kafka3:9094']
2025-04-26 21:01:09,230 - INFO - Container names: ['kafka1', 'kafka2', 'kafka3']
2025-04-26 21:01:09,230 - INFO - Alternative addresses (for connection attempts ONLY): ['kafka1:29092', 'kafka2:29093', 'kafka3:29094']
2025-04-26 21:01:09,235 - INFO - Starting Kafka Arms Controller
2025-04-26 21:01:09,252 - INFO - Started Prometheus metrics server on port 8002
2025-04-26 21:01:09,310 - INFO - Loaded strategy buffer: QUICK_REBALANCE
2025-04-26 21:01:09,336 - ERROR - Error fetching recovery strategy: HTTPConnectionPool(host='arms-classifier', port=5001): Max retries exceeded with url: /api/strategy (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffffb736a2e0>: Failed to establish a new connection: [Errno 111] Connection refused'))
2025-04-26 21:01:11,366 - ERROR - Error fetching recovery strategy: HTTPConnectionPool(host='arms-classifier', port=5001): Max retries exceeded with url: /api/strategy (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffffb731e280>: Failed to establish a new connection: [Errno 111] Connection refused'))
2025-04-26 21:01:13,274 - INFO - Monitoring these brokers ONLY: ['kafka1:9092', 'kafka2:9093', 'kafka3:9094']
2025-04-26 21:01:13,275 - INFO - TEST MODE ENABLED - Will simulate failures for kafka1:9092 every 60 seconds
2025-04-26 21:01:13,275 - INFO - Test mode initialized, broker kafka1:9092 will be tested on next check
2025-04-26 21:01:13,275 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:01:13,276 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:01:13,294 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:01:13,301 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:01:13,302 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE
2025-04-26 21:01:13,555 - ERROR - Error fetching recovery strategy: HTTPConnectionPool(host='arms-classifier', port=5001): Max retries exceeded with url: /api/strategy (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffffb736af70>: Failed to establish a new connection: [Errno 111] Connection refused'))
2025-04-26 21:01:15,619 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:01:15,662 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:01:17,698 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:01:17,795 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:01:20,091 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:01:20,158 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:01:22,261 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:01:22,346 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:01:23,540 - WARNING - Broker kafka2:9093 availability check failed: KafkaError{code=_TRANSPORT,val=-195,str="Failed to get metadata: Local: Broker transport failure"}
2025-04-26 21:01:23,554 - WARNING - Broker kafka2:9093 availability check failed: KafkaError{code=_TRANSPORT,val=-195,str="Failed to get metadata: Local: Broker transport failure"}
2025-04-26 21:01:24,369 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:01:24,421 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:01:26,485 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:01:26,492 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:01:28,541 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:01:28,584 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:01:30,638 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:01:30,669 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:01:32,773 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:01:32,802 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:01:33,626 - WARNING - Broker kafka1:29092 availability check failed: KafkaError{code=_TRANSPORT,val=-195,str="Failed to get metadata: Local: Broker transport failure"}
2025-04-26 21:01:34,562 - WARNING - Broker kafka1:29092 availability check failed: KafkaError{code=_TRANSPORT,val=-195,str="Failed to get metadata: Local: Broker transport failure"}
2025-04-26 21:01:34,843 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:01:34,935 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:01:37,054 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:01:37,113 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:01:39,426 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:01:39,445 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:01:41,484 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:01:41,556 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:01:43,669 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:01:43,672 - WARNING - Broker kafka2:29093 availability check failed: KafkaError{code=_TRANSPORT,val=-195,str="Failed to get metadata: Local: Broker transport failure"}
2025-04-26 21:01:43,751 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:01:44,574 - WARNING - Broker kafka2:29093 availability check failed: KafkaError{code=_TRANSPORT,val=-195,str="Failed to get metadata: Local: Broker transport failure"}
2025-04-26 21:01:45,863 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:01:46,036 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:01:48,475 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:01:48,635 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:01:51,481 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:01:51,592 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:01:54,067 - WARNING - Broker kafka3:29094 availability check failed: KafkaError{code=_TRANSPORT,val=-195,str="Failed to get metadata: Local: Broker transport failure"}
2025-04-26 21:01:54,850 - WARNING - Broker kafka3:29094 availability check failed: KafkaError{code=_TRANSPORT,val=-195,str="Failed to get metadata: Local: Broker transport failure"}
2025-04-26 21:01:55,176 - ERROR - All connection strategies failed for broker kafka2:9093
2025-04-26 21:01:55,376 - ERROR - All connection strategies failed for broker kafka2:9093
2025-04-26 21:01:56,939 - WARNING - Broker kafka2:9093 is unavailable. Triggering recovery...
2025-04-26 21:01:57,355 - INFO - Starting recovery thread for kafka2:9093
2025-04-26 21:01:57,513 - INFO - Extracted broker ID 2 from container name kafka2
2025-04-26 21:01:57,513 - INFO - Initiating recovery for broker kafka2:9093 (ID: 2) with strategy: CONTROLLED_GRADUAL
2025-04-26 21:01:58,471 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:01:58,554 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:02:00,773 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:02:00,796 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:02:01,537 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:02:03,064 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:02:03,228 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:02:06,070 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:02:06,244 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:02:07,039 - WARNING - Broker kafka3:9094 availability check failed: KafkaError{code=_TRANSPORT,val=-195,str="Failed to get metadata: Local: Broker transport failure"}
2025-04-26 21:02:08,540 - WARNING - Broker kafka3:9094 availability check failed: KafkaError{code=_TRANSPORT,val=-195,str="Failed to get metadata: Local: Broker transport failure"}
2025-04-26 21:02:09,297 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:02:09,802 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:02:10,922 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:02:10,925 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:02:10,965 - INFO - Using strategy buffer configuration
2025-04-26 21:02:11,812 - WARNING - Broker kafka3:9094 availability check failed: KafkaError{code=_TIMED_OUT,val=-185,str="Failed to get metadata: Local: Timed out"}
2025-04-26 21:02:12,713 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:02:12,909 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:02:13,480 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:02:14,201 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:02:14,322 - INFO - Skipping check for kafka2:9093 as it's currently in recovery
2025-04-26 21:02:14,540 - INFO - Using strategy buffer configuration
2025-04-26 21:02:15,522 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:02:16,053 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:02:16,146 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:02:16,114 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:02:16,425 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:02:18,598 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:02:18,666 - INFO - Skipping check for kafka2:9093 as it's currently in recovery
2025-04-26 21:02:19,043 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:02:19,278 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:02:20,714 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:02:21,466 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:02:21,517 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:02:22,800 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:02:22,834 - INFO - Skipping check for kafka2:9093 as it's currently in recovery
2025-04-26 21:02:23,762 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:02:23,838 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:02:24,107 - INFO - Successfully applied config to broker 2
2025-04-26 21:02:24,111 - INFO - Successfully applied config to broker 2
2025-04-26 21:02:24,425 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:02:25,971 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:02:26,020 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:02:26,448 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:02:26,459 - INFO - Skipping check for kafka2:9093 as it's currently in recovery
2025-04-26 21:02:27,171 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:02:28,211 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:02:28,284 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:02:28,994 - INFO - Successfully applied config to broker 3
2025-04-26 21:02:29,031 - INFO - Successfully applied config to broker 3
2025-04-26 21:02:29,186 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:02:29,192 - INFO - Skipping check for kafka2:9093 as it's currently in recovery
2025-04-26 21:02:30,596 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:02:30,599 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:02:30,779 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:02:32,719 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:02:32,722 - INFO - Skipping check for kafka2:9093 as it's currently in recovery
2025-04-26 21:02:32,723 - INFO - Successfully applied config to broker 1
2025-04-26 21:02:32,883 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:02:32,959 - INFO - Triggering leader election
2025-04-26 21:02:32,976 - INFO - Listing topics for leader election
2025-04-26 21:02:33,118 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:02:33,417 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:02:34,013 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:02:34,071 - INFO - Successfully applied config to broker 1
2025-04-26 21:02:34,073 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:02:34,110 - INFO - Triggering leader election
2025-04-26 21:02:34,118 - INFO - Listing topics for leader election
2025-04-26 21:02:34,250 - WARNING - No topics found for leader election
2025-04-26 21:02:34,282 - WARNING - No topics found for leader election
2025-04-26 21:02:34,298 - WARNING - Leader election not completely successful, but continuing recovery
2025-04-26 21:02:34,298 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:02:34,301 - WARNING - Leader election not completely successful, but continuing recovery
2025-04-26 21:02:34,301 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:02:35,863 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:02:35,931 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:02:36,074 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:02:36,075 - INFO - Skipping check for kafka2:9093 as it's currently in recovery
2025-04-26 21:02:36,444 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:02:38,065 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:02:38,073 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:02:38,471 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:02:38,472 - INFO - Skipping check for kafka2:9093 as it's currently in recovery
2025-04-26 21:02:39,476 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:02:40,204 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:02:40,277 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:02:41,524 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:02:41,529 - INFO - Skipping check for kafka2:9093 as it's currently in recovery
2025-04-26 21:02:41,805 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:02:42,458 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:02:42,479 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:02:43,877 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:02:43,935 - INFO - Skipping check for kafka2:9093 as it's currently in recovery
2025-04-26 21:02:44,310 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:02:44,763 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:02:44,921 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:02:46,332 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:02:46,341 - INFO - Skipping check for kafka2:9093 as it's currently in recovery
2025-04-26 21:02:46,852 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:02:47,169 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:02:47,201 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:02:48,914 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:02:48,917 - INFO - Skipping check for kafka2:9093 as it's currently in recovery
2025-04-26 21:02:49,015 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:02:49,255 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:02:49,259 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:02:49,333 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:02:49,335 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:02:49,335 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:02:49,335 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:02:49,377 - INFO - Restarting broker kafka2 (ID: 2)
2025-04-26 21:02:49,381 - INFO - Attempting broker recovery for kafka2
2025-04-26 21:02:49,383 - INFO - Attempting internal recovery for broker 2
2025-04-26 21:02:49,384 - INFO - Triggering internal recovery for broker 2
2025-04-26 21:02:49,497 - INFO - Found 1 partitions on broker 1
2025-04-26 21:02:49,497 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:02:49,498 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:02:49,498 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:02:49,516 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:02:49,517 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:02:49,658 - INFO - Found 1 partitions on broker 2
2025-04-26 21:02:49,659 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:02:49,661 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:02:49,663 - INFO - Successfully triggered internal recovery mechanisms for broker 2
2025-04-26 21:02:49,674 - INFO - Successfully triggered internal recovery for broker 2
2025-04-26 21:02:49,794 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:02:50,113 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:02:50,118 - INFO - Recovery successful for broker kafka2:9093
2025-04-26 21:02:50,126 - INFO - Recovery thread for kafka2:9093 completed
2025-04-26 21:02:51,020 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:02:51,132 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:02:51,242 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:02:51,436 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:02:51,449 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:02:51,606 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:02:51,736 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:02:51,737 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:02:51,737 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:02:53,334 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:02:53,379 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:02:53,440 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:02:53,605 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:02:53,645 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:02:55,750 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:02:55,770 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:02:57,791 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:02:57,807 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:02:58,521 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:02:58,552 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:02:58,665 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:02:59,839 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:02:59,857 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:03:01,901 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:03:01,910 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:03:03,738 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:03:03,756 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:03:03,793 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:03:03,940 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:03:03,994 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:03:06,048 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:03:06,098 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:03:08,185 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:03:08,206 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:03:08,862 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:03:08,917 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:03:08,995 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:03:10,309 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:03:10,386 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:03:16,383 - ERROR - API returned status code: 500
2025-04-26 21:03:18,554 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:03:18,556 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:03:18,588 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:03:19,943 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:03:20,454 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:03:20,687 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:03:20,725 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:03:22,766 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:03:22,838 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:03:24,865 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:03:24,923 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:03:25,576 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:03:25,646 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:03:25,736 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:03:26,935 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:03:26,947 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:03:29,002 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:03:29,012 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:03:30,794 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:03:30,850 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:03:30,913 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:03:31,048 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:03:31,057 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:03:33,104 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:03:33,116 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:03:35,136 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:03:35,217 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:03:36,038 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:03:36,128 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:03:36,232 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:03:37,286 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:03:37,306 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:03:39,368 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:03:39,381 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:03:41,315 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:03:41,422 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:03:41,528 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:03:41,532 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:03:41,547 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:03:43,650 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:03:43,673 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:03:45,853 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:03:45,924 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:03:46,644 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:03:46,708 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:03:46,795 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:03:47,943 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:03:47,964 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:03:50,156 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:03:50,245 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:03:51,816 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:03:51,820 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:03:51,822 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:03:51,823 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:03:51,823 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE
2025-04-26 21:03:51,858 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:03:51,862 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:03:51,957 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:03:51,957 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:03:51,981 - INFO - Using strategy buffer configuration
2025-04-26 21:03:51,998 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:03:52,352 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:03:52,416 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:03:52,476 - INFO - Successfully applied config to broker 2
2025-04-26 21:03:53,757 - INFO - Successfully applied config to broker 3
2025-04-26 21:03:53,987 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:03:54,392 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:03:54,520 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:03:54,578 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:03:54,579 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:03:54,695 - INFO - Successfully applied config to broker 1
2025-04-26 21:03:54,695 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:03:54,712 - INFO - Triggering leader election
2025-04-26 21:03:54,713 - INFO - Listing topics for leader election
2025-04-26 21:03:54,799 - INFO - Found 1 topics for leader election
2025-04-26 21:03:54,800 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:03:54,803 - INFO - Leader election completed in 0.09 seconds, success: False
2025-04-26 21:03:54,823 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:03:56,636 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:03:56,712 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:03:56,723 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:03:56,749 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:03:56,902 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:03:58,777 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:03:58,817 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:03:58,922 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:03:58,962 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:03:59,012 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:04:00,865 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:04:00,909 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:04:01,020 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:04:01,172 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:04:01,350 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:04:02,936 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:04:02,997 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:04:03,388 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:04:03,455 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:04:03,510 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:04:05,039 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:04:05,063 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:04:05,528 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:04:05,595 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:04:05,676 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:04:07,156 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:04:07,205 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:04:07,683 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:04:07,812 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:04:07,987 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:04:09,636 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:04:09,820 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:04:09,845 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:04:09,847 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:04:09,848 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:04:09,849 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:04:10,064 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:04:10,929 - INFO - Found 1 partitions on broker 1
2025-04-26 21:04:10,996 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:04:11,019 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:04:11,036 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:04:11,040 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:04:11,403 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:04:12,079 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:04:12,235 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:04:12,269 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:04:12,303 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:04:12,721 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:04:12,722 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:04:12,722 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:04:13,522 - INFO - Skipping recovery for kafka1:9092, last attempt 21.7s ago
2025-04-26 21:04:14,114 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:04:15,773 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:04:15,831 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:04:16,248 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:04:18,014 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:04:18,165 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:04:20,311 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:04:20,639 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:04:21,639 - INFO - Skipping recovery for kafka1:9092, last attempt 29.8s ago
2025-04-26 21:04:21,786 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:04:22,092 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:04:22,709 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:04:22,718 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:04:24,840 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:04:24,875 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:04:27,229 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:04:27,277 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:04:27,380 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:04:27,410 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:04:27,475 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:04:29,307 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:04:29,314 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:04:31,368 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:04:31,410 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:04:32,551 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:04:32,593 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:04:32,633 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:04:33,433 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:04:33,440 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:04:35,661 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:04:35,836 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:04:37,685 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:04:37,710 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:04:37,762 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:04:37,898 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:04:37,906 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:04:39,971 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:04:39,983 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:04:42,121 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:04:42,139 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:04:42,807 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:04:42,861 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:04:42,885 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:04:44,242 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:04:44,285 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:04:46,363 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:04:46,410 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:04:47,957 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:04:47,987 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:04:48,056 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:04:48,440 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:04:48,444 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:04:50,468 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:04:50,472 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:04:52,502 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:04:52,510 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:04:53,085 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:04:53,086 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:04:53,089 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:04:53,094 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:04:53,095 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE
2025-04-26 21:04:53,119 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:04:53,120 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:04:53,141 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:04:53,142 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:04:53,146 - INFO - Using strategy buffer configuration
2025-04-26 21:04:53,153 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:04:53,332 - INFO - Successfully applied config to broker 2
2025-04-26 21:04:53,477 - INFO - Successfully applied config to broker 3
2025-04-26 21:04:55,249 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:04:55,508 - INFO - Successfully applied config to broker 1
2025-04-26 21:04:55,509 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:04:55,581 - INFO - Triggering leader election
2025-04-26 21:04:55,583 - INFO - Listing topics for leader election
2025-04-26 21:04:55,590 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:04:55,881 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:04:55,851 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:04:55,992 - INFO - Found 1 topics for leader election
2025-04-26 21:04:55,993 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:04:55,994 - INFO - Leader election completed in 0.41 seconds, success: False
2025-04-26 21:04:56,011 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:04:56,103 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:04:58,125 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:04:58,291 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:04:58,478 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:04:58,701 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:04:58,930 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:00,781 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:05:00,840 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:05:00,949 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:05:01,033 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:01,118 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:02,879 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:05:02,882 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:05:03,125 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:05:03,137 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:03,156 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:04,892 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:05:04,896 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:05:05,160 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:05:05,168 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:05,191 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:06,917 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:05:06,924 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:05:07,199 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:05:07,207 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:07,214 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:08,936 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:05:08,939 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:05:09,218 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:05:09,226 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:09,264 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:10,962 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:05:10,964 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:05:11,028 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:05:11,028 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:05:11,028 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:05:11,029 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:05:11,040 - INFO - Found 1 partitions on broker 1
2025-04-26 21:05:11,040 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:05:11,040 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:05:11,040 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:05:11,041 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:05:11,072 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:11,124 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:05:11,124 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:05:11,124 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:05:11,268 - INFO - Skipping recovery for kafka1:9092, last attempt 18.2s ago
2025-04-26 21:05:11,272 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:11,282 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:13,026 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:05:13,032 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:05:15,052 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:05:15,057 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:05:16,285 - INFO - Skipping recovery for kafka1:9092, last attempt 23.2s ago
2025-04-26 21:05:16,318 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:16,380 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:17,089 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:05:17,116 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:05:19,146 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:05:19,149 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:05:21,168 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:05:21,172 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:05:21,395 - INFO - Skipping recovery for kafka1:9092, last attempt 28.3s ago
2025-04-26 21:05:21,406 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:21,432 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:23,192 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:05:23,197 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:05:25,212 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:05:25,216 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:05:26,465 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:26,478 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:26,518 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:27,243 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:05:27,245 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:05:29,256 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:05:29,260 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:05:31,263 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:05:31,266 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:05:31,557 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:31,570 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:31,579 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:33,412 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:05:33,419 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:05:35,467 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:05:35,476 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:05:36,602 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:36,618 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:36,655 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:37,484 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:05:37,489 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:05:39,520 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:05:39,523 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:05:41,614 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:05:41,634 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:05:41,722 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:41,761 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:41,783 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:43,951 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:05:44,005 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:05:46,069 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:05:46,077 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:05:46,818 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:46,836 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:46,901 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:48,109 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:05:48,134 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:05:50,196 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:05:50,217 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:05:51,961 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:51,981 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:52,027 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:52,270 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:05:52,276 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:05:54,353 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:05:54,420 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:05:56,450 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:05:56,455 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:05:57,032 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:05:57,032 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:05:57,033 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:05:57,033 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:05:57,033 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE
2025-04-26 21:05:57,046 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:57,046 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:57,105 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:57,106 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:57,114 - INFO - Using strategy buffer configuration
2025-04-26 21:05:57,122 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:05:57,211 - INFO - Successfully applied config to broker 2
2025-04-26 21:05:57,427 - INFO - Successfully applied config to broker 3
2025-04-26 21:05:58,413 - INFO - Successfully applied config to broker 1
2025-04-26 21:05:58,427 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:05:58,504 - INFO - Triggering leader election
2025-04-26 21:05:58,508 - INFO - Listing topics for leader election
2025-04-26 21:05:58,591 - INFO - Found 1 topics for leader election
2025-04-26 21:05:58,592 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:05:58,596 - INFO - Leader election completed in 0.09 seconds, success: False
2025-04-26 21:05:58,642 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:05:58,642 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:05:58,672 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:05:59,110 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:05:59,145 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:05:59,302 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:00,689 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:06:00,693 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:06:01,313 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:06:01,354 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:01,374 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:02,783 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:06:02,822 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:06:03,376 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:06:03,448 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:03,478 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:04,853 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:06:04,858 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:06:05,483 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:06:05,493 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:05,529 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:06,865 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:06:06,867 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:06:07,534 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:06:07,541 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:07,548 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:08,883 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:06:08,886 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:06:09,555 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:06:09,562 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:09,570 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:10,898 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:06:10,902 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:06:11,574 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:06:11,705 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:11,766 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:12,942 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:06:12,953 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:06:13,869 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:06:13,878 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:06:13,879 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:06:13,940 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:06:13,940 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:06:13,987 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:13,992 - INFO - Found 1 partitions on broker 1
2025-04-26 21:06:13,995 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:06:13,996 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:06:13,998 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:06:14,014 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:06:14,120 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:14,185 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:14,358 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:06:14,359 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:06:14,359 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:06:14,974 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:06:14,991 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:06:16,124 - INFO - Skipping recovery for kafka1:9092, last attempt 19.1s ago
2025-04-26 21:06:16,131 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:16,151 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:17,028 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:06:17,037 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:06:19,051 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:06:19,055 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:06:21,080 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:06:21,086 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:06:21,158 - INFO - Skipping recovery for kafka1:9092, last attempt 24.1s ago
2025-04-26 21:06:21,213 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:21,339 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:23,115 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:06:23,118 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:06:25,134 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:06:25,139 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:06:26,370 - INFO - Skipping recovery for kafka1:9092, last attempt 29.3s ago
2025-04-26 21:06:26,389 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:26,447 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:27,183 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:06:27,190 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:06:29,199 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:06:29,202 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:06:31,232 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:06:31,235 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:06:31,482 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:31,500 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:31,548 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:33,258 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:06:33,264 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:06:35,307 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:06:35,313 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:06:36,578 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:36,593 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:36,634 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:37,322 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:06:37,326 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:06:39,348 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:06:39,353 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:06:41,361 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:06:41,381 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:06:41,707 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:41,745 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:41,767 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:43,411 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:06:43,416 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:06:45,447 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:06:45,470 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:06:46,788 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:46,803 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:46,842 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:47,497 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:06:47,525 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:06:49,534 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:06:49,539 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:06:51,703 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:06:51,800 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:06:52,431 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:52,529 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:52,638 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:53,978 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:06:53,989 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:06:56,495 - ERROR - API returned status code: 500
2025-04-26 21:06:57,671 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:06:57,673 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:06:57,708 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:06:57,727 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:06:57,728 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE
2025-04-26 21:06:57,755 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:57,762 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:57,877 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:57,880 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:06:57,902 - INFO - Using strategy buffer configuration
2025-04-26 21:06:57,911 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:06:58,199 - INFO - Successfully applied config to broker 2
2025-04-26 21:06:58,816 - INFO - Successfully applied config to broker 3
2025-04-26 21:06:58,933 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:06:59,082 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:06:59,983 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:07:00,656 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:07:00,922 - INFO - Successfully applied config to broker 1
2025-04-26 21:07:00,926 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:07:01,395 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:07:01,489 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:07:01,883 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:07:01,973 - INFO - Triggering leader election
2025-04-26 21:07:02,077 - INFO - Listing topics for leader election
2025-04-26 21:07:02,149 - INFO - Found 1 topics for leader election
2025-04-26 21:07:02,150 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:07:02,150 - INFO - Leader election completed in 0.07 seconds, success: False
2025-04-26 21:07:02,157 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:07:03,592 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:07:03,604 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:07:03,896 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:07:03,968 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:07:03,998 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:07:05,651 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:07:05,660 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:07:06,018 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:07:06,035 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:07:06,116 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:07:07,681 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:07:07,685 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:07:08,122 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:07:08,135 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:07:08,153 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:07:09,702 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:07:09,705 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:07:10,156 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:07:10,166 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:07:10,175 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:07:11,713 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:07:11,716 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:07:12,180 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:07:12,190 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:07:12,197 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:07:13,732 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:07:13,737 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:07:14,201 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:07:14,209 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:07:14,223 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:07:15,750 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:07:15,753 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:07:16,226 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:07:16,252 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:07:16,266 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:07:17,165 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:07:17,166 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:07:17,166 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:07:17,166 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:07:17,179 - INFO - Found 1 partitions on broker 1
2025-04-26 21:07:17,180 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:07:17,181 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:07:17,181 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:07:17,185 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:07:17,201 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:07:17,238 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:07:17,239 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:07:17,239 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:07:17,763 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:07:17,768 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:07:18,270 - INFO - Skipping recovery for kafka1:9092, last attempt 20.6s ago
2025-04-26 21:07:18,278 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:07:18,287 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:07:19,779 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:07:19,782 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:07:21,811 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:07:21,814 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:07:23,296 - INFO - Skipping recovery for kafka1:9092, last attempt 25.6s ago
2025-04-26 21:07:23,311 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:07:23,323 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:07:23,843 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:07:23,860 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:07:25,870 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:07:25,873 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:07:27,903 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:07:27,930 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:07:28,350 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:07:28,395 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:07:28,424 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:07:29,943 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:07:29,949 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:07:32,069 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:07:32,096 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:07:33,499 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:07:33,626 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:07:33,658 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:07:34,180 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:07:34,194 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:07:36,223 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:07:36,233 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:07:38,258 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:07:38,264 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:07:38,684 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:07:38,734 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:07:38,755 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:07:40,284 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:07:40,289 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:07:42,354 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:07:42,387 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:07:44,202 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:07:44,286 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:07:44,345 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:07:44,585 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:07:44,707 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:07:47,306 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:07:47,354 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:07:49,537 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:07:49,540 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:07:49,603 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:07:49,665 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:07:49,792 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:07:51,631 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:07:51,641 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:07:53,690 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:07:53,706 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:07:54,884 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:07:54,900 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:07:54,944 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:07:55,721 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:07:55,748 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:07:57,794 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:07:57,801 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:07:59,840 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:07:59,868 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:07:59,949 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:07:59,952 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:07:59,954 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:07:59,961 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:07:59,962 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE
2025-04-26 21:08:00,097 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:00,099 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:00,149 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:00,151 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:00,163 - INFO - Using strategy buffer configuration
2025-04-26 21:08:00,179 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:08:00,333 - INFO - Successfully applied config to broker 2
2025-04-26 21:08:00,547 - INFO - Successfully applied config to broker 3
2025-04-26 21:08:00,881 - INFO - Successfully applied config to broker 1
2025-04-26 21:08:00,881 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:08:00,896 - INFO - Triggering leader election
2025-04-26 21:08:00,903 - INFO - Listing topics for leader election
2025-04-26 21:08:00,917 - INFO - Found 1 topics for leader election
2025-04-26 21:08:00,917 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:08:00,918 - INFO - Leader election completed in 0.01 seconds, success: False
2025-04-26 21:08:00,923 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:08:01,954 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:08:02,018 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:08:02,153 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:08:02,205 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:02,311 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:04,100 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:08:04,118 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:08:04,329 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:08:04,367 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:04,389 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:06,147 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:08:06,163 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:08:06,397 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:08:06,419 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:06,440 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:08,177 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:08:08,208 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:08:08,445 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:08:08,454 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:08,508 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:10,236 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:08:10,240 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:08:10,516 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:08:10,535 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:10,577 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:12,260 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:08:12,293 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:08:12,592 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:08:12,680 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:12,733 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:14,345 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:08:14,381 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:08:14,740 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:08:14,750 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:14,767 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:15,933 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:08:15,934 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:08:15,935 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:08:15,935 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:08:15,958 - INFO - Found 1 partitions on broker 1
2025-04-26 21:08:15,959 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:08:15,959 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:08:15,959 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:08:15,962 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:08:16,033 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:16,216 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:08:16,216 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:08:16,216 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:08:16,393 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:08:16,420 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:08:16,792 - INFO - Skipping recovery for kafka1:9092, last attempt 16.8s ago
2025-04-26 21:08:16,870 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:16,935 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:18,532 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:08:18,593 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:08:20,742 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:08:20,760 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:08:21,939 - INFO - Skipping recovery for kafka1:9092, last attempt 22.0s ago
2025-04-26 21:08:22,031 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:22,169 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:22,839 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:08:22,883 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:08:25,166 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:08:25,210 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:08:27,385 - INFO - Skipping recovery for kafka1:9092, last attempt 27.4s ago
2025-04-26 21:08:27,980 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:28,022 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:08:28,088 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:08:28,176 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:30,120 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:08:30,162 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:08:32,183 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:08:32,190 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:08:33,516 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:33,877 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:34,045 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:34,232 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:08:34,257 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:08:36,275 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:08:36,285 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:08:38,305 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:08:38,316 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:08:39,099 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:39,110 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:39,127 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:40,326 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:08:40,330 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:08:42,808 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:08:42,956 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:08:44,434 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:45,333 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:08:45,403 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:08:45,580 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:45,905 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:47,504 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:08:47,538 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:08:49,630 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:08:49,666 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:08:51,710 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:08:51,743 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:08:52,000 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:52,087 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:52,128 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:53,776 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:08:53,799 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:08:55,826 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:08:55,902 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:08:57,158 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:57,186 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:57,296 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:08:57,925 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:08:57,932 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:08:59,954 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:08:59,959 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:09:02,046 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:09:02,062 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:09:02,397 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:09:02,477 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:09:02,482 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:09:02,483 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:09:02,483 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: CONTROLLED_GRADUAL
2025-04-26 21:09:02,566 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:02,567 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:02,643 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:02,645 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:02,658 - INFO - Using strategy buffer configuration
2025-04-26 21:09:02,670 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:09:03,340 - INFO - Successfully applied config to broker 2
2025-04-26 21:09:04,350 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:09:04,432 - INFO - Successfully applied config to broker 3
2025-04-26 21:09:04,639 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:09:04,680 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:09:05,069 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:05,349 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:05,689 - INFO - Successfully applied config to broker 1
2025-04-26 21:09:05,689 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:09:05,767 - INFO - Triggering leader election
2025-04-26 21:09:05,776 - INFO - Listing topics for leader election
2025-04-26 21:09:05,828 - INFO - Found 1 topics for leader election
2025-04-26 21:09:05,829 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:09:05,830 - INFO - Leader election completed in 0.05 seconds, success: False
2025-04-26 21:09:05,860 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:09:06,926 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:09:06,977 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:09:07,394 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:09:07,465 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:07,640 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:09,020 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:09:09,060 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:09:09,664 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:09:09,709 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:09,783 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:11,083 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:09:11,142 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:09:11,811 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:09:11,895 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:11,988 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:13,244 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:09:13,253 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:09:14,012 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:09:14,333 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:14,420 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:15,326 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:09:15,334 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:09:16,429 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:09:16,453 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:16,498 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:17,391 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:09:17,432 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:09:18,504 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:09:18,514 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:18,526 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:19,448 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:09:19,451 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:09:20,545 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:09:20,588 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:20,709 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:20,880 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:09:20,883 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:09:20,885 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:09:20,886 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:09:20,915 - INFO - Found 1 partitions on broker 1
2025-04-26 21:09:20,915 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:09:20,915 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:09:20,915 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:09:20,921 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:09:21,082 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:21,326 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:09:21,347 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:09:21,348 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:09:21,615 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:09:21,636 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:09:22,720 - INFO - Skipping recovery for kafka1:9092, last attempt 20.4s ago
2025-04-26 21:09:22,835 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:22,900 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:23,713 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:09:23,844 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:09:26,175 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:09:26,248 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:09:27,908 - INFO - Skipping recovery for kafka1:9092, last attempt 25.6s ago
2025-04-26 21:09:28,032 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:28,274 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:28,299 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:09:28,312 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:09:30,360 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:09:30,373 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:09:32,426 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:09:32,442 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:09:33,413 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:33,494 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:33,563 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:34,478 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:09:34,530 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:09:36,579 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:09:36,656 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:09:38,887 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:38,956 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:09:38,995 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:09:39,078 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:39,133 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:41,019 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:09:41,023 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:09:43,038 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:09:43,046 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:09:44,277 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:44,845 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:45,929 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:09:46,000 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:46,073 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:09:48,346 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:09:48,383 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:09:50,617 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:09:50,675 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:09:51,140 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:51,181 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:51,299 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:52,937 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:09:53,133 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:09:55,369 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:09:55,466 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:09:56,568 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:56,826 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:57,266 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:09:57,649 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:09:57,738 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:10:00,498 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:10:00,531 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:10:02,418 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:10:02,642 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:10:02,682 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:10:02,739 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:10:02,858 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:20:03,143 - INFO - PRIMARY KAFKA BROKERS (for monitoring): ['kafka1:9092', 'kafka2:9093', 'kafka3:9094']
2025-04-26 21:20:03,145 - INFO - Container names: ['kafka1', 'kafka2', 'kafka3']
2025-04-26 21:20:03,145 - INFO - Alternative addresses (for connection attempts ONLY): ['kafka1:29092', 'kafka2:29093', 'kafka3:29094']
2025-04-26 21:20:03,146 - INFO - Starting Kafka Arms Controller
2025-04-26 21:20:03,151 - INFO - Started Prometheus metrics server on port 8002
2025-04-26 21:20:03,156 - INFO - Loaded strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:20:03,189 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:20:03,193 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:20:05,213 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:20:05,216 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:20:07,153 - INFO - Monitoring these brokers ONLY: ['kafka1:9092', 'kafka2:9093', 'kafka3:9094']
2025-04-26 21:20:07,156 - INFO - TEST MODE ENABLED - Will simulate failures for kafka1:9092 every 60 seconds
2025-04-26 21:20:07,156 - INFO - Test mode initialized, broker kafka1:9092 will be tested on next check
2025-04-26 21:20:07,157 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:20:07,158 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:20:07,165 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:20:07,166 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:20:07,166 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: CONTROLLED_GRADUAL
2025-04-26 21:20:07,243 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:20:07,246 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:20:09,486 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:20:09,499 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:20:11,572 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:20:11,592 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:20:13,665 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:20:13,669 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:20:15,702 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:20:15,757 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:20:17,215 - WARNING - Broker kafka2:9093 availability check failed: KafkaError{code=_TRANSPORT,val=-195,str="Failed to get metadata: Local: Broker transport failure"}
2025-04-26 21:20:17,235 - WARNING - Broker kafka2:9093 availability check failed: KafkaError{code=_TRANSPORT,val=-195,str="Failed to get metadata: Local: Broker transport failure"}
2025-04-26 21:20:17,864 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:20:17,901 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:20:20,061 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:20:20,150 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:20:22,288 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:20:22,447 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:20:24,589 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:20:24,608 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:20:26,661 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:20:26,676 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:20:27,253 - WARNING - Broker kafka1:29092 availability check failed: KafkaError{code=_TRANSPORT,val=-195,str="Failed to get metadata: Local: Broker transport failure"}
2025-04-26 21:20:27,253 - WARNING - Broker kafka1:29092 availability check failed: KafkaError{code=_TRANSPORT,val=-195,str="Failed to get metadata: Local: Broker transport failure"}
2025-04-26 21:20:28,710 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:20:28,715 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:20:30,805 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:20:30,834 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:20:32,289 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:20:32,298 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:20:32,615 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:20:32,634 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:20:32,899 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:20:33,025 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:20:33,732 - INFO - Using strategy buffer configuration
2025-04-26 21:20:34,042 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:20:34,636 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:20:34,820 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:20:34,924 - INFO - Successfully applied config to broker 2
2025-04-26 21:20:35,178 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:20:35,200 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:20:35,216 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:20:35,730 - INFO - Successfully applied config to broker 3
2025-04-26 21:20:36,424 - INFO - Successfully applied config to broker 1
2025-04-26 21:20:36,425 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:20:36,439 - INFO - Triggering leader election
2025-04-26 21:20:36,451 - INFO - Listing topics for leader election
2025-04-26 21:20:36,536 - INFO - Found 1 topics for leader election
2025-04-26 21:20:36,537 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:20:36,538 - INFO - Leader election completed in 0.09 seconds, success: False
2025-04-26 21:20:36,560 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:20:37,241 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:20:37,284 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:20:37,348 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:20:37,404 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:20:37,463 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:20:39,505 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:20:39,643 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:20:39,697 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:20:40,100 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:20:40,405 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:20:42,285 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:20:42,361 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:20:42,456 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:20:42,868 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:20:42,998 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:20:44,532 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:20:44,614 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:20:45,012 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:20:45,384 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:20:45,456 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:20:46,712 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:20:46,772 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:20:47,478 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:20:47,611 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:20:47,655 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:20:48,909 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:20:49,044 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:20:49,690 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:20:50,254 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:20:50,362 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:20:51,100 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:20:51,107 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:20:51,576 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:20:51,581 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:20:51,582 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:20:51,582 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:20:51,672 - INFO - Found 1 partitions on broker 1
2025-04-26 21:20:51,672 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:20:51,673 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:20:51,673 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:20:52,391 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:20:52,460 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:20:52,677 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:20:52,707 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:20:52,883 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:20:52,884 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:20:52,884 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:20:53,139 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:20:53,157 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:20:53,609 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:20:55,239 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:20:55,281 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:20:55,689 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:20:55,761 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:20:55,790 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:20:57,339 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:20:57,360 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:20:59,951 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:20:59,964 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:21:00,855 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:00,890 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:00,943 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:02,088 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:21:02,161 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:21:04,253 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:21:04,287 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:21:06,328 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:06,405 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:21:06,411 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:06,412 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:21:06,449 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:08,460 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:21:08,601 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:21:10,694 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:21:10,712 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:21:11,498 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:21:11,499 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:21:11,617 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:21:11,617 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:21:11,617 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE
2025-04-26 21:21:11,680 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:11,685 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:11,807 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:11,836 - INFO - Using strategy buffer configuration
2025-04-26 21:21:11,841 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:11,851 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:21:12,195 - INFO - Successfully applied config to broker 2
2025-04-26 21:21:12,510 - INFO - Successfully applied config to broker 3
2025-04-26 21:21:12,686 - INFO - Successfully applied config to broker 1
2025-04-26 21:21:12,687 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:21:12,700 - INFO - Triggering leader election
2025-04-26 21:21:12,705 - INFO - Listing topics for leader election
2025-04-26 21:21:12,753 - INFO - Found 1 topics for leader election
2025-04-26 21:21:12,754 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:21:12,754 - INFO - Leader election completed in 0.05 seconds, success: False
2025-04-26 21:21:12,757 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:21:12,811 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:21:12,829 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:21:13,848 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:21:13,915 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:13,980 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:14,839 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:21:14,846 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:21:15,989 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:21:16,046 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:16,081 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:16,916 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:21:16,948 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:21:18,086 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:21:18,102 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:18,122 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:18,994 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:21:19,016 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:21:20,126 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:21:20,141 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:20,159 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:21,114 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:21:21,120 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:21:22,168 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:21:22,199 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:22,302 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:23,177 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:21:23,231 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:21:24,437 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:21:24,503 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:24,653 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:25,273 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:21:25,281 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:21:26,700 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:21:26,884 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:27,765 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:21:27,768 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:21:27,768 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:21:27,768 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:21:27,885 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:21:27,956 - INFO - Found 1 partitions on broker 1
2025-04-26 21:21:27,956 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:21:27,956 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:21:27,956 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:21:28,025 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:21:28,036 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:28,071 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:21:28,171 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:28,306 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:21:28,306 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:21:28,306 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:21:30,057 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:21:30,071 - INFO - Skipping recovery for kafka1:9092, last attempt 18.6s ago
2025-04-26 21:21:30,083 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:21:30,110 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:30,142 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:32,120 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:21:32,125 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:21:34,138 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:21:34,160 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:21:35,146 - INFO - Skipping recovery for kafka1:9092, last attempt 23.6s ago
2025-04-26 21:21:35,174 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:35,200 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:36,265 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:21:36,290 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:21:38,313 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:21:38,323 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:21:40,213 - INFO - Skipping recovery for kafka1:9092, last attempt 28.7s ago
2025-04-26 21:21:40,262 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:40,336 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:40,396 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:21:40,454 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:21:42,570 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:21:42,663 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:21:44,695 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:21:44,726 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:21:45,412 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:45,429 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:45,462 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:46,740 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:21:46,747 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:21:48,779 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:21:48,785 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:21:50,515 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:50,556 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:50,611 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:50,808 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:21:50,826 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:21:53,123 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:21:53,149 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:21:55,344 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:21:55,366 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:21:56,883 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:56,998 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:57,098 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:21:57,495 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:21:57,537 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:21:59,680 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:21:59,694 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:22:01,836 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:22:01,852 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:22:03,148 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:03,257 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:03,307 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:03,981 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:22:04,102 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:22:06,643 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:22:06,741 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:22:08,400 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:08,443 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:08,506 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:08,841 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:22:08,858 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:22:10,887 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:22:10,896 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:22:13,159 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:22:13,240 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:22:13,518 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:22:13,521 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:22:13,524 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:22:13,542 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:22:13,542 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE
2025-04-26 21:22:13,646 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:13,649 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:13,721 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:14,742 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:14,756 - INFO - Using strategy buffer configuration
2025-04-26 21:22:14,771 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:22:15,064 - INFO - Successfully applied config to broker 2
2025-04-26 21:22:15,435 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:22:15,473 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:22:15,504 - INFO - Successfully applied config to broker 3
2025-04-26 21:22:15,728 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:22:15,878 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:16,045 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:16,134 - INFO - Successfully applied config to broker 1
2025-04-26 21:22:16,134 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:22:16,147 - INFO - Triggering leader election
2025-04-26 21:22:16,185 - INFO - Listing topics for leader election
2025-04-26 21:22:16,286 - INFO - Found 1 topics for leader election
2025-04-26 21:22:16,289 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:22:16,290 - INFO - Leader election completed in 0.11 seconds, success: False
2025-04-26 21:22:16,305 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:22:17,581 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:22:17,603 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:22:18,070 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:22:18,128 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:18,247 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:19,670 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:22:19,680 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:22:20,262 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:22:20,323 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:20,368 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:21,721 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:22:21,729 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:22:22,442 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:22:22,461 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:22,494 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:23,773 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:22:23,786 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:22:24,524 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:22:24,569 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:24,583 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:25,830 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:22:25,838 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:22:26,588 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:22:26,602 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:26,635 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:27,875 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:22:27,961 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:22:28,646 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:22:28,706 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:28,939 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:30,015 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:22:30,023 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:22:30,968 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:22:31,045 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:31,156 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:31,329 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:22:31,331 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:22:31,331 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:22:31,332 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:22:31,444 - INFO - Found 1 partitions on broker 1
2025-04-26 21:22:31,447 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:22:31,447 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:22:31,447 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:22:31,457 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:22:31,588 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:31,893 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:22:31,894 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:22:31,894 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:22:32,154 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:22:32,263 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:22:33,167 - INFO - Skipping recovery for kafka1:9092, last attempt 19.6s ago
2025-04-26 21:22:33,246 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:33,307 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:34,375 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:22:34,394 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:22:36,579 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:22:36,604 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:22:38,319 - INFO - Skipping recovery for kafka1:9092, last attempt 24.8s ago
2025-04-26 21:22:38,343 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:38,410 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:38,623 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:22:38,629 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:22:40,645 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:22:40,650 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:22:42,681 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:22:42,691 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:22:43,415 - INFO - Skipping recovery for kafka1:9092, last attempt 29.9s ago
2025-04-26 21:22:43,433 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:43,451 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:44,697 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:22:44,699 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:22:46,713 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:22:46,716 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:22:48,482 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:48,492 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:48,507 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:48,721 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:22:48,723 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:22:50,733 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:22:50,736 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:22:52,756 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:22:52,759 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:22:53,594 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:53,639 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:53,680 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:54,813 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:22:54,826 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:22:56,853 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:22:56,859 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:22:58,726 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:58,740 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:58,771 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:22:58,873 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:22:58,880 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:23:00,897 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:23:00,902 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:23:02,937 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:23:02,941 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:23:03,826 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:03,848 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:03,882 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:04,959 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:23:04,974 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:23:06,993 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:23:06,995 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:23:08,909 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:08,939 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:08,965 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:09,014 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:23:09,016 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:23:11,033 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:23:11,037 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:23:13,055 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:23:13,059 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:23:13,977 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:23:13,978 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:23:13,978 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:23:13,980 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:23:13,980 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE
2025-04-26 21:23:13,988 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:13,988 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:14,011 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:14,012 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:14,014 - INFO - Using strategy buffer configuration
2025-04-26 21:23:14,018 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:23:14,063 - INFO - Successfully applied config to broker 2
2025-04-26 21:23:14,105 - INFO - Successfully applied config to broker 3
2025-04-26 21:23:14,194 - INFO - Successfully applied config to broker 1
2025-04-26 21:23:14,194 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:23:14,196 - INFO - Triggering leader election
2025-04-26 21:23:14,197 - INFO - Listing topics for leader election
2025-04-26 21:23:14,209 - INFO - Found 1 topics for leader election
2025-04-26 21:23:14,209 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:23:14,209 - INFO - Leader election completed in 0.01 seconds, success: False
2025-04-26 21:23:14,212 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:23:15,082 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:23:15,087 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:23:16,017 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:23:16,028 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:16,038 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:17,100 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:23:17,104 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:23:18,047 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:23:18,054 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:18,065 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:19,130 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:23:19,133 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:23:20,069 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:23:20,083 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:20,094 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:21,145 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:23:21,147 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:23:22,097 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:23:22,102 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:22,110 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:23,161 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:23:23,166 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:23:24,115 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:23:24,123 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:24,130 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:25,252 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:23:25,283 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:23:26,133 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:23:26,189 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:26,231 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:27,299 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:23:27,305 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:23:28,233 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:23:28,238 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:28,248 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:29,226 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:23:29,228 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:23:29,228 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:23:29,228 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:23:29,242 - INFO - Found 1 partitions on broker 1
2025-04-26 21:23:29,242 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:23:29,242 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:23:29,242 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:23:29,243 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:23:29,258 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:29,284 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:23:29,285 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:23:29,285 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:23:29,313 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:23:29,315 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:23:30,249 - INFO - Skipping recovery for kafka1:9092, last attempt 16.3s ago
2025-04-26 21:23:30,254 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:30,267 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:31,319 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:23:31,320 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:23:33,325 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:23:33,329 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:23:35,275 - INFO - Skipping recovery for kafka1:9092, last attempt 21.3s ago
2025-04-26 21:23:35,299 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:35,314 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:35,343 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:23:35,346 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:23:37,358 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:23:37,361 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:23:39,374 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:23:39,377 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:23:40,319 - INFO - Skipping recovery for kafka1:9092, last attempt 26.3s ago
2025-04-26 21:23:40,333 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:40,352 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:41,383 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:23:41,397 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:23:43,411 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:23:43,430 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:23:45,383 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:45,400 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:45,415 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:45,435 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:23:45,438 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:23:47,459 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:23:47,463 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:23:49,472 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:23:49,487 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:23:50,448 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:50,463 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:50,478 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:51,500 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:23:51,515 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:23:53,540 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:23:53,567 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:23:55,512 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:55,520 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:55,533 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:23:55,572 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:23:55,577 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:23:57,604 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:23:57,609 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:23:59,625 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:23:59,629 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:24:00,552 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:00,574 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:00,599 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:01,637 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:24:01,640 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:24:03,652 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:24:03,655 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:24:05,637 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:05,648 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:05,664 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:24:05,664 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:05,678 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:24:07,703 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:24:07,717 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:24:09,735 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:24:09,751 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:24:10,691 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:10,704 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:10,715 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:11,756 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:24:11,758 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:24:13,768 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:24:13,771 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:24:15,725 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:24:15,728 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:24:15,729 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:24:15,732 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:24:15,733 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE
2025-04-26 21:24:15,743 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:15,743 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:15,780 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:15,782 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:24:15,789 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:24:15,790 - INFO - Using strategy buffer configuration
2025-04-26 21:24:15,790 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:15,791 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:24:15,812 - INFO - Successfully applied config to broker 2
2025-04-26 21:24:15,836 - INFO - Successfully applied config to broker 3
2025-04-26 21:24:15,885 - INFO - Successfully applied config to broker 1
2025-04-26 21:24:15,885 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:24:15,886 - INFO - Triggering leader election
2025-04-26 21:24:15,887 - INFO - Listing topics for leader election
2025-04-26 21:24:15,889 - INFO - Found 1 topics for leader election
2025-04-26 21:24:15,889 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:24:15,889 - INFO - Leader election completed in 0.00 seconds, success: False
2025-04-26 21:24:15,890 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:24:17,796 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:24:17,817 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:17,825 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:24:17,830 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:24:17,831 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:19,837 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:24:19,844 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:24:19,848 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:24:19,849 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:19,857 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:21,862 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:24:21,880 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:24:21,886 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:24:21,891 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:21,905 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:23,898 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:24:23,901 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:24:23,906 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:24:23,912 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:23,925 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:25,902 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:24:25,905 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:24:25,919 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:24:25,923 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:25,930 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:27,926 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:24:27,932 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:24:27,946 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:24:27,973 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:27,991 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:29,966 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:24:29,970 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:24:29,995 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:24:30,000 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:30,005 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:30,890 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:24:30,891 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:24:30,891 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:24:30,891 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:24:30,908 - INFO - Found 1 partitions on broker 1
2025-04-26 21:24:30,909 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:24:30,909 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:24:30,909 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:24:30,910 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:24:30,926 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:30,951 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:24:30,952 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:24:30,952 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:24:31,981 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:24:31,984 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:24:32,009 - INFO - Skipping recovery for kafka1:9092, last attempt 16.3s ago
2025-04-26 21:24:32,018 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:32,023 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:34,005 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:24:34,009 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:24:36,018 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:24:36,025 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:24:37,028 - INFO - Skipping recovery for kafka1:9092, last attempt 21.3s ago
2025-04-26 21:24:37,044 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:37,091 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:38,062 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:24:38,064 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:24:40,075 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:24:40,079 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:24:42,099 - INFO - Skipping recovery for kafka1:9092, last attempt 26.4s ago
2025-04-26 21:24:42,105 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:24:42,110 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:24:42,112 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:42,119 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:44,120 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:24:44,143 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:24:46,158 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:24:46,161 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:24:47,133 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:47,144 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:47,155 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:48,167 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:24:48,170 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:24:50,182 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:24:50,186 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:24:52,204 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:52,212 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:24:52,233 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:24:52,233 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:52,250 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:54,255 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:24:54,269 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:24:56,288 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:24:56,291 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:24:57,276 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:57,289 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:57,322 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:24:58,319 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:24:58,324 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:25:00,330 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:25:00,334 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:25:02,369 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:25:02,370 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:02,376 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:25:02,396 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:02,411 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:04,565 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:25:04,697 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:25:06,728 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:25:06,732 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:25:07,445 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:07,464 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:07,523 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:08,745 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:25:08,749 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:25:10,790 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:25:10,795 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:25:12,582 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:12,603 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:12,624 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:12,805 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:25:12,819 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:25:14,864 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:25:14,909 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:25:16,925 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:25:16,956 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:25:17,630 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:25:17,632 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:25:17,634 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:25:17,634 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:25:17,637 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE
2025-04-26 21:25:17,652 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:17,653 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:17,711 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:17,714 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:17,719 - INFO - Using strategy buffer configuration
2025-04-26 21:25:17,727 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:25:17,781 - INFO - Successfully applied config to broker 2
2025-04-26 21:25:17,896 - INFO - Successfully applied config to broker 3
2025-04-26 21:25:17,962 - INFO - Successfully applied config to broker 1
2025-04-26 21:25:17,962 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:25:17,964 - INFO - Triggering leader election
2025-04-26 21:25:17,967 - INFO - Listing topics for leader election
2025-04-26 21:25:17,996 - INFO - Found 1 topics for leader election
2025-04-26 21:25:17,997 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:25:18,002 - INFO - Leader election completed in 0.03 seconds, success: False
2025-04-26 21:25:18,010 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:25:18,987 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:25:18,994 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:25:19,720 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:25:19,744 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:19,769 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:21,004 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:25:21,021 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:25:21,779 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:25:21,789 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:21,797 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:23,134 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:25:23,147 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:25:23,802 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:25:23,848 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:23,906 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:25,207 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:25:25,250 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:25:25,908 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:25:25,930 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:26,008 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:27,344 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:25:27,371 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:25:28,018 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:25:28,038 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:28,095 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:29,661 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:25:29,700 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:25:30,098 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:25:30,139 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:30,189 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:31,737 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:25:31,757 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:25:32,196 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:25:32,203 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:32,214 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:33,026 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:25:33,028 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:25:33,029 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:25:33,032 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:25:33,099 - INFO - Found 1 partitions on broker 1
2025-04-26 21:25:33,101 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:25:33,101 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:25:33,101 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:25:33,105 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:25:33,137 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:33,191 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:25:33,192 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:25:33,192 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:25:33,782 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:25:33,793 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:25:34,217 - INFO - Skipping recovery for kafka1:9092, last attempt 16.6s ago
2025-04-26 21:25:34,243 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:34,271 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:35,879 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:25:35,943 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:25:37,997 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:25:38,015 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:25:39,276 - INFO - Skipping recovery for kafka1:9092, last attempt 21.6s ago
2025-04-26 21:25:39,501 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:39,735 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:40,127 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:25:40,135 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:25:42,181 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:25:42,189 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:25:44,201 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:25:44,208 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:25:44,748 - INFO - Skipping recovery for kafka1:9092, last attempt 27.1s ago
2025-04-26 21:25:44,811 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:44,840 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:46,268 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:25:46,275 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:25:48,289 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:25:48,299 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:25:49,910 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:49,936 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:49,987 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:50,342 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:25:50,346 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:25:52,369 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:25:52,377 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:25:54,445 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:25:54,490 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:25:55,048 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:55,068 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:55,096 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:25:56,518 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:25:56,525 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:25:58,561 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:25:58,566 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:26:00,231 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:00,302 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:00,344 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:00,614 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:26:00,649 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:26:02,726 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:26:02,745 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:26:04,808 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:26:04,826 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:26:05,422 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:05,441 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:05,475 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:06,857 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:26:06,873 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:26:09,078 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:26:09,146 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:26:10,640 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:10,665 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:10,695 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:11,188 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:26:11,199 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:26:13,287 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:26:13,307 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:26:15,332 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:26:15,339 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:26:15,789 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:15,850 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:15,986 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:17,387 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:26:17,462 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:26:19,511 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:26:19,548 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:26:21,007 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:26:21,009 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:26:21,010 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:26:21,011 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:26:21,012 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: CONTROLLED_GRADUAL
2025-04-26 21:26:21,107 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:21,108 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:21,173 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:21,178 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:21,596 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:26:21,610 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:26:22,188 - INFO - Using strategy buffer configuration
2025-04-26 21:26:22,197 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:26:22,362 - INFO - Successfully applied config to broker 2
2025-04-26 21:26:22,497 - INFO - Successfully applied config to broker 3
2025-04-26 21:26:22,693 - INFO - Successfully applied config to broker 1
2025-04-26 21:26:22,693 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:26:23,185 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:26:23,205 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:23,234 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:23,641 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:26:23,648 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:26:23,699 - INFO - Triggering leader election
2025-04-26 21:26:23,701 - INFO - Listing topics for leader election
2025-04-26 21:26:23,711 - INFO - Found 1 topics for leader election
2025-04-26 21:26:23,711 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:26:23,711 - INFO - Leader election completed in 0.01 seconds, success: False
2025-04-26 21:26:24,722 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:26:25,246 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:26:25,263 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:25,280 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:25,661 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:26:25,665 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:26:27,289 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:26:27,470 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:27,601 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:27,839 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:26:27,857 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:26:29,606 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:26:29,771 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:29,924 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:30,107 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:26:30,159 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:26:32,018 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:26:32,091 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:32,154 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:32,234 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:26:32,253 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:26:34,163 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:26:34,173 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:34,183 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:34,263 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:26:34,268 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:26:36,188 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:26:36,214 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:36,350 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:36,376 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:26:36,381 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:26:38,359 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:26:38,411 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:38,441 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:26:38,477 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:26:38,491 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:39,747 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:26:39,752 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:26:39,752 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:26:39,753 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:26:39,781 - INFO - Found 1 partitions on broker 1
2025-04-26 21:26:39,782 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:26:39,782 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:26:39,782 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:26:40,496 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:26:40,504 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:26:40,514 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:26:40,518 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:40,542 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:40,794 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:26:40,836 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:40,928 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:26:40,929 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:26:40,930 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:26:42,539 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:26:42,549 - INFO - Skipping recovery for kafka1:9092, last attempt 21.5s ago
2025-04-26 21:26:42,577 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:26:42,643 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:42,744 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:44,602 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:26:44,608 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:26:46,739 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:26:46,761 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:26:47,753 - INFO - Skipping recovery for kafka1:9092, last attempt 26.7s ago
2025-04-26 21:26:47,811 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:47,933 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:48,787 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:26:48,816 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:26:50,846 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:26:50,851 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:26:52,874 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:26:52,879 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:26:52,982 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:53,005 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:53,062 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:54,904 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:26:54,974 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:26:57,012 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:26:57,025 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:26:58,182 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:58,284 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:58,378 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:26:59,066 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:26:59,076 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:27:01,113 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:27:01,125 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:27:03,259 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:27:03,319 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:27:03,491 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:27:03,653 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:27:03,766 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:27:05,467 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:27:05,508 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:27:07,526 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:27:07,537 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:27:08,830 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:27:09,547 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:27:09,553 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:27:09,926 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:27:10,086 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:27:11,621 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:27:11,628 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:27:13,651 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:27:13,662 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:27:15,381 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:27:15,417 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:27:15,461 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:27:15,675 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:27:15,682 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:27:17,711 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:27:17,718 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:27:19,752 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:27:19,758 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:27:21,469 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:27:21,475 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:27:21,479 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:27:21,481 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:27:21,484 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE
2025-04-26 21:27:21,653 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:27:21,653 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:27:21,745 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:27:21,760 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:27:21,873 - INFO - Using strategy buffer configuration
2025-04-26 21:27:21,882 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:27:21,924 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:27:21,930 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:27:22,344 - INFO - Successfully applied config to broker 2
2025-04-26 21:27:22,619 - INFO - Successfully applied config to broker 3
2025-04-26 21:27:22,882 - INFO - Successfully applied config to broker 1
2025-04-26 21:27:22,884 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:27:22,889 - INFO - Triggering leader election
2025-04-26 21:27:22,892 - INFO - Listing topics for leader election
2025-04-26 21:27:22,917 - INFO - Found 1 topics for leader election
2025-04-26 21:27:22,919 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:27:22,926 - INFO - Leader election completed in 0.03 seconds, success: False
2025-04-26 21:27:23,891 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:27:23,917 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:27:23,943 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:27:23,965 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:27:24,014 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:27:24,019 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:27:26,050 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:27:26,167 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:27:26,185 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:27:26,335 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:27:26,483 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:27:28,235 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:27:28,283 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:27:28,490 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:27:28,518 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:27:28,592 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:27:30,361 - ERROR - API returned status code: 500
2025-04-26 21:27:30,599 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:27:30,677 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:27:30,775 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:27:32,386 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:27:32,399 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:27:32,783 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:27:32,897 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:27:33,027 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:27:34,416 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:27:34,434 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:27:35,036 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:27:35,220 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:27:35,595 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:27:36,490 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:27:36,536 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:27:38,609 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:27:38,824 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:27:38,870 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:27:38,931 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:27:38,956 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:27:38,956 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:27:38,957 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:27:38,957 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:27:39,038 - INFO - Found 1 partitions on broker 1
2025-04-26 21:27:39,042 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:27:39,042 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:27:39,042 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:27:39,054 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:27:39,169 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:27:39,273 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:27:39,399 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:27:39,400 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:27:39,400 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:27:41,020 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:27:41,062 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:27:41,179 - INFO - Skipping recovery for kafka1:9092, last attempt 19.7s ago
2025-04-26 21:27:41,244 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:27:42,416 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:27:43,131 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:27:43,206 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:27:45,227 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:27:45,308 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:27:47,418 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:27:47,435 - INFO - Skipping recovery for kafka1:9092, last attempt 26.0s ago
2025-04-26 21:27:47,491 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:27:47,574 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:27:47,640 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:27:49,514 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:27:49,519 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:27:51,539 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:27:51,557 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:27:52,746 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:27:52,776 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:27:52,840 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:27:53,610 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:27:53,616 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:27:55,737 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:27:55,785 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:27:57,804 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:27:57,810 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:27:57,866 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:27:57,882 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:27:57,938 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:27:59,834 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:27:59,840 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:28:02,426 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:28:02,491 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:28:03,165 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:03,368 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:03,637 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:04,802 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:28:04,858 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:28:06,970 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:28:06,983 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:28:08,791 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:09,031 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:28:09,057 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:28:09,820 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:09,872 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:11,071 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:28:11,082 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:28:13,156 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:28:13,178 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:28:14,990 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:15,013 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:15,034 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:15,193 - ERROR - API returned status code: 500
2025-04-26 21:28:17,286 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:28:17,344 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:28:19,418 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:28:19,436 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:28:20,068 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:20,095 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:20,179 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:21,542 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:28:21,554 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:28:23,607 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:28:23,623 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:28:25,181 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:28:25,191 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:28:25,195 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:28:25,195 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:28:25,195 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: CONTROLLED_GRADUAL
2025-04-26 21:28:25,234 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:25,240 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:25,297 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:25,299 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:25,308 - INFO - Using strategy buffer configuration
2025-04-26 21:28:25,315 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:28:25,688 - INFO - Successfully applied config to broker 2
2025-04-26 21:28:25,746 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:28:25,819 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:28:26,066 - INFO - Successfully applied config to broker 3
2025-04-26 21:28:26,699 - INFO - Successfully applied config to broker 1
2025-04-26 21:28:26,702 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:28:26,706 - INFO - Triggering leader election
2025-04-26 21:28:26,721 - INFO - Listing topics for leader election
2025-04-26 21:28:26,743 - INFO - Found 1 topics for leader election
2025-04-26 21:28:26,745 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:28:26,752 - INFO - Leader election completed in 0.03 seconds, success: False
2025-04-26 21:28:26,785 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:28:27,310 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:28:27,335 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:27,357 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:27,854 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:28:27,889 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:28:29,365 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:28:29,406 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:29,433 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:29,931 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:28:29,939 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:28:31,442 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:28:31,464 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:31,495 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:31,962 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:28:31,975 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:28:33,503 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:28:33,603 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:33,624 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:34,030 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:28:34,039 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:28:35,627 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:28:35,644 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:35,664 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:36,051 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:28:36,056 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:28:37,667 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:28:37,678 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:37,692 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:38,077 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:28:38,091 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:28:39,696 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:28:39,709 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:39,726 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:40,102 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:28:40,134 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:28:41,730 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:28:41,746 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:41,767 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:41,806 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:28:41,806 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:28:41,807 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:28:41,807 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:28:41,815 - INFO - Found 1 partitions on broker 1
2025-04-26 21:28:41,816 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:28:41,816 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:28:41,816 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:28:41,818 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:28:41,850 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:41,925 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:28:41,926 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:28:41,926 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:28:42,161 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:28:42,167 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:28:43,770 - INFO - Skipping recovery for kafka1:9092, last attempt 18.6s ago
2025-04-26 21:28:43,797 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:43,843 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:44,189 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:28:44,201 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:28:46,260 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:28:46,274 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:28:48,344 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:28:48,394 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:28:48,847 - INFO - Skipping recovery for kafka1:9092, last attempt 23.7s ago
2025-04-26 21:28:48,894 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:48,932 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:50,415 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:28:50,479 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:28:52,490 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:28:52,493 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:28:53,934 - INFO - Skipping recovery for kafka1:9092, last attempt 28.8s ago
2025-04-26 21:28:53,952 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:53,977 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:54,540 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:28:54,551 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:28:56,620 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:28:56,635 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:28:58,672 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:28:58,760 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:28:59,028 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:59,050 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:28:59,145 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:00,786 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:29:00,790 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:29:02,812 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:29:02,818 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:29:04,232 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:04,271 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:04,366 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:04,841 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:29:04,846 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:29:06,875 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:29:06,895 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:29:08,918 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:29:08,926 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:29:09,409 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:09,438 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:09,493 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:10,948 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:29:10,952 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:29:12,985 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:29:13,030 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:29:14,612 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:14,687 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:14,730 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:15,118 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:29:15,131 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:29:17,194 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:29:17,205 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:29:19,232 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:29:19,237 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:29:19,806 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:19,840 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:19,892 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:21,285 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:29:21,342 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:29:23,358 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:29:23,409 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:29:24,992 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:25,018 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:25,038 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:25,433 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:29:25,437 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:29:27,470 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:29:27,553 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:29:29,591 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:29:29,674 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:29:30,045 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:29:30,048 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:29:30,059 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:29:30,063 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:29:30,064 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: CONTROLLED_GRADUAL
2025-04-26 21:29:30,134 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:30,135 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:30,233 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:30,236 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:30,243 - INFO - Using strategy buffer configuration
2025-04-26 21:29:30,255 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:29:30,362 - INFO - Successfully applied config to broker 2
2025-04-26 21:29:30,456 - INFO - Successfully applied config to broker 3
2025-04-26 21:29:30,543 - INFO - Successfully applied config to broker 1
2025-04-26 21:29:30,544 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:29:30,550 - INFO - Triggering leader election
2025-04-26 21:29:30,551 - INFO - Listing topics for leader election
2025-04-26 21:29:30,557 - INFO - Found 1 topics for leader election
2025-04-26 21:29:30,557 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:29:30,557 - INFO - Leader election completed in 0.01 seconds, success: False
2025-04-26 21:29:30,560 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:29:31,711 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:29:31,763 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:29:32,241 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:29:32,259 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:32,277 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:33,771 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:29:33,777 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:29:34,281 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:29:34,287 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:34,296 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:35,802 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:29:35,807 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:29:36,298 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:29:36,317 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:37,380 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:37,842 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:29:37,864 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:29:39,389 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:29:39,423 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:39,519 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:39,888 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:29:39,894 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:29:41,529 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:29:41,543 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:41,552 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:41,911 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:29:41,930 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:29:43,554 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:29:43,564 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:43,576 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:43,953 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:29:43,957 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:29:45,568 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:29:45,569 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:29:45,569 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:29:45,570 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:29:45,579 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:29:45,582 - INFO - Found 1 partitions on broker 1
2025-04-26 21:29:45,582 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:29:45,582 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:29:45,582 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:29:45,584 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:29:45,587 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:45,628 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:45,645 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:45,712 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:29:45,713 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:29:45,713 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:29:45,996 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:29:46,029 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:29:47,637 - INFO - Skipping recovery for kafka1:9092, last attempt 17.6s ago
2025-04-26 21:29:47,684 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:47,719 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:48,111 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:29:48,123 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:29:50,407 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:29:50,495 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:29:52,664 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:29:52,725 - INFO - Skipping recovery for kafka1:9092, last attempt 22.7s ago
2025-04-26 21:29:52,761 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:29:52,829 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:53,024 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:54,791 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:29:54,810 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:29:57,321 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:29:57,465 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:29:58,027 - INFO - Skipping recovery for kafka1:9092, last attempt 28.0s ago
2025-04-26 21:29:58,311 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:58,528 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:29:59,647 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:29:59,679 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:30:01,775 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:30:01,902 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:30:04,072 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:30:04,091 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:30:04,190 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:30:04,371 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:30:04,682 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:30:06,484 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:30:06,538 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:30:08,643 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:30:08,679 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:30:09,775 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:30:09,809 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:30:09,894 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:30:10,742 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:30:10,751 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:30:12,945 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:30:13,020 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:30:15,020 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:30:15,157 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:30:15,165 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:30:15,170 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:30:15,212 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:30:17,213 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:30:17,227 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:30:19,257 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:30:19,265 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:30:20,255 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:30:20,293 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:30:20,377 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:30:21,289 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:30:21,296 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:30:23,328 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:30:23,362 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:30:25,462 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:30:25,485 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:30:25,494 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:30:25,560 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:30:25,652 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:30:27,544 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:30:27,558 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:30:29,588 - INFO - Updated strategy buffer: CONTROLLED_GRADUAL
2025-04-26 21:30:29,594 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:30:30,669 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:30:30,670 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:30:30,673 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:30:30,674 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:30:30,675 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: CONTROLLED_GRADUAL
2025-04-26 21:30:30,720 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:30:30,724 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:30:31,780 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:30:31,854 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:30:31,856 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:30:31,857 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:30:31,869 - INFO - Using strategy buffer configuration
2025-04-26 21:30:31,877 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:30:32,251 - INFO - Successfully applied config to broker 2
2025-04-26 21:30:32,447 - INFO - Successfully applied config to broker 3
2025-04-26 21:30:32,554 - INFO - Successfully applied config to broker 1
2025-04-26 21:30:32,555 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:30:32,556 - INFO - Triggering leader election
2025-04-26 21:30:32,557 - INFO - Listing topics for leader election
2025-04-26 21:30:32,578 - INFO - Found 1 topics for leader election
2025-04-26 21:30:32,578 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:30:32,579 - INFO - Leader election completed in 0.02 seconds, success: False
2025-04-26 21:30:32,582 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:30:33,889 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:30:33,941 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:30:33,944 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:30:33,974 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:30:33,985 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:30:35,994 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:30:36,021 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:30:36,033 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:30:36,063 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:30:36,063 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:30:38,068 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:30:38,080 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:30:38,085 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:30:38,089 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:30:38,125 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:30:40,126 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:30:40,135 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:30:40,190 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:30:40,205 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:30:40,300 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:30:42,219 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:30:42,230 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:30:42,312 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:30:42,407 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:30:42,526 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:30:44,257 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:30:44,274 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:30:44,531 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:30:44,540 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:30:44,552 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:30:46,298 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:30:46,302 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:30:46,555 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:30:46,594 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:30:46,662 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:30:47,596 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:30:47,602 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:30:47,605 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:30:47,617 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:30:47,672 - INFO - Found 1 partitions on broker 1
2025-04-26 21:30:47,674 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:30:47,675 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:30:47,675 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:30:47,680 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:30:47,818 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:30:48,045 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:30:48,047 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:30:48,047 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:30:48,374 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:30:48,383 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:30:48,696 - INFO - Skipping recovery for kafka1:9092, last attempt 18.0s ago
2025-04-26 21:30:48,711 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:30:48,796 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:30:50,426 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:30:50,432 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:30:52,448 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:30:52,455 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:30:54,480 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:30:54,485 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:30:54,805 - INFO - Skipping recovery for kafka1:9092, last attempt 24.1s ago
2025-04-26 21:30:54,827 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:30:54,874 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:30:56,539 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:30:56,551 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:30:58,587 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:30:58,596 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:30:59,889 - INFO - Skipping recovery for kafka1:9092, last attempt 29.2s ago
2025-04-26 21:30:59,940 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:30:59,976 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:00,649 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:31:00,654 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:31:02,712 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:31:02,724 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:31:04,745 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:31:04,751 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:31:05,018 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:05,034 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:05,139 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:06,774 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:31:06,779 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:31:08,820 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:31:08,856 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:31:10,166 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:10,182 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:10,202 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:10,880 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:31:10,915 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:31:12,941 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:31:12,959 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:31:14,979 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:31:15,000 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:31:15,248 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:15,309 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:15,336 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:17,021 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:31:17,033 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:31:19,050 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:31:19,055 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:31:20,381 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:20,396 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:20,422 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:21,083 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:31:21,104 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:31:23,125 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:31:23,147 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:31:25,163 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:31:25,169 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:31:25,467 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:25,485 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:25,510 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:27,239 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:31:27,250 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:31:29,258 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:31:29,264 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:31:30,530 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:30,543 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:30,573 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:31,273 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:31:31,275 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:31:33,293 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:31:33,297 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:31:35,306 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:31:35,309 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:31:35,579 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:31:35,580 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:31:35,581 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:31:35,582 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:31:35,582 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE
2025-04-26 21:31:35,594 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:35,594 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:35,609 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:35,609 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:35,611 - INFO - Using strategy buffer configuration
2025-04-26 21:31:35,615 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:31:35,673 - INFO - Successfully applied config to broker 2
2025-04-26 21:31:35,740 - INFO - Successfully applied config to broker 3
2025-04-26 21:31:35,777 - INFO - Successfully applied config to broker 1
2025-04-26 21:31:35,777 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:31:35,778 - INFO - Triggering leader election
2025-04-26 21:31:35,780 - INFO - Listing topics for leader election
2025-04-26 21:31:35,784 - INFO - Found 1 topics for leader election
2025-04-26 21:31:35,784 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:31:35,784 - INFO - Leader election completed in 0.00 seconds, success: False
2025-04-26 21:31:35,787 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:31:37,322 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:31:37,326 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:31:37,616 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:31:37,629 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:37,642 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:39,335 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:31:39,338 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:31:39,644 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:31:39,655 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:39,670 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:41,360 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:31:41,364 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:31:41,673 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:31:41,680 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:41,685 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:43,374 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:31:43,377 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:31:43,688 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:31:43,693 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:43,704 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:45,383 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:31:45,386 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:31:45,709 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:31:45,717 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:45,724 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:47,397 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:31:47,399 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:31:47,730 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:31:47,737 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:47,745 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:49,413 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:31:49,437 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:31:49,751 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:31:49,763 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:49,775 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:50,799 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:31:50,799 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:31:50,799 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:31:50,799 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:31:50,805 - INFO - Found 1 partitions on broker 1
2025-04-26 21:31:50,805 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:31:50,805 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:31:50,805 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:31:50,806 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:31:50,821 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:50,855 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:31:50,855 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:31:50,855 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:31:51,448 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:31:51,466 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:31:51,778 - INFO - Skipping recovery for kafka1:9092, last attempt 16.2s ago
2025-04-26 21:31:51,785 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:51,798 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:53,471 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:31:53,474 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:31:55,492 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:31:55,496 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:31:56,800 - INFO - Skipping recovery for kafka1:9092, last attempt 21.2s ago
2025-04-26 21:31:56,821 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:56,856 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:31:57,588 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:31:57,596 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:31:59,605 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:31:59,607 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:32:01,629 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:32:01,647 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:32:01,862 - INFO - Skipping recovery for kafka1:9092, last attempt 26.3s ago
2025-04-26 21:32:01,878 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:01,902 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:03,676 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:32:03,683 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:32:05,696 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:32:05,699 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:32:06,922 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:06,936 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:06,964 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:07,732 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:32:07,735 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:32:09,744 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:32:09,748 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:32:11,793 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:32:11,799 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:32:11,989 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:12,008 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:12,027 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:13,910 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:32:13,924 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:32:15,976 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:32:16,007 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:32:17,129 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:17,214 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:17,298 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:18,087 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:32:18,110 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:32:20,208 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:32:20,228 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:32:22,256 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:32:22,267 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:32:22,443 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:22,479 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:23,619 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:24,338 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:32:24,354 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:32:26,480 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:32:26,530 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:32:28,709 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:32:28,818 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:32:29,686 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:29,724 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:29,755 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:30,828 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:32:30,830 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:32:32,848 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:32:32,856 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:32:34,790 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:34,801 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:34,811 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:34,867 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:32:34,870 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:32:36,883 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:32:36,888 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:32:38,900 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:32:38,903 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:32:39,814 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:32:39,815 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:32:39,816 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:32:39,816 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:32:39,816 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: RESOURCE_OPTIMIZED
2025-04-26 21:32:39,832 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:39,832 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:39,849 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:39,849 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:39,854 - INFO - Using strategy buffer configuration
2025-04-26 21:32:39,858 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:32:39,906 - INFO - Successfully applied config to broker 2
2025-04-26 21:32:39,958 - INFO - Successfully applied config to broker 3
2025-04-26 21:32:40,012 - INFO - Successfully applied config to broker 1
2025-04-26 21:32:40,012 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:32:40,015 - INFO - Triggering leader election
2025-04-26 21:32:40,016 - INFO - Listing topics for leader election
2025-04-26 21:32:40,023 - INFO - Found 1 topics for leader election
2025-04-26 21:32:40,027 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:32:40,027 - INFO - Leader election completed in 0.01 seconds, success: False
2025-04-26 21:32:40,029 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:32:40,913 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:32:40,916 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:32:41,854 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:32:41,862 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:41,870 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:42,924 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:32:42,926 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:32:43,875 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:32:43,880 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:43,885 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:44,957 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:32:44,960 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:32:45,889 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:32:45,902 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:45,916 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:46,969 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:32:46,972 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:32:47,919 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:32:47,925 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:47,932 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:48,981 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:32:48,984 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:32:49,934 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:32:49,939 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:49,946 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:51,001 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:32:51,006 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:32:51,949 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:32:51,960 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:51,968 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:53,020 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:32:53,023 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:32:53,969 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:32:53,974 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:53,980 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:55,046 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:32:55,057 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:32:55,058 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:32:55,058 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:32:55,076 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:32:55,082 - INFO - Found 1 partitions on broker 1
2025-04-26 21:32:55,082 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:32:55,082 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:32:55,083 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:32:55,084 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:32:55,099 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:55,104 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:32:55,152 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:32:55,155 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:32:55,155 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:32:55,989 - INFO - Skipping recovery for kafka1:9092, last attempt 16.2s ago
2025-04-26 21:32:56,138 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:56,214 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:32:57,143 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:32:57,148 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:32:59,161 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:32:59,163 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:33:01,180 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:33:01,183 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:33:01,222 - INFO - Skipping recovery for kafka1:9092, last attempt 21.4s ago
2025-04-26 21:33:01,236 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:01,248 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:03,210 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:33:03,213 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:33:05,224 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:33:05,227 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:33:06,254 - INFO - Skipping recovery for kafka1:9092, last attempt 26.4s ago
2025-04-26 21:33:06,263 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:06,295 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:07,265 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:33:07,289 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:33:09,399 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:33:09,421 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:33:11,790 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:33:11,814 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:33:11,936 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:12,041 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:12,169 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:14,182 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:33:14,220 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:33:16,607 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:33:16,673 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:33:17,328 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:17,475 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:17,527 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:18,724 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:33:18,732 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:33:20,742 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:33:20,745 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:33:22,579 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:22,594 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:22,604 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:22,757 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:33:22,759 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:33:24,770 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:33:24,774 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:33:26,782 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:33:26,801 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:33:27,630 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:27,645 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:27,659 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:28,808 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:33:28,811 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:33:30,826 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:33:30,829 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:33:32,679 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:32,689 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:32,698 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:32,837 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:33:32,853 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:33:34,872 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:33:34,875 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:33:36,883 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:33:36,886 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:33:37,721 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:37,752 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:37,769 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:38,903 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:33:38,906 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:33:40,917 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:33:40,921 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:33:42,771 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:33:42,772 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:33:42,774 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:33:42,774 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:33:42,774 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: RESOURCE_OPTIMIZED
2025-04-26 21:33:42,792 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:42,792 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:42,805 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:42,805 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:42,806 - INFO - Using strategy buffer configuration
2025-04-26 21:33:42,809 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:33:42,860 - INFO - Successfully applied config to broker 2
2025-04-26 21:33:42,883 - INFO - Successfully applied config to broker 3
2025-04-26 21:33:42,906 - INFO - Successfully applied config to broker 1
2025-04-26 21:33:42,906 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:33:42,918 - INFO - Triggering leader election
2025-04-26 21:33:42,921 - INFO - Listing topics for leader election
2025-04-26 21:33:42,934 - INFO - Found 1 topics for leader election
2025-04-26 21:33:42,934 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:33:42,935 - INFO - Leader election completed in 0.01 seconds, success: False
2025-04-26 21:33:42,937 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:33:42,950 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:33:42,956 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:33:44,810 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:33:44,821 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:44,834 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:44,963 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:33:44,977 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:33:46,839 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:33:46,846 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:46,869 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:46,997 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:33:47,000 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:33:48,873 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:33:48,905 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:48,915 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:49,008 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:33:49,010 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:33:50,920 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:33:50,929 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:50,936 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:51,024 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:33:51,039 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:33:52,943 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:33:52,952 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:52,961 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:53,045 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:33:53,048 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:33:54,966 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:33:54,974 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:54,985 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:55,070 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:33:55,072 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:33:56,988 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:33:56,997 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:57,015 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:57,078 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:33:57,080 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:33:57,938 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:33:57,940 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:33:57,940 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:33:57,940 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:33:57,946 - INFO - Found 1 partitions on broker 1
2025-04-26 21:33:57,946 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:33:57,946 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:33:57,946 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:33:57,948 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:33:57,957 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:58,023 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:33:58,023 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:33:58,023 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:33:59,020 - INFO - Skipping recovery for kafka1:9092, last attempt 16.2s ago
2025-04-26 21:33:59,030 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:59,045 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:33:59,092 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:33:59,094 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:34:01,104 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:34:01,125 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:34:03,143 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:34:03,147 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:34:04,054 - INFO - Skipping recovery for kafka1:9092, last attempt 21.3s ago
2025-04-26 21:34:04,065 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:34:04,079 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:34:05,161 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:34:05,165 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:34:07,187 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:34:07,208 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:34:09,081 - INFO - Skipping recovery for kafka1:9092, last attempt 26.3s ago
2025-04-26 21:34:09,102 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:34:09,137 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:34:09,218 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:34:09,219 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:34:11,230 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:34:11,262 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:34:13,269 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:34:13,272 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:34:14,164 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:34:14,174 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:34:14,202 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:34:15,292 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:34:15,296 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:34:17,346 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:34:17,366 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:34:19,279 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:34:19,342 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:34:19,399 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:34:19,419 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:34:19,447 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:34:21,487 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:34:21,538 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:34:23,723 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:34:23,758 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:34:24,561 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:34:24,664 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:34:24,716 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:34:25,769 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:34:25,773 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:34:27,838 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:34:27,843 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:34:29,752 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:34:29,787 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:34:29,808 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:34:29,864 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:34:29,886 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:34:31,910 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:34:31,928 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:34:34,024 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:34:34,073 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:34:34,864 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:34:34,880 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:34:34,899 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:34:36,079 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:34:36,081 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:34:38,106 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:34:38,122 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:34:39,929 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:34:39,942 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:34:39,956 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:34:40,131 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:34:40,134 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:34:42,149 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:34:42,176 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:34:44,196 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:34:44,219 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:34:44,958 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:34:44,959 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:34:44,960 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:34:44,963 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:34:44,963 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: RESOURCE_OPTIMIZED
2025-04-26 21:34:44,975 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:34:44,976 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:34:44,997 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:34:44,998 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:34:45,001 - INFO - Using strategy buffer configuration
2025-04-26 21:34:45,005 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:34:45,076 - INFO - Successfully applied config to broker 2
2025-04-26 21:34:45,319 - INFO - Successfully applied config to broker 3
2025-04-26 21:34:45,518 - INFO - Successfully applied config to broker 1
2025-04-26 21:34:45,519 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:34:45,527 - INFO - Triggering leader election
2025-04-26 21:34:45,529 - INFO - Listing topics for leader election
2025-04-26 21:34:45,545 - INFO - Found 1 topics for leader election
2025-04-26 21:34:45,545 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:34:45,546 - INFO - Leader election completed in 0.02 seconds, success: False
2025-04-26 21:34:46,254 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:34:46,262 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:34:46,554 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:34:47,002 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:34:47,037 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:34:47,065 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:34:48,268 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:34:48,278 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:34:49,071 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:34:49,082 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:34:49,089 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:34:50,295 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:34:50,300 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:34:51,093 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:34:51,104 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:34:51,114 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:34:52,314 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:34:52,317 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:34:53,119 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:34:53,129 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:34:53,139 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:34:54,329 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:34:54,331 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:34:55,142 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:34:55,151 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:34:55,162 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:34:56,352 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:34:56,378 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:34:57,167 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:34:57,181 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:34:57,197 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:34:58,391 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:34:58,393 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:34:59,200 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:34:59,205 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:34:59,210 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:00,405 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:35:00,408 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:35:01,212 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:35:01,216 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:01,221 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:01,574 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:35:01,574 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:35:01,574 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:35:01,574 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:35:01,579 - INFO - Found 1 partitions on broker 1
2025-04-26 21:35:01,579 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:35:01,579 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:35:01,579 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:35:01,581 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:35:01,619 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:01,665 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:35:01,666 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:35:01,666 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:35:02,431 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:35:02,438 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:35:03,222 - INFO - Skipping recovery for kafka1:9092, last attempt 18.3s ago
2025-04-26 21:35:03,260 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:03,278 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:04,458 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:35:04,464 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:35:06,473 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:35:06,477 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:35:08,286 - INFO - Skipping recovery for kafka1:9092, last attempt 23.3s ago
2025-04-26 21:35:08,325 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:08,342 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:08,498 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:35:08,500 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:35:10,511 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:35:10,514 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:35:12,574 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:35:12,577 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:35:13,349 - INFO - Skipping recovery for kafka1:9092, last attempt 28.4s ago
2025-04-26 21:35:13,362 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:13,375 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:14,591 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:35:14,594 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:35:16,607 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:35:16,611 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:35:18,423 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:18,436 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:18,453 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:18,626 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:35:18,628 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:35:20,643 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:35:20,646 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:35:22,677 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:35:22,682 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:35:23,471 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:23,491 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:23,505 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:24,692 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:35:24,694 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:35:26,703 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:35:26,706 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:35:28,525 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:28,537 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:28,552 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:28,716 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:35:28,718 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:35:30,728 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:35:30,734 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:35:32,754 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:35:32,757 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:35:33,579 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:33,604 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:33,614 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:34,773 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:35:34,776 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:35:36,794 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:35:36,798 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:35:38,661 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:38,699 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:38,748 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:38,843 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:35:38,849 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:35:40,859 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:35:40,862 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:35:42,879 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:35:42,882 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:35:43,793 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:43,806 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:43,818 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:44,894 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:35:44,897 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:35:46,910 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:35:46,914 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:35:48,826 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:35:48,828 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:35:48,829 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:35:48,829 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:35:48,829 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: RESOURCE_OPTIMIZED
2025-04-26 21:35:48,840 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:48,840 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:48,852 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:48,852 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:48,853 - INFO - Using strategy buffer configuration
2025-04-26 21:35:48,855 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:35:48,892 - INFO - Successfully applied config to broker 2
2025-04-26 21:35:48,927 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:35:48,929 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:35:48,931 - INFO - Successfully applied config to broker 3
2025-04-26 21:35:48,966 - INFO - Successfully applied config to broker 1
2025-04-26 21:35:48,966 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:35:48,967 - INFO - Triggering leader election
2025-04-26 21:35:48,969 - INFO - Listing topics for leader election
2025-04-26 21:35:48,972 - INFO - Found 1 topics for leader election
2025-04-26 21:35:48,972 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:35:48,972 - INFO - Leader election completed in 0.00 seconds, success: False
2025-04-26 21:35:48,973 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:35:50,857 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:35:50,861 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:50,864 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:50,933 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:35:50,936 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:35:52,868 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:35:52,902 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:52,912 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:52,953 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:35:52,977 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:35:54,917 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:35:54,924 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:54,932 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:54,988 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:35:54,991 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:35:56,936 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:35:56,947 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:56,957 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:57,008 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:35:57,011 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:35:58,962 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:35:58,982 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:59,001 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:35:59,034 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:35:59,048 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:36:01,004 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:36:01,007 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:36:01,017 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:36:01,056 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:36:01,062 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:36:03,021 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:36:03,038 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:36:03,053 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:36:03,086 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:36:03,091 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:36:03,977 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:36:03,977 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:36:03,978 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:36:03,978 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:36:03,998 - INFO - Found 1 partitions on broker 1
2025-04-26 21:36:03,999 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:36:03,999 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:36:04,000 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:36:04,020 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:36:04,049 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:36:04,245 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:36:04,245 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:36:04,245 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:36:05,056 - INFO - Skipping recovery for kafka1:9092, last attempt 16.2s ago
2025-04-26 21:36:05,092 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:36:05,113 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:36:05,156 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:36:05,186 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:36:07,172 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:36:07,177 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:36:09,196 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:36:09,220 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:36:10,214 - INFO - Skipping recovery for kafka1:9092, last attempt 21.4s ago
2025-04-26 21:36:10,243 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:36:10,256 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:36:11,237 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:36:11,243 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:36:13,264 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:36:13,267 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:36:15,266 - INFO - Skipping recovery for kafka1:9092, last attempt 26.4s ago
2025-04-26 21:36:15,287 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:36:15,291 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:36:15,295 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:36:15,307 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:36:17,301 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:36:17,305 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:36:19,331 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:36:19,354 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:36:20,358 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:36:20,370 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:36:20,383 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:36:21,358 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:36:21,359 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:36:23,372 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:36:23,376 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:36:25,390 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:36:25,399 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:36:25,415 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:36:25,439 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:36:25,459 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:36:27,420 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:36:27,428 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:36:29,449 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:36:29,456 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:36:30,554 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:36:30,625 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:36:30,670 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:36:31,494 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:36:31,503 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:36:33,688 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:36:33,803 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:36:35,735 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:36:35,779 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:36:35,820 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:36:35,879 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:36:35,906 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:36:37,982 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:36:38,019 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:36:40,040 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:36:40,045 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:36:40,913 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:36:40,954 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:36:41,002 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:36:42,058 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:36:42,070 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:36:44,132 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:36:44,139 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:36:46,132 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:36:46,237 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:36:46,243 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:36:46,255 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:36:46,318 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:36:48,481 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:36:48,589 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:36:50,704 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:36:50,726 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:36:51,328 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:36:51,330 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:36:51,341 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:36:51,341 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:36:51,341 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: RESOURCE_OPTIMIZED
2025-04-26 21:36:51,440 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:36:51,440 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:36:51,476 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:36:51,501 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:36:52,520 - INFO - Using strategy buffer configuration
2025-04-26 21:36:52,532 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:36:52,812 - INFO - Successfully applied config to broker 2
2025-04-26 21:36:52,815 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:36:52,931 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:36:53,145 - INFO - Successfully applied config to broker 3
2025-04-26 21:36:53,512 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:36:53,562 - INFO - Successfully applied config to broker 1
2025-04-26 21:36:53,569 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:36:53,591 - INFO - Triggering leader election
2025-04-26 21:36:53,593 - INFO - Listing topics for leader election
2025-04-26 21:36:53,611 - INFO - Found 1 topics for leader election
2025-04-26 21:36:53,611 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:36:53,612 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:36:53,613 - INFO - Leader election completed in 0.02 seconds, success: False
2025-04-26 21:36:53,628 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:36:53,662 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:36:54,918 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:36:55,059 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:36:55,626 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:36:55,644 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:36:55,709 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:36:57,096 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:36:57,141 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:36:57,725 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:36:57,759 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:36:57,797 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:36:59,183 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:36:59,201 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:37:00,808 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:37:00,870 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:37:00,897 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:37:01,214 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:37:01,218 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:37:02,905 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:37:02,917 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:37:02,925 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:37:03,275 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:37:03,283 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:37:04,932 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:37:04,953 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:37:05,000 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:37:05,308 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:37:05,314 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:37:07,010 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:37:07,041 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:37:07,074 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:37:07,334 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:37:07,340 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:37:08,600 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:37:08,603 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:37:08,603 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:37:08,603 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:37:08,660 - INFO - Found 1 partitions on broker 1
2025-04-26 21:37:08,661 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:37:08,661 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:37:08,661 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:37:08,671 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:37:08,854 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:37:08,940 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:37:08,941 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:37:08,941 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:37:09,083 - INFO - Skipping recovery for kafka1:9092, last attempt 17.8s ago
2025-04-26 21:37:09,231 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:37:09,246 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:37:09,360 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:37:09,365 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:37:11,504 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:37:11,561 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:37:13,654 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:37:13,660 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:37:14,250 - INFO - Skipping recovery for kafka1:9092, last attempt 22.9s ago
2025-04-26 21:37:14,314 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:37:14,356 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:37:15,703 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:37:15,718 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:37:17,781 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:37:17,790 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:37:19,363 - INFO - Skipping recovery for kafka1:9092, last attempt 28.0s ago
2025-04-26 21:37:19,388 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:37:19,419 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:37:19,817 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:37:19,825 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:37:21,962 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:37:22,017 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:37:24,085 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:37:24,125 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:37:24,956 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:37:25,018 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:37:25,119 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:37:26,242 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:37:26,258 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:37:28,300 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:37:28,333 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:37:30,244 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:37:30,454 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:37:30,455 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:37:30,547 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:37:30,587 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:37:32,669 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:37:32,717 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:37:34,750 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:37:34,770 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:37:35,814 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:37:36,067 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:37:36,284 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:37:36,974 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:37:37,048 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:37:39,209 - ERROR - API returned status code: 500
2025-04-26 21:37:41,279 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:37:41,323 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:37:41,415 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:37:41,488 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:37:41,533 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:37:43,347 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:37:43,379 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:37:45,547 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:37:45,564 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:37:47,026 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:37:47,652 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:37:47,671 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:37:48,089 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:37:48,137 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:37:49,755 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:37:49,768 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:37:51,827 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:37:51,875 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:37:53,143 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:37:53,144 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:37:53,150 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:37:53,150 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:37:53,150 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE
2025-04-26 21:37:53,242 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:37:53,246 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:37:53,292 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:37:53,300 - INFO - Using strategy buffer configuration
2025-04-26 21:37:53,302 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:37:53,319 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:37:53,641 - INFO - Successfully applied config to broker 2
2025-04-26 21:37:53,793 - INFO - Successfully applied config to broker 3
2025-04-26 21:37:53,968 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:37:54,019 - INFO - Successfully applied config to broker 1
2025-04-26 21:37:54,019 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:37:54,033 - INFO - Triggering leader election
2025-04-26 21:37:54,037 - INFO - Listing topics for leader election
2025-04-26 21:37:54,037 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:37:54,084 - INFO - Found 1 topics for leader election
2025-04-26 21:37:54,084 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:37:54,084 - INFO - Leader election completed in 0.05 seconds, success: False
2025-04-26 21:37:54,085 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:37:55,343 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:37:55,367 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:37:56,106 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:37:56,150 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:37:56,387 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:37:58,162 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:37:58,168 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:37:58,392 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:37:58,413 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:37:58,424 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:38:00,262 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:38:00,277 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:38:00,434 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:38:00,651 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:38:01,744 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:38:02,402 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:38:02,500 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:38:03,780 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:38:03,864 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:38:04,525 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:38:04,553 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:38:04,884 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:38:06,592 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:38:06,632 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:38:06,892 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:38:07,000 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:38:07,071 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:38:08,662 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:38:08,694 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:38:09,083 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:38:09,111 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:38:09,133 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:38:09,135 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:38:09,136 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:38:09,136 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:38:09,185 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:38:09,185 - INFO - Found 1 partitions on broker 1
2025-04-26 21:38:09,186 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:38:09,186 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:38:09,186 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:38:09,190 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:38:09,215 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:38:09,281 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:38:09,283 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:38:09,283 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:38:10,726 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:38:10,733 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:38:11,198 - INFO - Skipping recovery for kafka1:9092, last attempt 18.1s ago
2025-04-26 21:38:11,221 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:38:11,240 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:38:12,959 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:38:12,974 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:38:14,996 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:38:15,000 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:38:16,245 - INFO - Skipping recovery for kafka1:9092, last attempt 23.1s ago
2025-04-26 21:38:16,308 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:38:16,433 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:38:17,021 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:38:17,044 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:38:19,078 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:38:19,086 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:38:21,109 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:38:21,117 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:38:21,441 - INFO - Skipping recovery for kafka1:9092, last attempt 28.3s ago
2025-04-26 21:38:21,471 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:38:21,496 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:38:23,138 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:38:23,149 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:38:25,308 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:38:25,330 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:38:27,033 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:38:27,147 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:38:27,214 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:38:27,385 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:38:27,402 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:38:29,416 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:38:29,421 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:38:31,442 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:38:31,449 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:38:32,293 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:38:32,312 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:38:32,392 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:38:33,507 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:38:33,577 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:38:35,616 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:38:35,702 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:38:37,705 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:38:37,928 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:38:38,011 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:38:38,039 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:38:38,531 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:38:40,164 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:38:40,199 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:38:42,279 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:38:42,302 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:38:44,338 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:38:44,356 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:38:44,595 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:38:44,677 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:38:44,705 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:38:46,376 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:38:46,381 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:38:48,396 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:38:48,400 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:38:49,766 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:38:49,795 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:38:49,828 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:38:50,424 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:38:50,429 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:38:52,627 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:38:52,639 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:38:54,860 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:38:55,246 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:38:55,253 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:38:55,259 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:38:55,476 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE
2025-04-26 21:38:55,562 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:38:55,585 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:38:55,739 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:38:55,739 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:38:56,168 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:38:56,170 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:38:56,185 - INFO - Using strategy buffer configuration
2025-04-26 21:38:56,195 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:38:57,099 - INFO - Successfully applied config to broker 2
2025-04-26 21:38:57,425 - INFO - Successfully applied config to broker 3
2025-04-26 21:38:57,678 - INFO - Successfully applied config to broker 1
2025-04-26 21:38:57,679 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:38:57,693 - INFO - Triggering leader election
2025-04-26 21:38:57,701 - INFO - Listing topics for leader election
2025-04-26 21:38:57,721 - INFO - Found 1 topics for leader election
2025-04-26 21:38:57,724 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:38:57,724 - INFO - Leader election completed in 0.02 seconds, success: False
2025-04-26 21:38:57,750 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:38:57,795 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:38:57,984 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:38:58,236 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:38:58,392 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:38:58,761 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:00,578 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:39:00,749 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:39:00,774 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:39:00,957 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:01,119 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:02,836 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:39:02,856 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:39:04,159 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:39:04,198 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:04,231 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:04,989 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:39:05,022 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:39:06,240 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:39:06,269 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:06,483 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:07,095 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:39:07,125 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:39:08,500 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:39:08,552 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:08,657 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:09,223 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:39:09,230 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:39:10,672 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:39:10,732 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:10,773 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:11,254 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:39:11,355 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:39:12,781 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:39:12,798 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:39:12,798 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:39:12,798 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:39:12,799 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:39:12,813 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:12,838 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:12,843 - INFO - Found 1 partitions on broker 1
2025-04-26 21:39:12,843 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:39:12,844 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:39:12,844 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:39:12,846 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:39:13,007 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:13,107 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:39:13,107 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:39:13,108 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:39:13,456 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:39:13,475 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:39:14,850 - INFO - Skipping recovery for kafka1:9092, last attempt 20.0s ago
2025-04-26 21:39:14,893 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:14,921 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:15,488 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:39:15,516 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:39:17,568 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:39:17,574 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:39:19,610 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:39:19,632 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:39:19,931 - INFO - Skipping recovery for kafka1:9092, last attempt 25.1s ago
2025-04-26 21:39:19,957 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:20,035 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:21,650 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:39:21,679 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:39:23,806 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:39:23,826 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:39:25,125 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:25,175 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:25,241 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:25,895 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:39:25,903 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:39:28,094 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:39:28,139 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:39:30,164 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:39:30,170 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:39:30,333 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:30,359 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:30,391 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:32,199 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:39:32,252 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:39:34,480 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:39:34,646 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:39:35,558 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:35,769 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:35,884 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:36,770 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:39:36,822 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:39:38,959 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:39:38,989 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:39:40,927 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:40,951 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:41,024 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:41,054 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:39:41,059 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:39:43,270 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:39:43,389 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:39:45,447 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:39:45,462 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:39:46,266 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:47,320 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:47,370 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:47,481 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:39:47,509 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:39:49,546 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:39:49,551 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:39:51,834 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:39:51,848 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:39:52,535 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:52,639 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:52,926 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:53,901 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:39:53,933 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:39:56,149 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:39:56,181 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:39:57,998 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:39:58,001 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:39:58,022 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:39:58,023 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:39:58,103 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE
2025-04-26 21:39:58,308 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:39:58,374 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:39:58,425 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:58,425 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:58,972 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:59,007 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:39:59,372 - INFO - Using strategy buffer configuration
2025-04-26 21:39:59,473 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:40:00,464 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:40:00,531 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:40:01,053 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:40:01,138 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:40:01,274 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:40:01,472 - INFO - Successfully applied config to broker 2
2025-04-26 21:40:01,790 - INFO - Successfully applied config to broker 3
2025-04-26 21:40:02,348 - INFO - Successfully applied config to broker 1
2025-04-26 21:40:02,351 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:40:02,391 - INFO - Triggering leader election
2025-04-26 21:40:02,401 - INFO - Listing topics for leader election
2025-04-26 21:40:02,450 - INFO - Found 1 topics for leader election
2025-04-26 21:40:02,452 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:40:02,452 - INFO - Leader election completed in 0.05 seconds, success: False
2025-04-26 21:40:02,455 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:40:02,567 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:40:02,603 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:40:03,290 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:40:03,333 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:40:03,415 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:40:04,755 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:40:04,833 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:40:05,420 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:40:05,470 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:40:05,507 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:40:06,990 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:40:07,038 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:40:07,511 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:40:07,561 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:40:07,619 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:40:09,126 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:40:09,196 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:40:09,624 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:40:09,752 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:40:09,792 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:40:11,300 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:40:11,309 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:40:11,798 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:40:11,837 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:40:11,856 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:40:13,327 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:40:13,377 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:40:13,864 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:40:13,905 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:40:13,947 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:40:15,419 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:40:15,426 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:40:15,955 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:40:16,045 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:40:16,174 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:40:17,460 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:40:17,462 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:40:17,462 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:40:17,462 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:40:17,479 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:40:17,506 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:40:17,513 - INFO - Found 1 partitions on broker 1
2025-04-26 21:40:17,516 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:40:17,516 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:40:17,516 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:40:18,178 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:40:18,255 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:40:18,361 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:40:18,530 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:40:18,874 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:40:19,543 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:40:19,544 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:40:19,545 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:40:19,574 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:40:19,641 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:40:20,393 - INFO - Skipping recovery for kafka1:9092, last attempt 22.4s ago
2025-04-26 21:40:21,075 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:40:21,312 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:40:22,447 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:40:22,527 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:40:24,576 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:40:24,603 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:40:26,329 - INFO - Skipping recovery for kafka1:9092, last attempt 28.3s ago
2025-04-26 21:40:26,544 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:40:27,036 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:40:27,044 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:40:27,118 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:40:29,271 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:40:29,326 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:40:31,464 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:40:31,480 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:40:32,135 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:40:32,191 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:40:32,233 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:40:33,530 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:40:33,547 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:40:35,564 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:40:35,569 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:40:37,275 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:40:37,312 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:40:37,603 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:40:37,635 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:40:38,415 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:40:39,673 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:40:39,716 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:40:41,747 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:40:41,759 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:40:43,520 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:40:43,556 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:40:43,790 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:40:43,816 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:40:44,642 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:40:45,859 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:40:45,906 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:40:47,954 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:40:47,969 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:40:49,711 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:40:49,776 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:40:49,879 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:40:50,046 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:40:50,053 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:40:52,102 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:40:52,121 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:40:54,154 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:40:54,183 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:40:54,976 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:40:55,075 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:40:55,149 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:40:56,260 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:40:56,273 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:40:58,309 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:40:58,319 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:41:00,180 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:41:00,182 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:41:00,185 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:41:00,186 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:41:00,187 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE
2025-04-26 21:41:00,231 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:00,232 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:00,337 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:00,338 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:00,353 - INFO - Using strategy buffer configuration
2025-04-26 21:41:00,361 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:41:00,413 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:41:00,442 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:41:00,599 - INFO - Successfully applied config to broker 2
2025-04-26 21:41:00,809 - INFO - Successfully applied config to broker 3
2025-04-26 21:41:01,149 - INFO - Successfully applied config to broker 1
2025-04-26 21:41:01,149 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:41:01,154 - INFO - Triggering leader election
2025-04-26 21:41:01,157 - INFO - Listing topics for leader election
2025-04-26 21:41:01,173 - INFO - Found 1 topics for leader election
2025-04-26 21:41:01,174 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:41:01,174 - INFO - Leader election completed in 0.02 seconds, success: False
2025-04-26 21:41:01,178 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:41:02,526 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:41:02,556 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:41:03,353 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:41:03,391 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:03,415 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:04,616 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:41:04,654 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:41:05,423 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:41:05,484 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:05,525 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:06,806 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:41:06,906 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:41:07,530 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:41:07,601 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:07,672 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:08,973 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:41:08,982 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:41:09,681 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:41:09,697 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:09,716 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:11,039 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:41:11,070 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:41:11,718 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:41:11,772 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:11,803 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:13,087 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:41:13,111 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:41:13,811 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:41:13,818 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:13,847 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:15,140 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:41:15,151 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:41:15,853 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:41:15,878 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:15,915 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:16,183 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:41:16,185 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:41:16,185 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:41:16,186 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:41:16,202 - INFO - Found 1 partitions on broker 1
2025-04-26 21:41:16,203 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:41:16,204 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:41:16,204 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:41:16,207 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:41:16,329 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:16,509 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:41:16,510 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:41:16,510 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:41:17,172 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:41:17,215 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:41:17,927 - INFO - Skipping recovery for kafka1:9092, last attempt 17.7s ago
2025-04-26 21:41:17,945 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:17,967 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:19,241 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:41:19,246 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:41:21,269 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:41:21,276 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:41:22,970 - INFO - Skipping recovery for kafka1:9092, last attempt 22.8s ago
2025-04-26 21:41:23,001 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:23,024 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:23,289 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:41:23,334 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:41:25,369 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:41:25,386 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:41:27,453 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:41:27,488 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:41:28,063 - INFO - Skipping recovery for kafka1:9092, last attempt 27.9s ago
2025-04-26 21:41:28,099 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:28,160 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:29,515 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:41:29,523 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:41:31,534 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:41:31,540 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:41:33,684 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:41:33,772 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:41:34,216 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:34,270 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:34,315 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:35,882 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:41:35,906 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:41:37,971 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:41:37,994 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:41:39,401 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:39,469 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:39,576 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:40,020 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:41:40,030 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:41:42,047 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:41:42,060 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:41:44,090 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:41:44,147 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:41:44,630 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:44,655 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:44,683 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:46,211 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:41:46,224 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:41:48,258 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:41:48,305 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:41:49,762 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:49,812 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:49,914 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:50,345 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:41:50,411 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:41:52,436 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:41:52,464 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:41:54,484 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:41:54,492 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:41:54,993 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:55,013 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:55,061 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:41:56,538 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:41:56,548 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:41:58,567 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:41:58,570 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:42:00,064 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:42:00,088 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:42:00,107 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:42:00,584 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:42:00,587 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:42:02,595 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:42:02,598 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:42:04,621 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:42:04,626 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:42:05,115 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:42:05,116 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:42:05,117 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:42:05,121 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:42:05,121 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: RESOURCE_OPTIMIZED
2025-04-26 21:42:05,130 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:42:05,130 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:42:05,163 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:42:05,163 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:42:05,166 - INFO - Using strategy buffer configuration
2025-04-26 21:42:05,171 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:42:05,310 - INFO - Successfully applied config to broker 2
2025-04-26 21:42:05,419 - INFO - Successfully applied config to broker 3
2025-04-26 21:42:05,501 - INFO - Successfully applied config to broker 1
2025-04-26 21:42:05,501 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:42:05,503 - INFO - Triggering leader election
2025-04-26 21:42:05,505 - INFO - Listing topics for leader election
2025-04-26 21:42:05,510 - INFO - Found 1 topics for leader election
2025-04-26 21:42:05,511 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:42:05,511 - INFO - Leader election completed in 0.01 seconds, success: False
2025-04-26 21:42:05,513 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:42:06,643 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:42:06,647 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:42:07,171 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:42:07,181 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:42:07,204 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:42:08,652 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:42:08,655 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:42:09,210 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:42:09,218 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:42:09,227 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:42:10,736 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:42:11,087 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:42:11,245 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:42:11,627 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:42:11,938 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:42:13,218 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:42:13,268 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:42:14,029 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:42:14,203 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:42:14,395 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:42:15,675 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:42:15,734 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:42:16,429 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:42:16,474 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:42:16,623 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:42:17,849 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:42:17,877 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:42:18,711 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:42:18,759 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:42:20,841 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:42:20,999 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:42:21,002 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:42:21,003 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:42:21,005 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:42:21,083 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:42:21,121 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:42:21,289 - INFO - Found 1 partitions on broker 1
2025-04-26 21:42:21,313 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:42:21,336 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:42:21,341 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:42:21,415 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:42:21,688 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:42:22,026 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:42:22,027 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:42:22,027 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:42:23,119 - INFO - Skipping recovery for kafka1:9092, last attempt 18.0s ago
2025-04-26 21:42:23,353 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:42:23,379 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:42:24,196 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:42:24,239 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:42:25,808 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:42:25,879 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:42:27,880 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:42:27,887 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:42:29,203 - INFO - Skipping recovery for kafka1:9092, last attempt 24.1s ago
2025-04-26 21:42:29,260 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:42:29,429 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:42:30,174 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:42:30,191 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:42:32,417 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:42:32,489 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:42:34,522 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:42:34,531 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:42:35,521 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:42:35,557 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:42:35,617 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:42:36,607 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:42:36,616 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:42:38,648 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:42:38,669 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:42:40,653 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:42:40,677 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:42:40,682 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:42:40,701 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:42:40,731 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:42:42,770 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:42:42,835 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:42:44,884 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:42:44,929 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:42:45,774 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:42:45,805 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:42:45,832 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:42:46,944 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:42:46,948 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:42:49,019 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:42:49,029 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:42:50,871 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:42:50,892 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:42:50,914 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:42:51,046 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:42:51,050 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:42:53,148 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:42:53,175 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:42:55,276 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:42:55,332 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:42:56,474 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:42:56,746 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:42:56,881 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:42:57,577 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:42:57,785 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:42:59,916 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:42:59,956 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:43:01,917 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:01,987 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:01,995 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:43:02,018 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:43:03,015 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:04,115 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:43:04,155 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:43:06,181 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:43:06,193 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:43:08,023 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:43:08,024 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:43:08,025 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:43:08,025 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:43:08,025 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: RESOURCE_OPTIMIZED
2025-04-26 21:43:08,044 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:08,044 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:08,065 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:08,066 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:08,071 - INFO - Using strategy buffer configuration
2025-04-26 21:43:08,075 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:43:08,184 - INFO - Successfully applied config to broker 2
2025-04-26 21:43:08,217 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:43:08,228 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:43:08,265 - INFO - Successfully applied config to broker 3
2025-04-26 21:43:08,327 - INFO - Successfully applied config to broker 1
2025-04-26 21:43:08,327 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:43:08,329 - INFO - Triggering leader election
2025-04-26 21:43:08,333 - INFO - Listing topics for leader election
2025-04-26 21:43:08,344 - INFO - Found 1 topics for leader election
2025-04-26 21:43:08,345 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:43:08,345 - INFO - Leader election completed in 0.01 seconds, success: False
2025-04-26 21:43:08,347 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:43:10,069 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:43:10,092 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:10,101 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:10,240 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:43:10,243 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:43:12,104 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:43:12,110 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:12,122 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:12,252 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:43:12,254 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:43:14,126 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:43:14,146 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:14,172 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:14,309 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:43:14,315 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:43:16,176 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:43:16,183 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:16,192 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:16,325 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:43:16,329 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:43:18,196 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:43:18,209 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:18,220 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:18,338 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:43:18,341 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:43:20,223 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:43:20,226 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:20,229 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:20,348 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:43:20,362 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:43:22,230 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:43:22,237 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:22,243 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:22,371 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:43:22,374 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:43:23,349 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:43:23,350 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:43:23,350 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:43:23,350 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:43:23,361 - INFO - Found 1 partitions on broker 1
2025-04-26 21:43:23,361 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:43:23,361 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:43:23,361 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:43:23,362 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:43:23,385 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:23,415 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:43:23,416 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:43:23,416 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:43:24,249 - INFO - Skipping recovery for kafka1:9092, last attempt 16.2s ago
2025-04-26 21:43:24,257 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:24,269 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:24,379 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:43:24,395 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:43:26,419 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:43:26,421 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:43:28,435 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:43:28,440 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:43:29,287 - INFO - Skipping recovery for kafka1:9092, last attempt 21.3s ago
2025-04-26 21:43:29,300 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:29,322 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:30,449 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:43:30,451 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:43:32,520 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:43:32,550 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:43:34,324 - INFO - Skipping recovery for kafka1:9092, last attempt 26.3s ago
2025-04-26 21:43:34,339 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:34,372 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:34,559 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:43:34,562 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:43:36,601 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:43:36,607 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:43:38,617 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:43:38,620 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:43:39,417 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:39,434 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:39,448 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:40,630 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:43:40,633 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:43:42,641 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:43:42,644 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:43:44,487 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:44,501 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:44,523 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:44,662 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:43:44,672 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:43:46,718 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:43:46,748 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:43:48,759 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:43:48,761 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:43:49,548 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:49,562 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:49,575 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:50,785 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:43:50,789 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:43:52,803 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:43:52,807 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:43:54,623 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:54,642 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:54,685 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:54,832 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:43:54,836 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:43:56,839 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:43:56,843 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:43:58,865 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:43:58,868 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:43:59,697 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:59,706 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:43:59,717 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:44:00,874 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:44:00,876 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:44:02,907 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:44:02,938 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:44:04,872 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:44:04,970 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:44:05,022 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:44:05,046 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:44:05,066 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:44:08,837 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:44:09,160 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:44:10,142 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:44:10,329 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:44:10,343 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:44:10,360 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:44:10,360 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: RESOURCE_OPTIMIZED
2025-04-26 21:44:12,994 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:44:13,302 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:44:16,011 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:44:16,073 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:44:16,797 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:44:16,863 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:44:18,399 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:44:18,417 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:44:18,664 - INFO - Using strategy buffer configuration
2025-04-26 21:44:18,670 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:44:18,735 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:44:18,811 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:44:20,073 - INFO - Successfully applied config to broker 2
2025-04-26 21:44:20,431 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:44:20,817 - INFO - Successfully applied config to broker 3
2025-04-26 21:44:20,909 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:44:20,923 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:44:21,517 - INFO - Successfully applied config to broker 1
2025-04-26 21:44:21,517 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:44:21,527 - INFO - Triggering leader election
2025-04-26 21:44:21,531 - INFO - Listing topics for leader election
2025-04-26 21:44:22,233 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:44:22,298 - INFO - Found 1 topics for leader election
2025-04-26 21:44:22,298 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:44:22,299 - INFO - Leader election completed in 0.77 seconds, success: False
2025-04-26 21:44:22,316 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:44:22,471 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:44:23,083 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:44:23,143 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:44:24,480 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:44:24,766 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:44:25,391 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:44:25,480 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:44:26,152 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:44:27,548 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:44:27,577 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:44:29,175 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:44:29,758 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:44:29,832 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:44:34,956 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:44:35,459 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:44:35,979 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:44:36,810 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:44:37,285 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:44:37,302 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:44:37,302 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:44:37,307 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:44:37,696 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:44:37,716 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:44:38,833 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:44:39,505 - INFO - Found 1 partitions on broker 1
2025-04-26 21:44:39,508 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:44:39,511 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:44:39,557 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:44:39,619 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:44:39,876 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:44:40,189 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:44:40,269 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:44:40,574 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:44:42,871 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:44:42,920 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:44:43,053 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:44:43,470 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:44:43,590 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:44:44,547 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:44:45,126 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:44:45,153 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:44:45,372 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:44:45,373 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:44:45,373 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:44:47,606 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:44:47,855 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:44:47,906 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:44:48,570 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:44:49,075 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:44:50,548 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:44:50,933 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:44:53,008 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:44:53,088 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:44:55,034 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:44:55,177 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:44:55,199 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:44:56,364 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:44:56,903 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:44:57,332 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:44:57,370 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:44:59,450 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:44:59,521 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:45:01,645 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:45:01,724 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:45:02,348 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:45:03,288 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:45:03,972 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:45:04,024 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:45:04,042 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:45:06,528 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:45:06,578 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:45:08,706 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:45:08,837 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:45:11,183 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:45:11,321 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:45:11,424 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:45:13,903 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:45:14,048 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:45:14,248 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:45:15,746 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:45:16,210 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:45:16,392 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:45:18,488 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:45:18,578 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:45:20,944 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:45:20,950 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:45:20,958 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:45:20,964 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:45:20,975 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:45:21,072 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:45:21,073 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: RESOURCE_OPTIMIZED
2025-04-26 21:45:21,663 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:45:21,692 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:45:23,697 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:45:23,785 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:45:24,483 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:45:24,484 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:45:25,017 - INFO - Using strategy buffer configuration
2025-04-26 21:45:26,438 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:45:26,460 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:45:26,539 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:45:27,921 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:45:30,382 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:45:30,532 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:45:31,040 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:45:31,396 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:45:32,926 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:45:33,047 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:45:33,405 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:45:33,854 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:45:34,127 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:45:35,175 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:45:35,241 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:45:35,578 - INFO - Successfully applied config to broker 2
2025-04-26 21:45:36,136 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:45:36,426 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:45:36,534 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:45:37,588 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:45:37,672 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:45:39,593 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:45:39,960 - INFO - Successfully applied config to broker 3
2025-04-26 21:45:40,272 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:45:40,333 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:45:40,340 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:45:40,720 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:45:42,655 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:45:42,747 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:45:42,769 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:45:43,613 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:45:44,922 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:45:45,065 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:45:45,103 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:45:46,480 - INFO - Successfully applied config to broker 1
2025-04-26 21:45:46,483 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:45:46,685 - INFO - Triggering leader election
2025-04-26 21:45:46,901 - INFO - Listing topics for leader election
2025-04-26 21:45:47,059 - INFO - Found 1 topics for leader election
2025-04-26 21:45:47,072 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:45:47,077 - INFO - Leader election completed in 0.17 seconds, success: False
2025-04-26 21:45:47,106 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:45:47,137 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:45:47,193 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:45:47,204 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:45:47,260 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:45:48,966 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:45:49,432 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:45:50,108 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:45:51,062 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:45:51,452 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:45:51,646 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:45:52,377 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:45:52,483 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:45:54,612 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:45:54,691 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:45:54,737 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:45:54,973 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:45:55,200 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:45:56,919 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:45:56,959 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:45:57,303 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:45:57,568 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:45:57,817 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:45:59,195 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:45:59,311 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:45:59,837 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:45:59,878 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:45:59,911 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:01,425 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:46:01,546 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:46:01,917 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:46:02,030 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:02,083 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:02,163 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:46:02,168 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:46:02,175 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:46:02,176 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:46:02,196 - INFO - Found 1 partitions on broker 1
2025-04-26 21:46:02,197 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:46:02,197 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:46:02,197 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:46:02,199 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:46:02,276 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:02,462 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:46:02,463 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:46:02,463 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:46:03,666 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:46:03,726 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:46:04,205 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:04,230 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:04,325 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:05,769 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:46:05,812 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:46:07,878 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:46:07,896 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:46:09,499 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:09,609 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:09,692 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:09,946 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:46:09,957 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:46:12,076 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:46:12,091 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:46:14,155 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:46:14,167 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:46:14,734 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:14,809 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:14,833 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:16,207 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:46:16,276 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:46:18,519 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:46:18,578 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:46:19,895 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:19,933 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:19,982 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:20,628 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:46:20,637 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:46:22,668 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:46:22,698 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:46:24,724 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:46:24,731 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:46:24,990 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:46:24,991 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:46:24,993 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:46:24,993 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:46:24,993 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: RESOURCE_OPTIMIZED
2025-04-26 21:46:25,012 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:25,012 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:25,192 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:25,195 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:25,266 - INFO - Using strategy buffer configuration
2025-04-26 21:46:25,281 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:46:25,852 - INFO - Successfully applied config to broker 2
2025-04-26 21:46:26,266 - INFO - Successfully applied config to broker 3
2025-04-26 21:46:26,999 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:46:27,054 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:46:27,117 - INFO - Successfully applied config to broker 1
2025-04-26 21:46:27,117 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:46:27,140 - INFO - Triggering leader election
2025-04-26 21:46:27,173 - INFO - Listing topics for leader election
2025-04-26 21:46:27,277 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:46:27,283 - INFO - Found 1 topics for leader election
2025-04-26 21:46:27,284 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:46:27,284 - INFO - Leader election completed in 0.11 seconds, success: False
2025-04-26 21:46:27,293 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:46:27,340 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:27,508 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:29,015 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:46:29,058 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:46:29,519 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:46:29,542 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:29,580 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:31,097 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:46:31,104 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:46:31,589 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:46:31,614 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:31,632 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:33,150 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:46:33,218 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:46:33,647 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:46:33,690 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:33,768 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:35,269 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:46:35,279 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:46:35,777 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:46:35,794 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:35,817 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:37,301 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:46:37,324 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:46:37,821 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:46:37,832 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:37,846 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:39,334 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:46:39,337 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:46:39,851 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:46:39,873 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:39,905 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:41,405 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:46:41,414 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:46:41,910 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:46:41,918 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:41,936 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:42,302 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:46:42,302 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:46:42,303 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:46:42,303 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:46:42,342 - INFO - Found 1 partitions on broker 1
2025-04-26 21:46:42,343 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:46:42,343 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:46:42,343 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:46:42,350 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:46:42,511 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:42,787 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:46:42,789 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:46:42,789 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:46:43,582 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:46:43,638 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:46:43,945 - INFO - Skipping recovery for kafka1:9092, last attempt 19.0s ago
2025-04-26 21:46:43,981 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:44,173 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:45,722 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:46:45,728 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:46:47,763 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:46:47,772 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:46:49,187 - INFO - Skipping recovery for kafka1:9092, last attempt 24.2s ago
2025-04-26 21:46:49,235 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:49,360 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:49,797 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:46:49,827 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:46:51,864 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:46:51,873 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:46:53,898 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:46:53,940 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:46:54,364 - INFO - Skipping recovery for kafka1:9092, last attempt 29.4s ago
2025-04-26 21:46:54,379 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:54,405 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:55,957 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:46:55,961 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:46:58,059 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:46:58,112 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:46:59,557 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:59,589 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:46:59,650 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:47:00,202 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:47:00,210 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:47:02,267 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:47:02,274 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:47:04,426 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:47:04,487 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:47:04,724 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:47:04,927 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:47:05,084 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:47:06,567 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:47:06,614 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:47:08,753 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:47:08,782 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:47:10,127 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:47:10,170 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:47:10,214 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:47:10,807 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:47:10,814 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:47:13,128 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:47:13,189 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:47:15,270 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:47:15,288 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:47:15,310 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:47:15,385 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:47:15,437 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:47:17,364 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:47:17,410 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:47:19,577 - ERROR - API returned status code: 500
2025-04-26 21:47:20,519 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:47:20,598 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:47:20,648 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:47:21,649 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:47:21,661 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:47:23,729 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:47:23,749 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:47:25,660 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:47:25,663 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:47:25,665 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:47:25,665 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:47:25,665 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE
2025-04-26 21:47:25,701 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:47:25,705 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:47:25,791 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:47:25,799 - INFO - Using strategy buffer configuration
2025-04-26 21:47:25,831 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:47:25,842 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:47:25,861 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:47:26,106 - INFO - Successfully applied config to broker 2
2025-04-26 21:47:26,284 - INFO - Successfully applied config to broker 3
2025-04-26 21:47:26,625 - INFO - Successfully applied config to broker 1
2025-04-26 21:47:26,625 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:47:26,631 - INFO - Triggering leader election
2025-04-26 21:47:26,633 - INFO - Listing topics for leader election
2025-04-26 21:47:26,646 - INFO - Found 1 topics for leader election
2025-04-26 21:47:26,646 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:47:26,646 - INFO - Leader election completed in 0.01 seconds, success: False
2025-04-26 21:47:26,651 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:47:26,717 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:47:28,174 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:47:28,180 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:47:28,721 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:47:28,821 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:47:28,871 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:47:30,230 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:47:30,260 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:47:30,902 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:47:30,966 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:47:31,123 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:47:32,312 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:47:32,325 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:47:33,142 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:47:33,530 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:47:33,873 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:47:34,834 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:47:34,961 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:47:35,924 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:47:36,434 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:47:36,507 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:47:37,053 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:47:37,133 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:47:38,515 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:47:39,198 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:47:39,364 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:47:39,409 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:47:39,424 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:47:41,486 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:47:41,562 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:47:41,661 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:47:41,661 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:47:41,662 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:47:41,662 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:47:41,750 - INFO - Found 1 partitions on broker 1
2025-04-26 21:47:41,751 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:47:41,754 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:47:41,755 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:47:41,788 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:47:42,057 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:47:42,276 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:47:42,276 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:47:42,277 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:47:42,446 - INFO - Skipping recovery for kafka1:9092, last attempt 16.8s ago
2025-04-26 21:47:42,540 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:47:42,661 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:47:44,061 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:47:44,335 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:47:46,651 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:47:46,699 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:47:47,718 - INFO - Skipping recovery for kafka1:9092, last attempt 22.1s ago
2025-04-26 21:47:47,936 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:47:48,036 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:47:48,759 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:47:48,808 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:47:50,850 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:47:50,863 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:47:52,904 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:47:52,918 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:47:53,046 - INFO - Skipping recovery for kafka1:9092, last attempt 27.4s ago
2025-04-26 21:47:53,068 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:47:53,087 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:47:54,951 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:47:54,970 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:47:57,004 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:47:57,028 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:47:58,119 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:47:58,137 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:47:58,220 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:47:59,037 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:47:59,041 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:48:01,103 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:48:01,116 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:48:03,146 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:48:03,154 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:48:03,348 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:48:03,445 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:48:03,476 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:48:05,232 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:48:05,246 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:48:07,259 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:48:07,264 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:48:09,271 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:48:09,288 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:48:09,504 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:48:09,516 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:48:09,569 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:48:11,374 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:48:11,381 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:48:13,413 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:48:13,418 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:48:14,608 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:48:14,643 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:48:14,668 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:48:15,433 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:48:15,438 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:48:17,465 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:48:17,503 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:48:19,520 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:48:19,524 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:48:19,692 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:48:19,707 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:48:19,725 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:48:21,565 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:48:21,571 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:48:23,604 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:48:23,611 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:48:25,021 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:48:25,152 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:48:25,194 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:48:25,675 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:48:25,686 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:48:27,794 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:48:27,820 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:48:29,939 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:48:29,950 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:48:30,272 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:48:30,340 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:48:30,466 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:48:30,466 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:48:30,466 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE
2025-04-26 21:48:30,671 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:48:30,696 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:48:30,890 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:48:30,922 - INFO - Using strategy buffer configuration
2025-04-26 21:48:30,948 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:48:31,623 - INFO - Successfully applied config to broker 2
2025-04-26 21:48:31,756 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:48:31,919 - INFO - Successfully applied config to broker 3
2025-04-26 21:48:32,021 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:48:32,054 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:48:32,320 - INFO - Successfully applied config to broker 1
2025-04-26 21:48:32,321 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:48:32,330 - INFO - Triggering leader election
2025-04-26 21:48:32,332 - INFO - Listing topics for leader election
2025-04-26 21:48:32,410 - INFO - Found 1 topics for leader election
2025-04-26 21:48:32,410 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:48:32,411 - INFO - Leader election completed in 0.08 seconds, success: False
2025-04-26 21:48:32,415 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:48:34,155 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:48:34,260 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:48:34,800 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:48:35,075 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:48:35,178 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:48:36,359 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:48:36,387 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:48:37,198 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:48:37,280 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:48:37,506 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:48:38,426 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:48:38,430 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:48:39,522 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:48:39,538 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:48:39,554 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:48:40,450 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:48:40,454 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:48:41,569 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:48:41,621 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:48:41,630 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:48:42,517 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:48:42,536 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:48:43,659 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:48:43,744 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:48:43,834 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:48:44,560 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:48:44,565 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:48:45,845 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:48:45,897 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:48:46,023 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:48:46,595 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:48:46,603 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:48:47,430 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:48:47,431 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:48:47,431 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:48:47,431 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:48:47,474 - INFO - Found 1 partitions on broker 1
2025-04-26 21:48:47,474 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:48:47,474 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:48:47,475 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:48:47,481 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:48:47,584 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:48:47,737 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:48:47,737 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:48:47,738 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:48:48,039 - INFO - Skipping recovery for kafka1:9092, last attempt 17.8s ago
2025-04-26 21:48:48,132 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:48:48,227 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:48:48,677 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:48:48,689 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:48:50,711 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:48:50,716 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:48:52,744 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:48:52,755 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:48:53,236 - INFO - Skipping recovery for kafka1:9092, last attempt 23.0s ago
2025-04-26 21:48:53,281 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:48:53,386 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:48:54,781 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:48:54,788 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:48:56,798 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:48:56,802 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:48:58,417 - INFO - Skipping recovery for kafka1:9092, last attempt 28.2s ago
2025-04-26 21:48:58,444 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:48:58,472 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:48:58,864 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:48:58,874 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:49:00,888 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:49:00,895 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:49:02,937 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:49:02,980 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:49:03,545 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:03,616 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:03,687 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:05,005 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:49:05,012 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:49:07,034 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:49:07,045 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:49:08,770 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:08,860 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:08,966 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:09,291 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:49:09,303 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:49:11,331 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:49:11,335 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:49:13,348 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:49:13,353 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:49:14,004 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:14,021 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:14,048 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:15,413 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:49:15,418 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:49:17,479 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:49:17,544 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:49:19,100 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:19,122 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:19,150 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:19,559 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:49:19,564 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:49:21,580 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:49:21,585 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:49:23,645 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:49:23,661 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:49:24,222 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:24,244 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:24,267 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:25,698 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:49:25,703 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:49:27,724 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:49:27,746 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:49:29,325 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:29,349 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:29,407 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:29,767 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:49:29,771 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:49:31,805 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:49:31,811 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:49:33,846 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:49:33,869 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:49:34,425 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:49:34,427 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:49:34,429 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:49:34,429 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:49:34,430 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE
2025-04-26 21:49:34,459 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:34,460 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:34,501 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:34,504 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:34,514 - INFO - Using strategy buffer configuration
2025-04-26 21:49:34,523 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:49:34,763 - INFO - Successfully applied config to broker 2
2025-04-26 21:49:34,907 - INFO - Successfully applied config to broker 3
2025-04-26 21:49:35,102 - INFO - Successfully applied config to broker 1
2025-04-26 21:49:35,102 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:49:35,900 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:49:35,905 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:49:36,113 - INFO - Triggering leader election
2025-04-26 21:49:36,119 - INFO - Listing topics for leader election
2025-04-26 21:49:36,137 - INFO - Found 1 topics for leader election
2025-04-26 21:49:36,138 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:49:36,139 - INFO - Leader election completed in 0.02 seconds, success: False
2025-04-26 21:49:36,143 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:49:36,515 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:49:36,549 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:36,575 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:37,941 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:49:37,947 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:49:38,581 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:49:38,618 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:38,756 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:39,964 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:49:39,971 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:49:40,770 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:49:40,782 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:40,790 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:41,980 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:49:41,985 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:49:42,797 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:49:42,813 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:42,833 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:44,022 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:49:44,052 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:49:44,842 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:49:44,868 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:44,887 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:46,083 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:49:46,111 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:49:46,892 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:49:46,983 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:47,077 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:48,133 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:49:48,141 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:49:49,084 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:49:49,097 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:49,114 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:50,167 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:49:50,172 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:49:51,120 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:49:51,135 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:51,152 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:51,154 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:49:51,155 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:49:51,156 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:49:51,156 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:49:51,165 - INFO - Found 1 partitions on broker 1
2025-04-26 21:49:51,166 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:49:51,166 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:49:51,166 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:49:51,168 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:49:51,231 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:51,318 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:49:51,320 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:49:51,323 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:49:52,185 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:49:52,192 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:49:54,180 - INFO - Skipping recovery for kafka1:9092, last attempt 19.7s ago
2025-04-26 21:49:54,389 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:49:54,403 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:54,457 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:49:54,762 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:49:56,660 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:49:56,712 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:49:59,008 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:49:59,041 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:49:59,816 - INFO - Skipping recovery for kafka1:9092, last attempt 25.4s ago
2025-04-26 21:49:59,919 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:00,051 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:01,134 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:50:01,162 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:50:03,241 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:50:03,278 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:50:05,211 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:05,227 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:05,246 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:05,303 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:50:05,311 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:50:07,332 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:50:07,335 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:50:09,374 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:50:09,437 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:50:10,288 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:10,313 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:10,366 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:11,489 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:50:11,512 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:50:13,689 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:50:13,739 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:50:15,406 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:15,422 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:15,440 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:15,773 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:50:15,781 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:50:17,793 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:50:17,830 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:50:19,863 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:50:19,884 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:50:20,545 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:20,581 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:20,726 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:21,977 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:50:22,044 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:50:24,090 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:50:24,123 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:50:25,892 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:25,989 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:26,122 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:26,223 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:50:26,247 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:50:28,334 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:50:28,348 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:50:30,370 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:50:30,398 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:50:31,173 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:31,194 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:31,279 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:32,442 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:50:32,447 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:50:34,486 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:50:34,530 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:50:36,295 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:50:36,298 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:50:36,306 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:50:36,306 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:50:36,306 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE
2025-04-26 21:50:36,633 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:36,639 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:36,755 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:50:36,790 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:36,796 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:36,801 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:50:36,832 - INFO - Using strategy buffer configuration
2025-04-26 21:50:36,847 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:50:37,192 - INFO - Successfully applied config to broker 2
2025-04-26 21:50:37,340 - INFO - Successfully applied config to broker 3
2025-04-26 21:50:37,893 - INFO - Successfully applied config to broker 1
2025-04-26 21:50:37,894 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:50:37,899 - INFO - Triggering leader election
2025-04-26 21:50:37,904 - INFO - Listing topics for leader election
2025-04-26 21:50:37,963 - INFO - Found 1 topics for leader election
2025-04-26 21:50:37,963 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:50:37,964 - INFO - Leader election completed in 0.06 seconds, success: False
2025-04-26 21:50:38,854 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:50:38,912 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:38,966 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:50:39,010 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:50:39,025 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:50:39,131 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:41,045 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:50:41,056 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:50:41,166 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:50:41,195 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:41,318 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:43,100 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:50:43,126 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:50:43,328 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:50:43,399 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:43,446 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:45,152 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:50:45,173 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:50:45,461 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:50:45,473 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:45,558 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:47,196 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:50:47,202 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:50:47,566 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:50:47,589 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:47,623 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:49,224 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:50:49,229 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:50:49,628 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:50:49,635 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:49,643 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:51,274 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:50:51,280 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:50:51,645 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:50:51,669 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:51,742 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:53,314 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:50:53,319 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:50:53,753 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:50:53,847 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:53,881 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:54,028 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:50:54,028 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:50:54,028 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:50:54,029 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:50:54,051 - INFO - Found 1 partitions on broker 1
2025-04-26 21:50:54,051 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:50:54,051 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:50:54,051 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:50:54,058 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:50:54,113 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:54,292 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:50:54,292 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:50:54,292 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:50:55,360 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:50:55,368 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:50:55,886 - INFO - Skipping recovery for kafka1:9092, last attempt 19.6s ago
2025-04-26 21:50:55,901 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:55,924 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:50:57,410 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:50:57,448 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:50:59,503 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:50:59,509 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:51:00,930 - INFO - Skipping recovery for kafka1:9092, last attempt 24.6s ago
2025-04-26 21:51:01,044 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:51:01,180 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:51:02,923 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:51:03,036 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:51:05,952 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:51:05,989 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:51:06,195 - INFO - Skipping recovery for kafka1:9092, last attempt 29.9s ago
2025-04-26 21:51:06,566 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:51:06,813 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:51:08,168 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:51:08,215 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:51:10,275 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:51:10,289 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:51:12,327 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:51:12,342 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:51:12,873 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:51:12,893 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:51:12,913 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:51:14,387 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:51:14,406 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:51:16,425 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:51:16,469 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:51:18,474 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:51:18,677 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:51:18,762 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:51:19,520 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:51:19,550 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:51:21,056 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:51:21,134 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:51:23,419 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:51:23,491 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:51:24,790 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:51:24,937 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:51:25,166 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:51:25,601 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:51:25,670 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:51:27,872 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:51:27,931 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:51:29,983 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:51:29,999 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:51:30,164 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:51:30,275 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:51:31,440 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:51:32,084 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:51:32,105 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:51:34,239 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:51:34,285 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:51:36,426 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:51:36,486 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:51:36,490 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:51:36,508 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:51:36,510 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:51:36,552 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:51:36,553 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: QUICK_REBALANCE
2025-04-26 21:51:36,710 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:51:36,714 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:51:36,822 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:51:36,848 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:51:36,893 - INFO - Using strategy buffer configuration
2025-04-26 21:51:36,911 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:51:37,323 - INFO - Successfully applied config to broker 2
2025-04-26 21:51:38,962 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:51:39,369 - INFO - Successfully applied config to broker 3
2025-04-26 21:51:39,956 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:51:40,401 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:51:40,515 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:51:40,849 - INFO - Successfully applied config to broker 1
2025-04-26 21:51:40,850 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:51:40,870 - INFO - Triggering leader election
2025-04-26 21:51:40,886 - INFO - Listing topics for leader election
2025-04-26 21:51:40,907 - INFO - Found 1 topics for leader election
2025-04-26 21:51:40,915 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:51:40,926 - INFO - Leader election completed in 0.03 seconds, success: False
2025-04-26 21:51:40,937 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:51:41,134 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:51:42,773 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:51:42,837 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:51:43,142 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:51:43,391 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:51:43,456 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:51:44,913 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:51:44,988 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:51:45,466 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:51:45,748 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:51:45,901 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:51:47,224 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:51:47,518 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:51:47,910 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:51:48,050 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:51:49,746 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:51:49,960 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:51:50,137 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:51:51,822 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:51:52,045 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:51:52,477 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:51:52,608 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:51:53,126 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:51:54,988 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:51:55,031 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:51:55,141 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:51:55,443 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:51:55,536 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:51:55,938 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:51:55,939 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:51:55,939 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:51:55,939 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:51:55,976 - INFO - Found 1 partitions on broker 1
2025-04-26 21:51:55,978 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:51:55,978 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:51:55,978 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:51:55,984 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:51:56,237 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:51:56,808 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:51:56,808 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:51:56,808 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:51:57,128 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:51:57,185 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:51:57,543 - INFO - Skipping recovery for kafka1:9092, last attempt 21.1s ago
2025-04-26 21:51:57,604 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:51:57,652 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:51:59,259 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:51:59,268 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:52:01,380 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:52:01,391 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:52:02,716 - INFO - Skipping recovery for kafka1:9092, last attempt 26.2s ago
2025-04-26 21:52:02,795 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:02,891 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:03,528 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:52:03,611 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:52:05,661 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:52:05,670 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:52:07,806 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:52:07,898 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:52:08,042 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:08,095 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:08,167 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:09,994 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:52:10,046 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:52:12,085 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:52:12,157 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:52:13,346 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:13,694 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:13,862 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:14,319 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:52:14,334 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:52:16,654 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:52:16,728 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:52:18,812 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:52:18,834 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:52:18,914 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:18,951 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:19,020 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:20,899 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:52:20,914 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:52:22,925 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:52:22,929 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:52:24,056 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:24,080 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:24,105 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:25,014 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:52:25,021 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:52:27,058 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:52:27,064 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:52:29,100 - INFO - Updated strategy buffer: QUICK_REBALANCE
2025-04-26 21:52:29,105 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:52:29,146 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:29,171 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:29,212 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:31,115 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:52:31,136 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:52:33,162 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:52:33,180 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:52:34,324 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:34,375 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:34,418 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:35,238 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:52:35,275 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:52:37,293 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:52:37,300 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:52:39,323 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:52:39,327 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:52:39,432 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:52:39,432 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:52:39,433 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:52:39,433 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:52:39,435 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: RESOURCE_OPTIMIZED
2025-04-26 21:52:39,447 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:39,447 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:39,480 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:39,480 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:39,484 - INFO - Using strategy buffer configuration
2025-04-26 21:52:39,492 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:52:39,543 - INFO - Successfully applied config to broker 2
2025-04-26 21:52:39,599 - INFO - Successfully applied config to broker 3
2025-04-26 21:52:39,634 - INFO - Successfully applied config to broker 1
2025-04-26 21:52:39,634 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:52:39,635 - INFO - Triggering leader election
2025-04-26 21:52:39,635 - INFO - Listing topics for leader election
2025-04-26 21:52:39,638 - INFO - Found 1 topics for leader election
2025-04-26 21:52:39,638 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:52:39,639 - INFO - Leader election completed in 0.00 seconds, success: False
2025-04-26 21:52:39,639 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:52:41,342 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:52:41,345 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:52:41,488 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:52:41,496 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:41,502 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:43,353 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:52:43,357 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:52:43,508 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:52:43,512 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:43,518 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:45,372 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:52:45,376 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:52:45,523 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:52:45,527 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:45,532 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:47,394 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:52:47,398 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:52:47,536 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:52:47,545 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:47,555 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:49,412 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:52:49,421 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:52:49,559 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:52:49,567 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:49,573 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:51,436 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:52:51,462 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:52:51,575 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:52:51,586 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:51,594 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:53,500 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:52:53,509 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:52:53,598 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:52:53,622 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:53,639 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:54,656 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:52:54,656 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:52:54,656 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:52:54,656 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:52:54,661 - INFO - Found 1 partitions on broker 1
2025-04-26 21:52:54,661 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:52:54,661 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:52:54,661 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:52:54,662 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:52:54,687 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:54,714 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:52:54,714 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:52:54,715 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:52:55,525 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:52:55,529 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:52:55,640 - INFO - Skipping recovery for kafka1:9092, last attempt 16.2s ago
2025-04-26 21:52:55,647 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:55,653 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:52:57,645 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:52:57,652 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:52:59,656 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:52:59,683 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:53:00,659 - INFO - Skipping recovery for kafka1:9092, last attempt 21.2s ago
2025-04-26 21:53:00,676 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:00,690 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:01,700 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:53:01,705 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:53:03,766 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:53:03,780 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:53:05,697 - INFO - Skipping recovery for kafka1:9092, last attempt 26.3s ago
2025-04-26 21:53:06,038 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:53:06,052 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:53:06,454 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:06,597 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:08,199 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:53:08,223 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:53:10,251 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:53:10,257 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:53:11,725 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:11,759 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:11,776 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:12,274 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:53:12,278 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:53:14,298 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:53:14,304 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:53:16,334 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:53:16,363 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:53:16,800 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:16,816 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:16,841 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:18,374 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:53:18,379 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:53:20,409 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:53:20,437 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:53:21,865 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:21,881 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:21,890 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:22,448 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:53:22,450 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:53:24,470 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:53:24,484 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:53:26,492 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:53:26,496 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:53:26,911 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:26,950 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:26,964 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:28,527 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:53:28,531 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:53:30,539 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:53:30,543 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:53:32,036 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:32,088 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:32,115 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:32,595 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:53:32,652 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:53:34,752 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:53:34,774 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:53:36,822 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:53:36,837 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:53:37,172 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:37,197 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:37,297 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:39,001 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:53:39,034 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:53:41,044 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:53:41,049 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:53:42,306 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:53:42,308 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:53:42,321 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:53:42,322 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:53:42,322 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: RESOURCE_OPTIMIZED
2025-04-26 21:53:42,547 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:42,548 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:42,742 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:42,764 - INFO - Using strategy buffer configuration
2025-04-26 21:53:42,765 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:42,967 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:53:43,376 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:53:43,534 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:53:44,776 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:53:44,812 - INFO - Successfully applied config to broker 2
2025-04-26 21:53:44,931 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:45,087 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:45,514 - INFO - Successfully applied config to broker 3
2025-04-26 21:53:45,746 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:53:45,782 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:53:45,999 - INFO - Successfully applied config to broker 1
2025-04-26 21:53:45,999 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:53:47,018 - INFO - Triggering leader election
2025-04-26 21:53:47,022 - INFO - Listing topics for leader election
2025-04-26 21:53:47,097 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:53:47,120 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:47,120 - INFO - Found 1 topics for leader election
2025-04-26 21:53:47,127 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:53:47,129 - INFO - Leader election completed in 0.11 seconds, success: False
2025-04-26 21:53:47,148 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:53:47,348 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:47,860 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:53:47,897 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:53:49,386 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:53:49,534 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:49,566 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:49,926 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:53:49,933 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:53:51,575 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:53:51,774 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:51,880 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:51,993 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:53:52,046 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:53:53,893 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:53:53,930 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:53,976 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:54,079 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:53:54,190 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:53:55,988 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:53:56,053 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:56,221 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:56,245 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:53:56,254 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:53:58,231 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:53:58,248 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:58,260 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:53:58,264 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:53:58,282 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:54:00,264 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:54:00,272 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:00,281 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:00,299 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:54:00,301 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:54:02,155 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:54:02,172 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:54:02,173 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:54:02,173 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:54:02,186 - INFO - Found 1 partitions on broker 1
2025-04-26 21:54:02,186 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:54:02,186 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:54:02,187 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:54:02,192 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:54:02,223 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:02,281 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:54:02,281 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:54:02,281 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:54:02,282 - INFO - Skipping recovery for kafka1:9092, last attempt 20.0s ago
2025-04-26 21:54:02,295 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:02,314 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:02,325 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:54:02,334 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:54:04,360 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:54:04,365 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:54:06,372 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:54:06,374 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:54:07,321 - INFO - Skipping recovery for kafka1:9092, last attempt 25.0s ago
2025-04-26 21:54:07,334 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:07,348 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:08,417 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:54:08,421 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:54:10,435 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:54:10,438 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:54:12,388 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:12,400 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:12,545 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:12,550 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:54:12,558 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:54:14,568 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:54:14,570 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:54:16,581 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:54:16,583 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:54:17,564 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:17,572 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:17,582 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:18,591 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:54:18,594 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:54:20,608 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:54:20,612 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:54:22,603 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:22,626 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:22,632 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:54:22,636 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:54:22,640 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:24,649 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:54:24,652 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:54:26,667 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:54:26,670 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:54:27,658 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:27,668 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:27,680 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:28,676 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:54:28,695 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:54:30,711 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:54:30,715 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:54:32,739 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:32,741 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:54:32,745 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:54:32,750 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:32,757 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:34,788 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:54:34,832 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:54:36,888 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:54:36,905 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:54:37,821 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:37,866 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:37,994 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:38,958 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:54:38,993 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:54:41,024 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:54:41,028 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:54:43,001 - WARNING - TEST MODE: Simulating failure for broker kafka1:9092
2025-04-26 21:54:43,003 - WARNING - TEST MODE: kafka1:9092 reported unavailable. Triggering recovery...
2025-04-26 21:54:43,003 - INFO - Starting recovery thread for kafka1:9092
2025-04-26 21:54:43,004 - INFO - Extracted broker ID 1 from container name kafka1
2025-04-26 21:54:43,004 - INFO - Initiating recovery for broker kafka1:9092 (ID: 1) with strategy: RESOURCE_OPTIMIZED
2025-04-26 21:54:43,019 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:43,020 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:43,033 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:43,033 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:43,036 - INFO - Using strategy buffer configuration
2025-04-26 21:54:43,039 - INFO - Found broker IDs: [2, 3, 1]
2025-04-26 21:54:43,043 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:54:43,060 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:54:43,085 - INFO - Successfully applied config to broker 2
2025-04-26 21:54:43,134 - INFO - Successfully applied config to broker 3
2025-04-26 21:54:43,167 - INFO - Successfully applied config to broker 1
2025-04-26 21:54:43,167 - INFO - Applied configuration to all available brokers from buffer
2025-04-26 21:54:43,168 - INFO - Triggering leader election
2025-04-26 21:54:43,169 - INFO - Listing topics for leader election
2025-04-26 21:54:43,175 - INFO - Found 1 topics for leader election
2025-04-26 21:54:43,175 - WARNING - Failed leader election for topic ai_workloads: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:54:43,176 - INFO - Leader election completed in 0.01 seconds, success: False
2025-04-26 21:54:43,178 - INFO - Waiting 15 seconds for cluster to stabilize
2025-04-26 21:54:45,036 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:54:45,111 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:45,126 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:54:45,133 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:54:45,147 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:47,148 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:54:47,151 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:54:47,152 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:54:47,155 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:47,161 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:49,162 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:54:49,162 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:54:49,165 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:54:49,168 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:49,172 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:51,178 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:54:51,180 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:54:51,184 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:54:51,187 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:51,195 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:53,190 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:54:53,192 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:54:53,199 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:54:53,207 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:53,214 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:55,216 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:54:55,217 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:54:55,220 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:54:55,222 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:55,228 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:57,230 - INFO - Skipping check for kafka1:9092 as it's currently in recovery
2025-04-26 21:54:57,234 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:54:57,238 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:54:57,243 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:57,251 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:58,199 - INFO - Restarting broker kafka1 (ID: 1)
2025-04-26 21:54:58,200 - INFO - Attempting broker recovery for kafka1
2025-04-26 21:54:58,200 - INFO - Attempting internal recovery for broker 1
2025-04-26 21:54:58,200 - INFO - Triggering internal recovery for broker 1
2025-04-26 21:54:58,223 - INFO - Found 1 partitions on broker 1
2025-04-26 21:54:58,223 - WARNING - Partition reassignment failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>, trying next method
2025-04-26 21:54:58,223 - WARNING - Broker config modification failed: Expected list of <class 'confluent_kafka.admin._config.ConfigResource'>
2025-04-26 21:54:58,224 - INFO - Successfully triggered internal recovery mechanisms for broker 1
2025-04-26 21:54:58,226 - INFO - Successfully triggered internal recovery for broker 1
2025-04-26 21:54:58,247 - INFO - Broker kafka1:9092 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:58,272 - INFO - Logged recovery metrics to /app/data/recovery_metrics.csv
2025-04-26 21:54:58,272 - INFO - Recovery successful for broker kafka1:9092
2025-04-26 21:54:58,272 - INFO - Recovery thread for kafka1:9092 completed
2025-04-26 21:54:59,257 - INFO - Skipping recovery for kafka1:9092, last attempt 16.3s ago
2025-04-26 21:54:59,258 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:54:59,264 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:54:59,283 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:54:59,306 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:55:01,279 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:55:01,300 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:55:03,323 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:55:03,346 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:55:04,308 - INFO - Skipping recovery for kafka1:9092, last attempt 21.3s ago
2025-04-26 21:55:04,393 - INFO - Broker kafka2:9093 available. Broker IDs: [2, 3, 1]
2025-04-26 21:55:04,440 - INFO - Broker kafka3:9094 available. Broker IDs: [2, 3, 1]
2025-04-26 21:55:05,376 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:55:05,384 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:55:07,478 - INFO - Updated strategy buffer: RESOURCE_OPTIMIZED
2025-04-26 21:55:07,538 - INFO - Successfully saved strategy buffer to /app/data/strategy_buffer.json
2025-04-26 21:55:09,704 - INFO - Skipping recovery for kafka1:9092, last attempt 26.6s ago
